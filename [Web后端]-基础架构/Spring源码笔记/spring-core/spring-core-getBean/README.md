## getBean

- [getBean](#getbean)
  - [‰∏Ä„ÄÅÂü∫Êú¨‰ø°ÊÅØ](#‰∏ÄÂü∫Êú¨‰ø°ÊÅØ)
  - [‰∫å„ÄÅÊñπÊ≥ïÊ∫êÁ†Å](#‰∫åÊñπÊ≥ïÊ∫êÁ†Å)
  - [‰∏â„ÄÅ‰∏ªË¶ÅÂäüËÉΩ](#‰∏â‰∏ªË¶ÅÂäüËÉΩ)
  - [Âõõ„ÄÅÊúÄ‰Ω≥ÂÆûË∑µ](#ÂõõÊúÄ‰Ω≥ÂÆûË∑µ)
  - [‰∫î„ÄÅÊó∂Â∫èÂõæ](#‰∫îÊó∂Â∫èÂõæ)
  - [ÂÖ≠„ÄÅÊ∫êÁ†ÅÂàÜÊûê](#ÂÖ≠Ê∫êÁ†ÅÂàÜÊûê)
  - [‰∏É„ÄÅÊ≥®ÊÑè‰∫ãÈ°π](#‰∏ÉÊ≥®ÊÑè‰∫ãÈ°π)
  - [ÂÖ´„ÄÅÊÄªÁªì](#ÂÖ´ÊÄªÁªì)
    - [ÊúÄ‰Ω≥ÂÆûË∑µÊÄªÁªì](#ÊúÄ‰Ω≥ÂÆûË∑µÊÄªÁªì)
    - [Ê∫êÁ†ÅÂàÜÊûêÊÄªÁªì](#Ê∫êÁ†ÅÂàÜÊûêÊÄªÁªì)


### ‰∏Ä„ÄÅÂü∫Êú¨‰ø°ÊÅØ

‚úíÔ∏è **‰ΩúËÄÖ** - Lex üìù **ÂçöÂÆ¢** - [ÊàëÁöÑCSDN]() üìö **ÊñáÁ´†ÁõÆÂΩï** - [Ê∫êÁ†ÅÂú∞ÂùÄ](https://github.com/xuchengsheng/spring-reading)

Âú® Spring Ê°ÜÊû∂‰∏≠Ôºå`getBean` ÊñπÊ≥ïÊòØ `ApplicationContext` Êé•Âè£‰∏≠ÁöÑ‰∏Ä‰∏™Ê†∏ÂøÉÊñπÊ≥ïÔºåÁî®‰∫é‰ªé Spring ÂÆπÂô®‰∏≠Ê£ÄÁ¥¢ bean„ÄÇSpring ÁöÑÊ†∏ÂøÉÊòØÊéßÂà∂ÂèçËΩ¨ÔºàInversion of Control, IoCÔºâÂíå‰æùËµñÊ≥®ÂÖ•ÔºàDependency Injection, DIÔºâÔºå`getBean` ÊñπÊ≥ïÊ≠£ÊòØÂÆûÁé∞Ëøô‰∏§‰∏™Ê†∏ÂøÉÊ¶ÇÂøµÁöÑÈáçË¶ÅÊñπÊ≥ï„ÄÇ

### ‰∫å„ÄÅÊñπÊ≥ïÊ∫êÁ†Å

Ëøô‰∏™ÊñπÊ≥ïÁöÑÂÆö‰πâÂíåËØ¥ÊòéË°®Êòé‰∫Ü Spring IoC ÂÆπÂô®ÁöÑ‰∏Ä‰∫õÊ†∏ÂøÉÊ¶ÇÂøµÂíåÂ∑•‰ΩúÊú∫Âà∂„ÄÇÂΩìÊàë‰ª¨ËØ∑Ê±Ç‰∏Ä‰∏™ bean Êó∂ÔºåSpring ‰ºöÊü•ÊâæËØ• bean„ÄÅÂ§ÑÁêÜ‰ªª‰ΩïÂà´Âêç„ÄÅÊ£ÄÊü•ÂÖ∂‰ΩúÁî®ÂüüÔºà‰æãÂ¶ÇÔºåÂçï‰æãÊàñÂéüÂûãÔºâÔºåÂπ∂ÊúÄÁªàËøîÂõûÈÄÇÂΩìÁöÑ bean ÂÆû‰æãÁªôË∞ÉÁî®ËÄÖ„ÄÇ

```java
/**
 * ËøîÂõûÊåáÂÆöbeanÁöÑÂÆû‰æãÔºåËØ•ÂÆû‰æãÂèØËÉΩÊòØÂÖ±‰∫´ÁöÑÊàñÁã¨Á´ãÁöÑ„ÄÇ
 * Ê≠§ÊñπÊ≥ï‰ΩøSpring BeanFactoryÂèØ‰ª•Êõø‰ª£Âçï‰æãÊàñÂéüÂûãËÆæËÆ°Ê®°Âºè„ÄÇÂú®Âçï‰æãbeanÁöÑÊÉÖÂÜµ‰∏ãÔºåË∞ÉÁî®ËÄÖÂèØ‰ª•‰øùÁïôËøîÂõûÂØπË±°ÁöÑÂºïÁî®„ÄÇ
 * Â∞ÜÂà´ÂêçËΩ¨Êç¢ÂõûÁõ∏Â∫îÁöÑËßÑËåÉbeanÂêçÁß∞„ÄÇ
 * Â¶ÇÊûúÂú®Ëøô‰∏™Â∑•ÂéÇÂÆû‰æã‰∏≠Êâæ‰∏çÂà∞beanÔºåÂ∞ÜËØ¢ÈóÆÁà∂Â∑•ÂéÇ„ÄÇ
 * 
 * @param name Ë¶ÅÊ£ÄÁ¥¢ÁöÑbeanÁöÑÂêçÁß∞
 * @return beanÁöÑÂÆû‰æã
 * @throws NoSuchBeanDefinitionException Â¶ÇÊûúÊ≤°ÊúâÊåáÂÆöÂêçÁß∞ÁöÑbean
 * @throws BeansException Â¶ÇÊûúÊó†Ê≥ïËé∑Âèñbean
 */
Object getBean(String name) throws BeansException;
```

### ‰∏â„ÄÅ‰∏ªË¶ÅÂäüËÉΩ

1. **Ê£ÄÁ¥¢ Bean**
   + ‰ªé Spring ÂÆπÂô®‰∏≠Ê£ÄÁ¥¢Âπ∂ËøîÂõûÊåáÂÆöÂêçÁß∞ÊàñÁ±ªÂûãÁöÑ bean ÁöÑÂÆû‰æã„ÄÇ
2. **‰ΩúÁî®ÂüüÂ§ÑÁêÜ**
   + Ê†πÊçÆ bean ÁöÑÈÖçÁΩÆÂíå‰ΩúÁî®ÂüüÔºà‰æãÂ¶Ç "singleton" Êàñ "prototype"ÔºâÔºå`getBean` ÂèØ‰ª•ËøîÂõûÂçï‰æãÁöÑ bean ÂÆû‰æãÊàñÊØèÊ¨°ÈÉΩÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂÆû‰æã„ÄÇ
3. **Âà´ÂêçÂ§ÑÁêÜ**
   + Â¶ÇÊûú bean ÊúâÂà´ÂêçÔºå`getBean` ÂèØ‰ª•Ê†πÊçÆËøô‰∫õÂà´ÂêçËß£ÊûêÂπ∂ËøîÂõûÁõ∏Â∫îÁöÑ bean ÂÆû‰æã„ÄÇ
4. **ËÄÉËôëÁà∂ÂÆπÂô®**
   + Â¶ÇÊûúÂú®ÂΩìÂâçÂÆπÂô®‰∏≠Êâæ‰∏çÂà∞ beanÔºå‰ΩÜÂÆπÂô®ÊúâÁà∂ÂÆπÂô®ÔºåÂàô `getBean` ‰ºöÂú®Áà∂ÂÆπÂô®‰∏≠Êü•ÊâæËØ• bean„ÄÇ
5. **Á±ªÂûãËΩ¨Êç¢**
   + `getBean` ËøòÊúâ‰∏Ä‰∏™ÈáçËΩΩÁâàÊú¨ÔºåÂÖÅËÆ∏Áî®Êà∑ÊåáÂÆöËøîÂõû bean ÁöÑÁ±ªÂûãÔºåËøôÊ†∑ÂèØ‰ª•ÈÅøÂÖçÂú®ÂêéÁª≠‰ΩøÁî®‰∏≠ËøõË°åÊòæÂºèÁöÑÁ±ªÂûãËΩ¨Êç¢„ÄÇ
6. **ÂºÇÂ∏∏Â§ÑÁêÜ**
   + Â¶ÇÊûúÂÆπÂô®‰∏≠‰∏çÂ≠òÂú®ÊåáÂÆöÁöÑ beanÔºåÂÆÉ‰ºöÊäõÂá∫ `NoSuchBeanDefinitionException`„ÄÇÂ¶ÇÊûúÂú®Â∞ùËØïÂàõÂª∫ÊàñÊ£ÄÁ¥¢ bean Êó∂Âá∫Áé∞ÂÖ∂‰ªñÈóÆÈ¢òÔºåÂÆÉ‰ºöÊäõÂá∫ `BeansException`„ÄÇ
7. **ÊîØÊåÅ‰æùËµñÊü•Êâæ**
   + Â∞ΩÁÆ° Spring ÁöÑ‰∏ªË¶ÅÁõÆÊ†áÊòØÈÄöËøá‰æùËµñÊ≥®ÂÖ•Êèê‰æõ‰æùËµñÂÖ≥Á≥ªÔºå‰ΩÜ `getBean` ÊñπÊ≥ïÊèê‰æõ‰∫Ü‰∏ÄÁßçÊâãÂä®Êü•Êâæ‰æùËµñÁöÑÊñπÂºè„ÄÇ
8. **ÂàùÂßãÂåñ Bean**
   + Â¶ÇÊûú bean Â∞öÊú™ÂàùÂßãÂåñÔºà‰æãÂ¶ÇÔºåÂØπ‰∫éÂçï‰æã bean Âú®È¶ñÊ¨°ËØ∑Ê±ÇÊó∂ÔºâÔºå`getBean` ÊñπÊ≥ï‰ºöËß¶ÂèëÂÖ∂ÂàùÂßãÂåñ„ÄÇ

### Âõõ„ÄÅÊúÄ‰Ω≥ÂÆûË∑µ

È¶ñÂÖàÊù•ÁúãÁúãÂêØÂä®Á±ªÂÖ•Âè£Ôºå‰∏ä‰∏ãÊñáÁéØÂ¢É‰ΩøÁî®`AnnotationConfigApplicationContext`ÔºàÊ≠§Á±ªÊòØ‰ΩøÁî®JavaÊ≥®Ëß£Êù•ÈÖçÁΩÆSpringÂÆπÂô®ÁöÑÊñπÂºèÔºâÔºåÊûÑÈÄ†ÂèÇÊï∞Êàë‰ª¨ÁªôÂÆö‰∫Ü‰∏Ä‰∏™`MyConfiguration`ÁªÑ‰ª∂Á±ªÔºåÁÑ∂Âêé‰ªéSpring‰∏ä‰∏ãÊñá‰∏≠Ëé∑Âèñ‰∏§‰∏™BeanÂØπË±°`myServiceA`Ôºå`myServiceB`Á±ªÂûãÁöÑbean„ÄÇ

```java
public class GetBeanApplication {

    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(MyConfiguration.class);
        System.out.println("myServiceA = " + context.getBean("myServiceA"));
        System.out.println("myServiceB = " + context.getBean("myServiceB"));
    }
}
```

Âú®ÈÖçÁΩÆÁ±ª‰∏≠Ôºå‰ΩøÁî®`@ComponentScan`Ê≥®Ëß£ËÆ©SpringÊâ´Êèè`com.xcs.spring.service`ÂåÖ‰ª•ÂèäÂÖ∂Â≠êÂåÖÔºåÁî±Ê≠§Êâ´ÊèèÂà∞ÁöÑ‰ªª‰ΩïÁ±ªÔºåÂ¶ÇÊûúÂÆÉ‰ª¨‰∏äÈù¢ÊúâÁâπÂÆöÁöÑÊ≥®Ëß£ÔºàÂ¶Ç`@Component`, `@Service`, `@Repository`, `@Controller`Á≠âÔºâÔºåÈÉΩ‰ºöË¢´SpringËá™Âä®ËØÜÂà´Âπ∂Ê∑ªÂä†Âà∞ÂÆπÂô®‰∏≠ÔºåÊàê‰∏∫ÂÆπÂô®ÁÆ°ÁêÜÁöÑbean„ÄÇ

```java
@Configuration
@ComponentScan("com.xcs.spring.service")
public class MyConfiguration {
    
}
```

Áî±‰∫éÊàë‰ª¨ÈÖçÁΩÆ‰∏≠ÂêØÁî®‰∫Ü`@ComponentScan`ÔºàÂ¶ÇÂú®`MyConfiguration`Á±ª‰∏≠ÔºâÂπ∂ÊåáÂÆö‰∫ÜÊ≠£Á°ÆÁöÑÂåÖË∑ØÂæÑÔºåÈÇ£‰πàËøô‰∏§‰∏™Á±ªÂ∞ÜË¢´Ëá™Âä®ËØÜÂà´Âπ∂Ê≥®ÂÜåÂà∞SpringÂÆπÂô®‰∏≠„ÄÇ

```java
package com.xcs.spring.service;

@Component
public class MyServiceA {

}

@Component
public class MyServiceB {

}
```

ËøêË°åÁªìÊûúÂèëÁé∞ÔºåËøôÊòØÊàë‰ª¨Ëá™Â∑±ÂÆö‰πâÁöÑ‰∏§‰∏™ÊúçÂä°Á±ª„ÄÇÂÆÉ‰ª¨ÈÉΩË¢´Ê†áËÆ∞‰∏∫`@Component`ÔºåÂõ†Ê≠§SpringÂÆπÂô®‰ºö‰∏∫ÊØè‰∏™Á±ªÂàõÂª∫‰∏Ä‰∏™beanÂÆû‰æã„ÄÇ

```java
myServiceA = com.xcs.spring.service.MyServiceA@23c30a20
myServiceB = com.xcs.spring.service.MyServiceB@1e1a0406
```

### ‰∫î„ÄÅÊó∂Â∫èÂõæ

~~~mermaid
sequenceDiagram
DefaultListableBeanFactory->>AbstractBeanFactory:getBean(name)
note over AbstractBeanFactory: ËØ∑Ê±Ç‰∏Ä‰∏™Bean

AbstractBeanFactory->>AbstractBeanFactory:doGetBean(name,requiredType,args,typeCheckOnly)
note over AbstractBeanFactory: ÊâßË°åÂÆûÈôÖÁöÑËé∑ÂèñBeanÈÄªËæë

AbstractBeanFactory->>AbstractBeanFactory:transformedBeanName(name)
note over AbstractBeanFactory: Ëé∑ÂèñÁúüÊ≠£ÁöÑbeanÂêçÁß∞

AbstractBeanFactory->>DefaultSingletonBeanRegistry:getSingleton(beanName)
note over DefaultSingletonBeanRegistry: Ê£ÄÊü•BeanÊòØÂê¶‰∏∫Âçï‰æã

DefaultSingletonBeanRegistry->>DefaultSingletonBeanRegistry:getSingleton(beanName,allowEarlyReference)
note over DefaultSingletonBeanRegistry: Â¶ÇÊûúÂÖÅËÆ∏ÔºåÊ£ÄÊü•Êó©ÊúüÂºïÁî®ÁöÑÂçï‰æãBean

DefaultSingletonBeanRegistry->>AbstractBeanFactory:ËøîÂõûÂ∑≤Ê≥®ÂÜåÁöÑsingletonÂØπË±°
note over AbstractBeanFactory: Â¶ÇÊûúÂ∑≤Ê≥®ÂÜåÔºåÂàôËøîÂõûËøô‰∏™Âçï‰æãBean

AbstractBeanFactory->>DefaultListableBeanFactory:ËøîÂõûBeanÂØπË±°
note over DefaultListableBeanFactory: ËøîÂõûÂà∞ÂéüÂßãÁöÑËØ∑Ê±ÇÊ∫ê

note over AbstractBeanFactory: Bean‰∏çÂú®ÁºìÂ≠ò‰∏≠ÔºåÈúÄË¶ÅÂàõÂª∫

AbstractBeanFactory->>AbstractBeanFactory:getParentBeanFactory()
note over AbstractBeanFactory: Ê£ÄÊü•ÊòØÂê¶ÊúâÁà∂BeanÂ∑•ÂéÇ

AbstractBeanFactory->>DefaultListableBeanFactory:parentBeanFactory.getBean(name)
note over DefaultListableBeanFactory: Âú®Áà∂Â∑•ÂéÇ‰∏≠ËØ∑Ê±ÇBean

AbstractBeanFactory->>AbstractBeanFactory:markBeanAsCreated(beanName)
note over AbstractBeanFactory: Ê†áËÆ∞ËØ•Bean‰∏∫Â∑≤ÂàõÂª∫

AbstractBeanFactory->>AbstractBeanFactory:getMergedLocalBeanDefinition(beanName)
note over AbstractBeanFactory: Ëé∑ÂèñÂêàÂπ∂ÂêéÁöÑBeanÂÆö‰πâ

AbstractBeanFactory->>AbstractBeanFactory:checkMergedBeanDefinition(mbd, beanName, args)
note over AbstractBeanFactory: Ê£ÄÊü•ÂêàÂπ∂ÂêéÁöÑBeanÂÆö‰πâÊòØÂê¶ÊúâÊïà

AbstractBeanFactory->>AbstractBeanDefinition:getDependsOn()
note over AbstractBeanFactory: Ëé∑ÂèñËØ•BeanÁöÑ‰æùËµñ

AbstractBeanFactory->>DefaultSingletonBeanRegistry:isDependent(beanName, dep)
note over DefaultSingletonBeanRegistry: Ê£ÄÊü•ÊòØÂê¶Â≠òÂú®‰æùËµñ

DefaultSingletonBeanRegistry->>DefaultSingletonBeanRegistry:isDependent(beanName, dependentBeanName, null)
note over DefaultSingletonBeanRegistry: Ê£ÄÊü•‰æùËµñ

DefaultSingletonBeanRegistry->>DefaultSingletonBeanRegistry:canonicalName(beanName)
note over DefaultSingletonBeanRegistry: Ëé∑ÂèñBeanÁöÑËßÑËåÉÂêçÁß∞

DefaultSingletonBeanRegistry->>AbstractBeanFactory:ËøîÂõûÊòØÂê¶Â≠òÂú®Âæ™ÁéØ‰æùËµñÁöÑÊÉÖÂÜµ
note over AbstractBeanFactory: ËøîÂõûÂæ™ÁéØ‰æùËµñÁöÑÊ£ÄÊü•ÁªìÊûú

note over AbstractBeanFactory: Â¶ÇÊûúÂ≠òÂú®Âæ™ÁéØ‰æùËµñÔºåÂàôÊäõÂá∫ÂºÇÂ∏∏ throw new BeanCreationException(""Circular depends-on relationship between")

AbstractBeanFactory->>DefaultSingletonBeanRegistry:registerDependentBean(dep, beanName)
note over DefaultSingletonBeanRegistry: Ê≥®ÂÜå‰æùËµñÂÖ≥Á≥ª

AbstractBeanFactory->>DefaultListableBeanFactory:getBean(name)
note over DefaultListableBeanFactory: Ëé∑ÂèñË¢´‰æùËµñÁöÑbeanÂØπË±°

AbstractBeanFactory->>DefaultSingletonBeanRegistry:getSingleton(beanName,singletonFactory)
note over DefaultSingletonBeanRegistry: Ëé∑ÂèñÊàñÂàõÂª∫Âçï‰æãBean

DefaultSingletonBeanRegistry->>DefaultSingletonBeanRegistry:beforeSingletonCreation(beanName)
note over DefaultSingletonBeanRegistry: Âú®ÂàõÂª∫Âçï‰æã‰πãÂâçÁöÑÂáÜÂ§áÂ∑•‰Ωú

DefaultSingletonBeanRegistry->>AbstractBeanFactory:singletonFactory.getObject()
note over AbstractBeanFactory: ‰ΩøÁî®Âçï‰æãÂ∑•ÂéÇÂàõÂª∫Bean

AbstractBeanFactory->>AbstractAutowireCapableBeanFactory:createBean(beanName, mbd, args)
note over AbstractAutowireCapableBeanFactory: ÂàõÂª∫Êñ∞ÁöÑBeanÂÆû‰æã

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:resolveBeanClass(mbd, beanName)
note over AbstractAutowireCapableBeanFactory: Ëß£ÊûêBeanÁöÑÁ±ª

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:resolveBeforeInstantiation(beanName, mbdToUse)
note over AbstractAutowireCapableBeanFactory: Âú®ÂÆû‰æãÂåñÂâçÂ∞ùËØïËß£ÊûêBean

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:doCreateBean(beanName,mbd,args)
note over AbstractAutowireCapableBeanFactory: ÊâßË°åÂÆûÈôÖÁöÑBeanÂàõÂª∫

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:createBeanInstance(beanName, mbd, args)
note over AbstractAutowireCapableBeanFactory: ÂàõÂª∫BeanÂÆû‰æã

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:determineConstructorsFromBeanPostProcessors(beanClass, beanName)
note over AbstractAutowireCapableBeanFactory: ‰ªéSmartInstantiationAwareBeanPostProcessorÁ°ÆÂÆöÊûÑÈÄ†Âô®

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:instantiateBean(beanName, mbd)
note over AbstractAutowireCapableBeanFactory: ÂÆû‰æãÂåñBean

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:applyMergedBeanDefinitionPostProcessors(mbd, beanType, beanName)
note over AbstractAutowireCapableBeanFactory: Â∫îÁî®ÂêàÂπ∂ÂêéÁöÑBeanÂÆö‰πâÂêéÂ§ÑÁêÜÂô®

AbstractAutowireCapableBeanFactory->>DefaultSingletonBeanRegistry:addSingletonFactory(beanName,singletonFactory)
note over DefaultSingletonBeanRegistry: Ê∑ªÂä†Âçï‰æãÂ∑•ÂéÇ

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:populateBean(beanName, mbd, instanceWrapper)
note over AbstractAutowireCapableBeanFactory: Â°´ÂÖÖBeanÁöÑÂ±ûÊÄß

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:postProcessAfterInstantiation(bean,beanName)
note over AbstractAutowireCapableBeanFactory: ÂÆû‰æãÂåñÂêéÁöÑÂêéÂ§ÑÁêÜ

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:postProcessProperties(pvs,bean,beanName)
note over AbstractAutowireCapableBeanFactory: Â±ûÊÄßÂêéÂ§ÑÁêÜ

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:postProcessPropertyValues(pvs,pds,bean,beanName)
note over AbstractAutowireCapableBeanFactory: Â±ûÊÄßÂêéÂ§ÑÁêÜ

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:applyPropertyValues(beanName,mbd,bw,pvs)
note over AbstractAutowireCapableBeanFactory: Â∫îÁî®Â±ûÊÄßÂÄº

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:initializeBean(beanName, exposedObject, mbd)
note over AbstractAutowireCapableBeanFactory: ÂàùÂßãÂåñBean

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:invokeAwareMethods(beanName, bean)
note over AbstractAutowireCapableBeanFactory: Ë∞ÉÁî®AwareÊé•Âè£ÊñπÊ≥ï

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:applyBeanPostProcessorsBeforeInitialization(wrappedBean, beanName)
note over AbstractAutowireCapableBeanFactory: Âú®ÂàùÂßãÂåñÂâçÂ∫îÁî®BeanPostProcessors

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:invokeInitMethods(beanName, wrappedBean, mbd)
note over AbstractAutowireCapableBeanFactory: Ë∞ÉÁî®ÂàùÂßãÂåñÊñπÊ≥ï

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:applyBeanPostProcessorsAfterInitialization(wrappedBean, beanName)
note over AbstractAutowireCapableBeanFactory: Âú®ÂàùÂßãÂåñÂêéÂ∫îÁî®BeanPostProcessors

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:registerDisposableBeanIfNecessary(beanName, bean, mbd)
note over AbstractAutowireCapableBeanFactory: Â¶ÇÊûúÈúÄË¶ÅÔºåÊ≥®ÂÜåÂèØÈîÄÊØÅÁöÑBean

AbstractAutowireCapableBeanFactory->>AbstractBeanFactory:ËøîÂõûÂàõÂª∫ÁöÑÂçï‰æãBean
AbstractBeanFactory->>DefaultSingletonBeanRegistry:ËøîÂõûÂàõÂª∫ÁöÑÂçï‰æãBean

DefaultSingletonBeanRegistry->>DefaultSingletonBeanRegistry:afterSingletonCreation(beanName)
note over DefaultSingletonBeanRegistry: Âçï‰æãÂàõÂª∫ÂêéÁöÑÂêéÁª≠Â§ÑÁêÜ

DefaultSingletonBeanRegistry->>DefaultSingletonBeanRegistry:addSingleton(beanName, singletonObject)
note over DefaultSingletonBeanRegistry: ÂêëÊ≥®ÂÜåË°®‰∏≠Ê∑ªÂä†Êñ∞ÁöÑÂçï‰æãBean

DefaultSingletonBeanRegistry->>AbstractBeanFactory:ËøîÂõûÂàõÂª∫ÁöÑÂçï‰æãBean

AbstractBeanFactory->>AbstractAutowireCapableBeanFactory:getObjectForBeanInstance(sharedInstance, name, beanName, mbd)
note over AbstractAutowireCapableBeanFactory: Ëé∑ÂèñBeanÂÆû‰æãÁöÑÂØπË±°

AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory:Â§ÑÁêÜFactoryBean
note over AbstractAutowireCapableBeanFactory: Â¶ÇÊûúÊòØFactoryBeanÔºåÂàôÂ§ÑÁêÜ

AbstractAutowireCapableBeanFactory->>AbstractBeanFactory:ËøîÂõûÁúüÊ≠£ÁöÑBeanÂØπË±°
note over AbstractBeanFactory: ËøîÂõûÁúüÂÆûÁöÑBeanÂØπË±°ÔºåËÄå‰∏çÊòØFactoryBean

AbstractBeanFactory->>AbstractBeanFactory:adaptBeanInstance(name, beanInstance, requiredType)
note over AbstractBeanFactory: ÈÄÇÈÖçBeanÂÆû‰æãÁöÑÁ±ªÂûã

AbstractBeanFactory->>DefaultListableBeanFactory:ËøîÂõûÁúüÊ≠£ÁöÑBeanÂØπË±°
note over DefaultListableBeanFactory: ËøîÂõûÂà∞ÂéüÂßãÁöÑËØ∑Ê±ÇÊ∫ê
~~~

### ÂÖ≠„ÄÅÊ∫êÁ†ÅÂàÜÊûê

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#getBean(name)`ÊñπÊ≥ï‰∏≠ÔºåÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÁÆÄÂçïÁöÑÊñπÂºèÔºåËÆ©Ë∞ÉÁî®ËÄÖËÉΩÂ§üÂü∫‰∫ébeanÁöÑÂêçÁß∞‰ªéSpring IoCÂÆπÂô®‰∏≠Ê£ÄÁ¥¢beanÔºåËÄå‰∏çÈúÄË¶ÅÊèê‰æõ‰ªª‰ΩïÂÖ∂‰ªñÁöÑ‰∏ä‰∏ãÊñá‰ø°ÊÅØÊàñÂèÇÊï∞„ÄÇ

```java
@Override
public Object getBean(String name) throws BeansException {
    // Ë∞ÉÁî®doGetBeanÊñπÊ≥ïÊù•ÁúüÊ≠£ÁöÑËé∑Âèñbean„ÄÇ
    // ÂèÇÊï∞ËØ¥ÊòéÔºö
    // 1. name: Ë¶ÅËé∑ÂèñÁöÑbeanÁöÑÂêçÁß∞„ÄÇ
    // 2. null: beanÁöÑÊâÄÈúÄÁ±ªÂûãÔºåËøôÈáå‰∏∫nullË°®Á§∫Ê≤°ÊúâÊåáÂÆöÂÖ∑‰ΩìÁ±ªÂûã„ÄÇ
    // 3. null: ÊûÑÈÄ†ÂáΩÊï∞ÊàñÂ∑•ÂéÇÊñπÊ≥ïÁöÑÂèÇÊï∞ÔºåËøôÈáå‰∏∫nullË°®Á§∫ÈªòËÆ§ÊûÑÈÄ†ÊñπÊ≥ïÊàñÂ∑•ÂéÇÊñπÊ≥ï„ÄÇ
    // 4. false: ÊåáÂÆöÊòØÂê¶‰ªÖËøõË°åÁ±ªÂûãÊ£ÄÊü•ÔºåfalseË°®Á§∫ÈúÄË¶ÅÂÆû‰æãÂåñbean„ÄÇ
    return doGetBean(name, null, null, false);
}
```

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÔºåÊòØSpringÊ°ÜÊû∂‰∏≠`AbstractBeanFactory`Á±ªÁöÑÊ†∏ÂøÉÊñπÊ≥ïÔºåÁî®‰∫éËé∑ÂèñbeanÂÆû‰æã„ÄÇÂÆÉËÄÉËôë‰∫ÜÂçï‰æã„ÄÅÂéüÂûã„ÄÅÁâπÂÆö‰ΩúÁî®ÂüübeanÁöÑÂàõÂª∫ÔºåËøòÂ§ÑÁêÜ‰∫ÜbeanÂÆö‰πâ„ÄÅÂæ™ÁéØÂºïÁî®„ÄÅ‰æùËµñÁ≠âÂêÑÁßçÊÉÖÂÜµ„ÄÇ

```java
protected <T> T doGetBean(
			String name, @Nullable Class<T> requiredType, @Nullable Object[] args, boolean typeCheckOnly)
			throws BeansException {

    // Ê≠•È™§1: ËΩ¨Êç¢beanÂêçÁß∞
    String beanName = transformedBeanName(name);

    // Ê≠•È™§2: Â∞ùËØï‰ªéÁºìÂ≠ò‰∏≠Ê£ÄÁ¥¢Âçï‰æãbean
    Object sharedInstance = getSingleton(beanName);
    Object beanInstance;

    if (sharedInstance != null && args == null) {
        // Ëé∑ÂèñbeanÂÆû‰æãÊú¨Ë∫´
        beanInstance = getObjectForBeanInstance(sharedInstance, name, beanName, null);
    }
    else {
        // Ê≠•È™§3: Â§ÑÁêÜÂéüÂûã‰ΩúÁî®ÂüüÁöÑbeanÔºåÂπ∂Ê£ÄÊü•ÊòØÂê¶Â∑≤Âú®ÂàõÂª∫‰∏≠
        if (isPrototypeCurrentlyInCreation(beanName)) {
            throw new BeanCurrentlyInCreationException(beanName);
        }

        // Ê≠•È™§4: Â∞ùËØïÂú®Áà∂BeanÂ∑•ÂéÇ‰∏≠Ê£ÄÁ¥¢beanÂÆö‰πâ
        BeanFactory parentBeanFactory = getParentBeanFactory();

        if (parentBeanFactory != null && !containsBeanDefinition(beanName)) {
            String nameToLookup = originalBeanName(name);
            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            return (T) parentBeanFactory.getBean(nameToLookup);
        }

        // Ê≠•È™§5: Ê†áËÆ∞bean‰∏∫Â∑≤ÂàõÂª∫Áä∂ÊÄÅ
        if (!typeCheckOnly) {
            markBeanAsCreated(beanName);
        }

        try {
            // Ê≠•È™§6: Ëé∑ÂèñÂêàÂπ∂ÂêéÁöÑbeanÂÆö‰πâ
            RootBeanDefinition mbd = getMergedLocalBeanDefinition(beanName);
            checkMergedBeanDefinition(mbd, beanName, args);

            // Ê≠•È™§7: Á°Æ‰øùbeanÁöÑ‰æùËµñÂ∑≤ÁªèÂàùÂßãÂåñ
            String[] dependsOn = mbd.getDependsOn();
            if (dependsOn != null) {
                for (String dep : dependsOn) {
                    // Ê≠•È™§7.1: ÊòØÂê¶Â≠òÂú®Âæ™ÁéØ‰æùËµñ
                    if (isDependent(beanName, dep)) {
                       // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
                    }
                    // Ê≠•È™§7.2: Ê≥®ÂÜåBean‰∏éBean‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ª
                    registerDependentBean(dep, beanName);
                    // Ê≠•È™§7.3: Ëé∑ÂèñË¢´‰æùËµñÁöÑBeanÂØπË±°
                    getBean(dep);
                }
            }

            // Ê≠•È™§8: Ê†πÊçÆbeanÁöÑ‰ΩúÁî®ÂüüÔºåÂàõÂª∫ÊàñÊ£ÄÁ¥¢beanÂÆû‰æã
            if (mbd.isSingleton()) {
                // Ê≠•È™§8.1: Â§ÑÁêÜÂçï‰æã‰ΩúÁî®Âüü
                sharedInstance = getSingleton(beanName, () -> {
                    try {
                        // Ê≠•È™§8.2: ÂàõÂª∫Bean
                        return createBean(beanName, mbd, args);
                    }
                    catch (BeansException ex) {
                        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
                    }
                });
                // Ê≠•È™§8.3: Ëé∑ÂèñbeanÂÆû‰æãÊú¨Ë∫´
                beanInstance = getObjectForBeanInstance(sharedInstance, name, beanName, mbd);
            }
            else if (mbd.isPrototype()) {
                // Â§ÑÁêÜÂéüÂûã‰ΩúÁî®Âüü
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            }
            else {
                // Â§ÑÁêÜÂÖ∂‰ªñ‰ΩúÁî®Âüü
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            }
        }
        catch (BeansException ex) {
            // Â§ÑÁêÜbeanÂàõÂª∫Â§±Ë¥•ÁöÑÊÉÖÂÜµ
            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
        }
        finally {
            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
        }
    }

    // Ê≠•È™§9: ÈÄÇÈÖçbeanÂÆû‰æã
    return adaptBeanInstance(name, beanInstance, requiredType);
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§1„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#transformedBeanName`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶Å‰ΩúÁî®ÊòØÂØπÁªôÂÆöÁöÑbeanÂêçÁß∞ËøõË°åËΩ¨Êç¢ÔºåÁ°Æ‰øùËøîÂõûÁöÑÂêçÁß∞ÊòØËßÑËåÉÁöÑ„ÄÅÊ≤°Êúâ‰ªª‰ΩïÂâçÁºÄÔºåÂπ∂Â§ÑÁêÜÂèØËÉΩÁöÑÂà´Âêç„ÄÇ

```java
protected String transformedBeanName(String name) {
    // È¶ñÂÖàÔºå‰ΩøÁî®BeanFactoryUtilsÁöÑtransformedBeanNameÊñπÊ≥ïÊù•Â§ÑÁêÜ‰º†ÂÖ•ÁöÑname„ÄÇ
    // ËøôÈÄöÂ∏∏Áî®‰∫éÁßªÈô§beanÂêçÁß∞ÂâçÁºÄÔºå‰æãÂ¶Ç"&"ÔºåËøôÂú®Â∑•ÂéÇbeans‰∏≠‰ΩøÁî®„ÄÇ
    // ‰ΩøÁî®canonicalNameÊñπÊ≥ïÊù•Ëé∑ÂèñÂà´ÂêçÊò†Â∞ÑÂêéÁöÑÁúüÂÆûbeanÂêçÁß∞„ÄÇ
    return canonicalName(BeanFactoryUtils.transformedBeanName(name));
}
```

Âú®`org.springframework.core.SimpleAliasRegistry#canonicalName`ÊñπÊ≥ï‰∏≠ÔºåÊåÅÁª≠Âú∞‰ªéÂà´ÂêçÊò†Â∞Ñ‰∏≠Êü•ÊâæÁúüÂÆûÁöÑbeanÂêçÁß∞ÔºåÁõ¥Âà∞Êâæ‰∏çÂà∞Êõ¥Â§öÁöÑÂà´Âêç‰∏∫Ê≠¢Ôºå‰ªéËÄåÁ°Æ‰øùËøîÂõûÁöÑÊòØÁúüÂÆûÁöÑbeanÂêçÁß∞ÔºåËÄå‰∏çÊòØ‰ªª‰ΩïÂà´Âêç„ÄÇ

```java
public String canonicalName(String name) {
    // ÂàùÂßãÂåñcanonicalName‰∏∫‰º†ÂÖ•ÁöÑname
    String canonicalName = name; 

    // Âæ™ÁéØÂ§ÑÁêÜÂà´ÂêçÊò†Â∞Ñ
    String resolvedName;
    do {
        // ‰ªéÂà´ÂêçÊò†Â∞Ñ‰∏≠Ëé∑ÂèñÁúüÂÆûÁöÑbeanÂêçÁß∞
        resolvedName = this.aliasMap.get(canonicalName);
        
        // Â¶ÇÊûúÊâæÂà∞‰∫Ü‰∏Ä‰∏™ÁúüÂÆûÁöÑbeanÂêçÁß∞ÔºàÂç≥resolvedName‰∏ç‰∏∫nullÔºâÔºåÂàôÊõ¥Êñ∞canonicalName‰∏∫Ëøô‰∏™Êñ∞ÊâæÂà∞ÁöÑÂêçÁß∞
        if (resolvedName != null) {
            canonicalName = resolvedName;
        }
    } 
    // Â¶ÇÊûúËøòÂèØ‰ª•Âú®aliasMap‰∏≠ÊâæÂà∞resolvedNameÁöÑÂà´ÂêçÔºåÁªßÁª≠Âæ™ÁéØ
    while (resolvedName != null);

    // ËøîÂõûÊúÄÁªàÁ°ÆÂÆöÁöÑbeanÂêçÁß∞
    return canonicalName;
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§2„ÄÇ

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#getSingleton(beanName)`ÊñπÊ≥ï‰∏≠ÔºåÁõÆÁöÑÊòØÁÆÄÂåñÂçï‰æãbeanÁöÑËé∑ÂèñËøáÁ®ã„ÄÇÂÆÉÈªòËÆ§ÂÖÅËÆ∏Âú®beanÊ≠£Âú®ÂàõÂª∫ËøáÁ®ã‰∏≠ËøîÂõûÊó©ÊúüÁöÑbeanÂºïÁî®ÔºåËøôÂú®Ëß£ÂÜ≥Âæ™ÁéØ‰æùËµñÁöÑÂú∫ÊôØ‰∏≠ÊòØÊúâÁî®ÁöÑ„ÄÇ

```java
@Override
@Nullable
public Object getSingleton(String beanName) {
    // Ë∞ÉÁî®ÈáçËΩΩÁöÑgetSingletonÊñπÊ≥ïÊù•Ëé∑ÂèñÂçï‰æãbean„ÄÇ
    // ÂèÇÊï∞ËØ¥ÊòéÔºö
    // 1. beanName: Ë¶ÅËé∑ÂèñÁöÑÂçï‰æãbeanÁöÑÂêçÁß∞„ÄÇ
    // 2. true: Ë°®Á§∫Â¶ÇÊûúÂΩìÂâçbeanÊ≠£Âú®ÂàõÂª∫‰∏≠Ôºà‰æãÂ¶ÇÂ§ÑÁêÜÂæ™ÁéØÂºïÁî®ÁöÑÊÉÖÂÜµÔºâÔºåÂàôÂÖÅËÆ∏ËøîÂõûÊó©ÊúüÁöÑÂçï‰æãbeanÂºïÁî®„ÄÇ
    return getSingleton(beanName, true);
}
```

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#getSingleton(beanName,allowEarlyReference)`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁõÆÁöÑÊòØÊ£ÄÁ¥¢beanNameÊåáÂÆöÁöÑÂçï‰æãÂØπË±°ÔºåËÄÉËôë‰∫ÜÂ§öÁßçÂèØËÉΩÁöÑÁºìÂ≠ò‰ΩçÁΩÆÔºåÂåÖÊã¨ÂÆåÂÖ®ÂàùÂßãÂåñÁöÑÁºìÂ≠ò„ÄÅÊó©ÊúüÁöÑÂçï‰æãÂØπË±°ÁºìÂ≠òÂíåÂçï‰æãÂ∑•ÂéÇÁºìÂ≠ò„ÄÇÂ¶ÇÊûúbeanÁõÆÂâçÊ≠£Âú®ÂàõÂª∫‰∏≠ÔºàËøôÂèØËÉΩÊòØÁî±‰∫éÂæ™ÁéØÂºïÁî®ÔºâÔºåËØ•ÊñπÊ≥ïËøò‰ºöÂ§ÑÁêÜËøôÁßçÊÉÖÂÜµ„ÄÇ

```java
@Nullable
protected Object getSingleton(String beanName, boolean allowEarlyReference) {
    // Â∞ùËØï‰ªéÁºìÂ≠ò‰∏≠Âø´ÈÄüÊ£ÄÁ¥¢Â∑≤Â≠òÂú®ÁöÑbeanÂÆû‰æãÔºåÈÅøÂÖçÂÆåÂÖ®ÈîÅÂÆöÂçï‰æã
    Object singletonObject = this.singletonObjects.get(beanName);
    
    // Â¶ÇÊûúÊâæ‰∏çÂà∞ÂÆû‰æãÔºåÂπ∂‰∏îËØ•beanÂΩìÂâçÊ≠£Âú®ÂàõÂª∫‰∏≠Ôºà‰æãÂ¶ÇÔºåÂ§ÑÁêÜÂæ™ÁéØÂºïÁî®Ôºâ
    if (singletonObject == null && isSingletonCurrentlyInCreation(beanName)) {
        singletonObject = this.earlySingletonObjects.get(beanName);
        
        // Â¶ÇÊûúÂÖÅËÆ∏ÊèêÂâçÂºïÁî®Âπ∂‰∏îÂú®Êó©ÊúüÂçï‰æãÂØπË±°‰∏≠‰ªçÊú™ÊâæÂà∞
        if (singletonObject == null && allowEarlyReference) {
            synchronized (this.singletonObjects) {
                // Âú®ÂÆåÊï¥ÁöÑÂçï‰æãÈîÅÂÆöËåÉÂõ¥ÂÜÖÔºåÁ°Æ‰øùÊó©ÊúüÂºïÁî®ÁöÑ‰∏ÄËá¥ÊÄßÂàõÂª∫
                singletonObject = this.singletonObjects.get(beanName);
                if (singletonObject == null) {
                    singletonObject = this.earlySingletonObjects.get(beanName);
                    
                    // Â¶ÇÊûúÂú®Êó©ÊúüÁöÑÂçï‰æãÂØπË±°‰∏≠‰ªçÁÑ∂Êâæ‰∏çÂà∞ÔºåÂπ∂‰∏îÂ≠òÂú®‰∏Ä‰∏™Âçï‰æãÂ∑•ÂéÇÊù•ÂàõÂª∫Ëøô‰∏™bean
                    if (singletonObject == null) {
                        ObjectFactory<?> singletonFactory = this.singletonFactories.get(beanName);
                        if (singletonFactory != null) {
                            // ‰ΩøÁî®Âçï‰æãÂ∑•ÂéÇÂàõÂª∫bean
                            singletonObject = singletonFactory.getObject();
                            // Â∞ÜÊñ∞ÂàõÂª∫ÁöÑbeanÂ≠òÊîæÂà∞Êó©ÊúüÂçï‰æãÂØπË±°ÁºìÂ≠ò‰∏≠
                            this.earlySingletonObjects.put(beanName, singletonObject);
                            // ‰ªéÂçï‰æãÂ∑•ÂéÇÁºìÂ≠ò‰∏≠Âà†Èô§ÂØπÂ∫îÁöÑÂ∑•ÂéÇ
                            this.singletonFactories.remove(beanName);
                        }
                    }
                }
            }
        }
    }
    // ËøîÂõûÊâæÂà∞ÁöÑÂçï‰æãbeanÂÆû‰æãÔºåÂ¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ÂàôËøîÂõûnull
    return singletonObject;
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§3„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#isPrototypeCurrentlyInCreation`ÊñπÊ≥ï‰∏≠ÔºåÊ£ÄÊü•‰∏Ä‰∏™ÁâπÂÆöÁöÑbeanÂêçÁß∞ÊòØÂê¶Ê≠£Âú®ÂàõÂª∫‰∏≠ÁöÑÂéüÂûãbeansÂàóË°®‰∏≠„ÄÇËøôÊòØ‰∏∫‰∫ÜÂ§ÑÁêÜÂèØËÉΩÂá∫Áé∞ÁöÑÂéüÂûãbeanÁöÑÂæ™ÁéØÂºïÁî®„ÄÇ

```java
protected boolean isPrototypeCurrentlyInCreation(String beanName) {
    // Ëé∑ÂèñÂΩìÂâçÊ≠£Âú®ÂàõÂª∫ÁöÑÂéüÂûãbeanÁöÑÂÄº
    Object curVal = this.prototypesCurrentlyInCreation.get();

    // Ê£ÄÊü•ÂΩìÂâçÂÄºÊòØÂê¶‰∏ç‰∏∫Á©∫ÔºåÂπ∂‰∏î
    // 1) ÂΩìÂâçÂÄºÊòØÂê¶Á≠â‰∫éÁªôÂÆöÁöÑbeanÂêçÁß∞ÔºåÊàñËÄÖ
    // 2) ÂΩìÂâçÂÄºÊòØÂê¶ÊòØ‰∏Ä‰∏™SetÂπ∂‰∏îËØ•SetÂåÖÂê´ÁªôÂÆöÁöÑbeanÂêçÁß∞
    return (curVal != null &&
            (curVal.equals(beanName) || (curVal instanceof Set && ((Set<?>) curVal).contains(beanName))));
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§5„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#markBeanAsCreated`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁõÆÁöÑÊòØÊ†áËÆ∞ÊåáÂÆöÁöÑbeanÂ∑≤ÁªèË¢´ÂàõÂª∫ÊàñÊ≠£Âú®Ë¢´ÂàõÂª∫„ÄÇÂÆÉÂú®SpringÁöÑbeanÁîüÂëΩÂë®Êúü‰∏≠Ëµ∑Âà∞ÂÖ≥ÈîÆ‰ΩúÁî®ÔºåÁâπÂà´ÊòØÂΩìÈúÄË¶ÅÁ°Æ‰øùbeanÂè™Ë¢´ÂàõÂª∫‰∏ÄÊ¨°ÊàñËÄÖÂØπÂÖ∂ËøõË°åÊüê‰∫õÁä∂ÊÄÅÊ£ÄÊü•Êó∂„ÄÇ

```java
protected void markBeanAsCreated(String beanName) {
    // 1. ÂàùÊ≠•Ê£ÄÊü•beanÊòØÂê¶Â∑≤Ë¢´Ê†áËÆ∞‰∏∫Â∑≤ÂàõÂª∫
    if (!this.alreadyCreated.contains(beanName)) {
        
        // 2. ‰∏∫‰∫ÜÁ°Æ‰øùÂú®Â§öÁ∫øÁ®ãÁéØÂ¢É‰∏ãÁöÑÁ∫øÁ®ãÂÆâÂÖ®ÔºåËøõË°åÂêåÊ≠•Êìç‰Ωú
        synchronized (this.mergedBeanDefinitions) {
            
            // 3. ÂèåÈáçÊ£ÄÊü•ÈîÅÂÆöÊ®°ÂºèÔºöÂÜçÊ¨°Á°ÆËÆ§beanÊòØÂê¶Â∑≤Ë¢´Ê†áËÆ∞‰∏∫Â∑≤ÂàõÂª∫
            if (!this.alreadyCreated.contains(beanName)) {
                
                // 4. Ê∏ÖÈô§beanÁöÑÂêàÂπ∂ÂÆö‰πâÔºå‰ª•‰æøÂú®ÂêéÁª≠ËÆøÈóÆÊó∂ÈáçÊñ∞ÂêàÂπ∂
                clearMergedBeanDefinition(beanName);
                
                // 5. Âú®ÈõÜÂêà‰∏≠Ê†áËÆ∞beanÂ∑≤Ë¢´ÂàõÂª∫
                this.alreadyCreated.add(beanName);
            }
        }
    }
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§6„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#getMergedLocalBeanDefinition`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÊòØÁî®‰∫éËé∑ÂèñÁªôÂÆöbeanÂêçÁß∞ÁöÑÂêàÂπ∂beanÂÆö‰πâ„ÄÇÂêàÂπ∂ÁöÑbeanÂÆö‰πâÊòØ‰ªéÁà∂beanÂíåÂ≠êbeanÔºàÂ¶ÇÊûúÊúâÁöÑËØùÔºâÂÆö‰πâ‰∏≠ÂêàÂπ∂ÁöÑÁªìÊûú„ÄÇ

```java
protected RootBeanDefinition getMergedLocalBeanDefinition(String beanName) throws BeansException {
    // 1. Âø´ÈÄü‰ªéÂπ∂ÂèëÊò†Â∞Ñ‰∏≠Ê£ÄÊü•beanÂÆö‰πâÔºåËøôÊ†∑ÂÅöÂèØ‰ª•ÊúÄÂ∞èÂåñÈîÅÂÆö„ÄÇ
    RootBeanDefinition mbd = this.mergedBeanDefinitions.get(beanName);
    
    // 2. Â¶ÇÊûúÂêàÂπ∂ÁöÑbeanÂÆö‰πâÂ≠òÂú®Âπ∂‰∏îÊ≤°ÊúâËøáÊúüÔºåÁõ¥Êé•ËøîÂõûÂÆÉ„ÄÇ
    if (mbd != null && !mbd.stale) {
        return mbd;
    }
    
    // 3. Â¶ÇÊûú‰∏äËø∞Ê£ÄÊü•Â§±Ë¥•ÔºåËøõ‰∏ÄÊ≠•Ëé∑ÂèñÂπ∂ËøîÂõûÂêàÂπ∂ÁöÑbeanÂÆö‰πâ„ÄÇ
    return getMergedBeanDefinition(beanName, getBeanDefinition(beanName));
}
```

Âú®`org.springframework.beans.factory.support.DefaultListableBeanFactory#getBeanDefinition`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁî®‰∫é‰ªéÂΩìÂâçBeanÂ∑•ÂéÇÁöÑbeanÂÆö‰πâÊò†Â∞Ñ‰∏≠Ê£ÄÁ¥¢ÊåáÂÆöÂêçÁß∞ÁöÑbeanÂÆö‰πâ„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ÊåáÂÆöÁöÑbeanÂÆö‰πâÔºåÂÆÉ‰ºöÊäõÂá∫‰∏Ä‰∏™`NoSuchBeanDefinitionException`ÂºÇÂ∏∏„ÄÇ

```java
@Override
public BeanDefinition getBeanDefinition(String beanName) throws NoSuchBeanDefinitionException {
    // 1. ‰ªébeanDefinitionMap‰∏≠Ëé∑ÂèñbeanÁöÑÂÆö‰πâ
    BeanDefinition bd = this.beanDefinitionMap.get(beanName);
    
    // 2. Â¶ÇÊûúÊ≤°ÊúâÊâæÂà∞BeanDefinitionÔºåËøõË°åÊó•ÂøóË∑üË∏™Âπ∂ÊäõÂá∫ÂºÇÂ∏∏
    if (bd == null) {
        // Â¶ÇÊûúÂêØÁî®‰∫ÜtraceÁ∫ßÂà´ÁöÑÊó•ÂøóÔºåËÆ∞ÂΩï‰∏ÄÊù°Êó•Âøó
        if (logger.isTraceEnabled()) {
            logger.trace("No bean named '" + beanName + "' found in " + this);
        }
        // ÊäõÂá∫Ê≤°ÊúâÊâæÂà∞BeanDefinitionÁöÑÂºÇÂ∏∏
        throw new NoSuchBeanDefinitionException(beanName);
    }
    
    // 3. ËøîÂõûÊâæÂà∞ÁöÑBeanDefinition
    return bd;
}
```

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#getMergedBeanDefinition(beanName, bd)`ÊñπÊ≥ï‰∏≠ÔºåÂèàË∞ÉÁî®‰∫ÜÂè¶‰∏Ä‰∏™`getMergedBeanDefinition`ÊñπÊ≥ïÁâàÊú¨Ôºå‰∏∫ÁªôÂÆöÁöÑBeanÂêçÁß∞ÂíåBeanÂÆö‰πâËé∑Âèñ‰∏Ä‰∏™ÂêàÂπ∂ÁöÑ`RootBeanDefinition`„ÄÇ

```java
protected RootBeanDefinition getMergedBeanDefinition(String beanName, BeanDefinition bd)
			throws BeanDefinitionStoreException {

    // ‰∏∫ÁªôÂÆöÁöÑBeanÂêçÁß∞ÂíåBeanÂÆö‰πâËé∑Âèñ‰∏Ä‰∏™ÂêàÂπ∂ÁöÑRootBeanDefinitionÔºå
    // Áî±‰∫éËøô‰∏™ÁâàÊú¨ÁöÑÊñπÊ≥ïÊ≤°ÊúâÊèê‰æõ‰∏Ä‰∏™Áà∂BeanÂÆö‰πâÔºåÊâÄ‰ª•Êàë‰ª¨‰º†ÈÄínull‰Ωú‰∏∫Á¨¨‰∏â‰∏™ÂèÇÊï∞„ÄÇ
    return getMergedBeanDefinition(beanName, bd, null);
}
```

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#getMergedBeanDefinition(beanName,bd,containingBd)`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁõÆÁöÑÊòØËé∑ÂèñÊåáÂÆöbeanÂêçÁß∞ÁöÑÂêàÂπ∂beanÂÆö‰πâ„ÄÇÂÆÉÁöÑ‰∏ªË¶ÅÂ∑•‰ΩúÊòØÂ§ÑÁêÜbeanÂÆö‰πâÁöÑÁà∂Â≠êÂÖ≥Á≥ªÂíåÂÖ∂‰ªñÁõ∏ÂÖ≥ËÆæÁΩÆÔºåÁÑ∂ÂêéËøîÂõû‰∏Ä‰∏™ÂêàÂπ∂ÂêéÁöÑbeanÂÆö‰πâ„ÄÇ

```java
protected RootBeanDefinition getMergedBeanDefinition(
        String beanName, BeanDefinition bd, @Nullable BeanDefinition containingBd)
        throws BeanDefinitionStoreException {

    // 1. ÂØπmergedBeanDefinitionsËøõË°åÂêåÊ≠•‰ª•Á°Æ‰øùÁ∫øÁ®ãÂÆâÂÖ®„ÄÇ
    synchronized (this.mergedBeanDefinitions) {
        RootBeanDefinition mbd = null;
        RootBeanDefinition previous = null;

        // 2. Âú®ÂÆåÊï¥ÁöÑÈîÅÂÆö‰∏≠Ê£ÄÊü•Ôºå‰ª•Á°Æ‰øù‰ΩøÁî®Áõ∏ÂêåÁöÑÂêàÂπ∂ÂÆû‰æã„ÄÇ
        if (containingBd == null) {
            mbd = this.mergedBeanDefinitions.get(beanName);
        }

        // 3. Â¶ÇÊûúbeanÂÆö‰πâÊú™Ë¢´ÂêàÂπ∂ÊàñÂ∑≤ËøáÊúüÔºåËøõË°åÂêàÂπ∂Êìç‰Ωú„ÄÇ
        if (mbd == null || mbd.stale) {
            previous = mbd;

            // 4. Â§ÑÁêÜÊ≤°ÊúâÁà∂ÂÆö‰πâÁöÑÊÉÖÂÜµ„ÄÇ
            if (bd.getParentName() == null) {
                if (bd instanceof RootBeanDefinition) {
                    mbd = ((RootBeanDefinition) bd).cloneBeanDefinition();
                }
                else {
                    mbd = new RootBeanDefinition(bd);
                }
            }
            // 5. Â§ÑÁêÜÊúâÁà∂ÂÆö‰πâÁöÑÊÉÖÂÜµÔºöÈúÄË¶Å‰∏éÁà∂ÂÆö‰πâÂêàÂπ∂„ÄÇ
            else {
                BeanDefinition pbd;
                try {
                    String parentBeanName = transformedBeanName(bd.getParentName());
                    if (!beanName.equals(parentBeanName)) {
                        pbd = getMergedBeanDefinition(parentBeanName);
                    }
                    else {
                        BeanFactory parent = getParentBeanFactory();
                        if (parent instanceof ConfigurableBeanFactory) {
                            pbd = ((ConfigurableBeanFactory) parent).getMergedBeanDefinition(parentBeanName);
                        }
                        else {
                            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
                        }
                    }
                }
                catch (NoSuchBeanDefinitionException ex) {
                    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
                }
                mbd = new RootBeanDefinition(pbd);
                mbd.overrideFrom(bd);
            }

            // 6. Â¶ÇÊûúbeanÂÆö‰πâÁöÑËåÉÂõ¥Ê≤°ÊúâÊòéÁ°ÆËÆæÁΩÆÔºåÂ∞ÜÂÖ∂ÈªòËÆ§‰∏∫Âçï‰æã„ÄÇ
            if (!StringUtils.hasLength(mbd.getScope())) {
                mbd.setScope(SCOPE_SINGLETON);
            }

            // 7. ÈùûÂçï‰æãbean‰∏≠ÁöÑbean‰∏çËÉΩÊòØÂçï‰æã„ÄÇÂú®ËøôÈáå‰øÆÂ§çËøôÁßçÊÉÖÂÜµ„ÄÇ
            if (containingBd != null && !containingBd.isSingleton() && mbd.isSingleton()) {
                mbd.setScope(containingBd.getScope());
            }

            // 8. Â¶ÇÊûúÈúÄË¶ÅÔºåÁºìÂ≠òÂêàÂπ∂ÂêéÁöÑbeanÂÆö‰πâ„ÄÇ
            if (containingBd == null && isCacheBeanMetadata()) {
                this.mergedBeanDefinitions.put(beanName, mbd);
            }
        }
        // 9. Â¶ÇÊûú‰πãÂâçÂ≠òÂú®‰∏Ä‰∏™beanÂÆö‰πâÔºåÂ§çÂà∂Áõ∏ÂÖ≥ÁöÑÁºìÂ≠ò„ÄÇ
        if (previous != null) {
            copyRelevantMergedBeanDefinitionCaches(previous, mbd);
        }

        // 10. ËøîÂõûÂêàÂπ∂ÂêéÁöÑbeanÂÆö‰πâ„ÄÇ
        return mbd;
    }
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§7.1„ÄÇ

Âú®SpringÁöÑbeanÂàùÂßãÂåñËøáÁ®ã‰∏≠Ôºå`@DependsOn`Ê≥®Ëß£ÊâÆÊºî‰∫Ü‰∏Ä‰∏™ÂÖ≥ÈîÆÁöÑËßíËâ≤ÔºåÁî®‰∫éÁ°Æ‰øùÊüê‰∏™beanÂú®ÂÖ∂‰ªñÊåáÂÆöÁöÑbeans‰πãÂâçÂàùÂßãÂåñ„ÄÇ‰∏ãÈù¢ÁöÑ‰ª£Á†ÅÁâáÊÆµËØ¶ÁªÜÂ±ïÁ§∫‰∫ÜÂ¶Ç‰ΩïÂ§ÑÁêÜËøô‰∏™Ê≥®Ëß£„ÄÇ‰∏∫‰∫ÜÊ∑±ÂÖ•‰∫ÜËß£Ëøô‰∫õÁªÜËäÇÔºåÁâπÂà´ÊòØ`@DependsOn`Ê≥®Ëß£ËÉåÂêéÁöÑÂ∑•‰ΩúÂéüÁêÜÔºåÊàëÂª∫ËÆÆÂèÇËÄÉËøôÁØáÊñáÁ´†: [**ÂàùÂßãÂåñÈ°∫Â∫è@DependsOn**](https://github.com/xuchengsheng/spring-reading/blob/master/spring-annotation/spring-annotation-dependsOn) - Á≤æÁ°ÆÊéßÂà∂ Spring Beans ÁöÑÂä†ËΩΩÈ°∫Â∫è„ÄÇËøôÁØáÊñáÁ´†ËØ¶ÁªÜËß£Êûê‰∫ÜÊ≥®Ëß£ÁöÑÊ∫êÁ†ÅÔºåÂπ∂Ê∑±ÂÖ•Êé¢ËÆ®‰∫ÜÂÖ∂Âú®SpringÊ°ÜÊû∂‰∏≠ÁöÑ‰ΩúÁî®„ÄÇ

```java
String[] dependsOn = mbd.getDependsOn();
if (dependsOn != null) {
    for (String dep : dependsOn) {
        // Ê≠•È™§7.1: ÊòØÂê¶Â≠òÂú®Âæ™ÁéØ‰æùËµñ
        // ÂÆÉÈ¶ñÂÖàÊ£ÄÊü•ÊòØÂê¶Â≠òÂú®Âæ™ÁéØ‰æùËµñÔºåËøôÊÑèÂë≥ÁùÄBean A‰æùËµñBean BÔºåËÄåBean BÂèà‰æùËµñBean A„ÄÇ
        // Â¶ÇÊûúÂ≠òÂú®ËøôÊ†∑ÁöÑÊÉÖÂÜµÂÆÉ‰ºöÊäõÂá∫‰∏Ä‰∏™BeanCreationExceptionÂºÇÂ∏∏„ÄÇ
        if (isDependent(beanName, dep)) {
            throw new BeanCreationException(mbd.getResourceDescription(), beanName,
                                            "Circular depends-on relationship between '" + beanName + "' and '" + dep + "'");
        }
        // Ê≠•È™§7.2: Ê≥®ÂÜåBean‰∏éBean‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ª
        // ÂΩìÂâçÁöÑBeanÂ∑•ÂéÇ‰∏≠Ê≥®ÂÜåbean‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ª„ÄÇËøôÊ†∑ÔºåÂΩìËé∑ÂèñÊàñÈîÄÊØÅbeanÊó∂ÔºåSpringÂèØ‰ª•‰øùÊåÅÊ≠£Á°ÆÁöÑÈ°∫Â∫è„ÄÇ
        registerDependentBean(dep, beanName);
        // Ê≠•È™§7.3: Ëé∑ÂèñË¢´‰æùËµñÁöÑBeanÂØπË±°
        // Á°Æ‰øùÊØè‰∏™Ë¢´‰æùËµñÁöÑbeanÈÉΩÂ∑≤ÁªèË¢´ÂàõÂª∫„ÄÇËøôÊòØÈÄöËøáÁõ¥Êé•Ë∞ÉÁî®getBeanÊñπÊ≥ïÂÆåÊàêÁöÑÔºåËØ•ÊñπÊ≥ïË¥üË¥£ÂàùÂßãÂåñÂπ∂ËøîÂõûÊåáÂÆöÁöÑbean„ÄÇ
        getBean(dep);
    }
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§8.1„ÄÇ

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#getSingleton(beanName,singletonFactory)`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÂ∞ùËØï‰ªéÁºìÂ≠ò‰∏≠Ê£ÄÁ¥¢ËØ•bean„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ÔºåÂÆÉ‰ºö‰ΩøÁî®Êèê‰æõÁöÑ`singletonFactory`Êù•ÂàõÂª∫Ëøô‰∏™beanÔºåÂπ∂Âú®ÂàõÂª∫ËøáÁ®ã‰∏≠ËøõË°åÂâçÁΩÆÂíåÂêéÁΩÆÂ§ÑÁêÜÔºå‰ª•Á°Æ‰øùÂ§ÑÁêÜËØ∏Â¶ÇÂæ™ÁéØÂºïÁî®Á≠âÈóÆÈ¢ò„ÄÇÂàõÂª∫ÁöÑbean‰ºöË¢´Ê∑ªÂä†Âà∞ÁºìÂ≠ò‰∏≠„ÄÇÊ≠§Â§ñÔºåËØ•ÊñπÊ≥ïËøòÂ§ÑÁêÜ‰∫ÜÂú®ÂàõÂª∫ËøáÁ®ã‰∏≠ÂèØËÉΩÂá∫Áé∞ÁöÑÂêÑÁßçÂºÇÂ∏∏ÔºåÂπ∂Á°Æ‰øùÂú®Â§öÁ∫øÁ®ãÁéØÂ¢É‰∏≠ÁöÑÁ∫øÁ®ãÂÆâÂÖ®„ÄÇÊúÄÂêéÔºåËøîÂõûÊâÄÈúÄÁöÑÂçï‰æãbean„ÄÇ

```java
public Object getSingleton(String beanName, ObjectFactory<?> singletonFactory) {
    synchronized (this.singletonObjects) {
        // È¶ñÂÖàÂ∞ùËØï‰ªéÁºìÂ≠ò‰∏≠Ëé∑ÂèñÂçï‰æã
        Object singletonObject = this.singletonObjects.get(beanName);
        if (singletonObject == null) {
            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            
            // Ê≠•È™§1: ÂâçÁΩÆÂ§ÑÁêÜÔºå‰æãÂ¶ÇÊ†áËÆ∞Ëøô‰∏™beanÊ≠£Âú®ÂàõÂª∫Ôºå‰ª•Â§ÑÁêÜÂæ™ÁéØÂºïÁî®Á≠âÈóÆÈ¢ò„ÄÇ
            beforeSingletonCreation(beanName);
            
            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            try {
                // Ê≠•È™§2: ‰ΩøÁî®singletonFactoryÂàõÂª∫Âçï‰æãÂØπË±°
                singletonObject = singletonFactory.getObject();
                newSingleton = true;
            }
            catch (IllegalStateException ex) {
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            }
            catch (BeanCreationException ex) {
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            }
            finally {
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
                // Ê≠•È™§3: ÂàõÂª∫Âçï‰æã‰πãÂêéÁöÑÂõûË∞É
                afterSingletonCreation(beanName);
            }
            // Ê≠•È™§4: Â¶ÇÊûúÊàêÂäüÂàõÂª∫‰∫ÜÊñ∞ÁöÑÂçï‰æãbeanÔºåÂ∞ÜÂÖ∂Ê∑ªÂä†Âà∞ÁºìÂ≠ò‰∏≠
            if (newSingleton) {
                addSingleton(beanName, singletonObject);
            }
        }
        // ËøîÂõûÁé∞ÊúâÊàñÊñ∞ÂàõÂª∫ÁöÑÂçï‰æãbean
        return singletonObject;
    }
}
```

> `org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#getSingleton(beanName,singletonFactory)`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§1„ÄÇ

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#beforeSingletonCreation`ÊñπÊ≥ï‰∏≠ÔºåSpringÊ°ÜÊû∂Â∞ùËØïÂàõÂª∫Âçï‰æãbean‰πãÂâçË∞ÉÁî®ÁöÑÔºåÁî®‰∫éÁ°Æ‰øùÂΩìÂâçbeanÊ≤°ÊúâÂêåÊó∂Ë¢´Â§öÊ¨°ÂàõÂª∫ÔºåËøôÊ†∑ÂèØ‰ª•ÈÅøÂÖçÂõ†Âæ™ÁéØÂºïÁî®ÂØºËá¥ÁöÑÈóÆÈ¢ò„ÄÇÂ¶ÇÊûúbeanÂ∑≤ÁªèÂú®ÂàõÂª∫ËøáÁ®ã‰∏≠ÔºåÊ≠§ÊñπÊ≥ï‰ºöÊäõÂá∫‰∏Ä‰∏™ÂºÇÂ∏∏„ÄÇ

```java
protected void beforeSingletonCreation(String beanName) {
    // Ê£ÄÊü•beanNameÊòØÂê¶Âú®ÊéíÈô§ÂàóË°®‰∏≠ÊàñÂ∑≤ÁªèÂú®ÂàõÂª∫‰∏≠ÁöÑÈõÜÂêà‰∏≠„ÄÇ
    // Â¶ÇÊûúbean‰∏çÂú®ÊéíÈô§ÂàóË°®‰∏≠Âπ∂‰∏î‰πü‰∏çËÉΩÊ∑ªÂä†Âà∞ÂàõÂª∫‰∏≠ÁöÑÈõÜÂêà‰∏≠ÔºåÊÑèÂë≥ÁùÄbeanÂ∑≤ÁªèÂú®ÂàõÂª∫‰∏≠„ÄÇ
    if (!this.inCreationCheckExclusions.contains(beanName) && !this.singletonsCurrentlyInCreation.add(beanName)) {
        throw new BeanCurrentlyInCreationException(beanName);
    }
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§8.2„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#createBean(beanName, mbd, args)`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅË¥£Ê†πÊçÆÊåáÂÆöÁöÑbeanÂÆö‰πâÂàõÂª∫beanÂÆû‰æã„ÄÇÊ≠§ÊñπÊ≥ïËÄÉËôë‰∫ÜÂêÑÁßçÁªÜËäÇÔºå‰æãÂ¶ÇÊòØÂê¶ÊúâÂ∑•ÂéÇÊñπÊ≥ï„ÄÅÊûÑÈÄ†ÂáΩÊï∞Ê≥®ÂÖ•Á≠âÔºå‰ª•ÂèäÂ¶Ç‰ΩïÂ§ÑÁêÜÂâçÁΩÆÂíåÂêéÁΩÆÂ§ÑÁêÜÂô®„ÄÇ

```java
@Override
protected Object createBean(String beanName, RootBeanDefinition mbd, @Nullable Object[] args)
    throws BeanCreationException {

    // ÂØπmbdËøõË°å‰∏Ä‰∫õÈ¢ÑÂ§ÑÁêÜÔºåËøôÂèØËÉΩÂåÖÊã¨ÂÖãÈöÜbeanÂÆö‰πâÔºåÂ¶ÇÊûúmbdÊòØÈùûÂÖ±‰∫´ÁöÑÂéüÂûã„ÄÇ
    RootBeanDefinition mbdToUse = mbd;

    // Ê≠•È™§1: Â∞ùËØï‰ΩøÁî®InstantiationAwareBeanPostProcessorsÊù•ÂÆû‰æãÂåñbean„ÄÇ
    // Â¶ÇÊûúÂêéÂ§ÑÁêÜÂô®‰∫ßÁîübeanÂÆû‰æãÔºà‰æãÂ¶ÇÈÄöËøáAOP‰ª£ÁêÜÔºâÔºåÂàôÁõ¥Êé•ËøîÂõûËØ•ÂÆû‰æã„ÄÇ
    try {
        Object bean = resolveBeforeInstantiation(beanName, mbdToUse);
        if (bean != null) {
            return bean;
        }
    }
    catch (Throwable ex) {
        // Â¶ÇÊûúËß£ÊûêÂ§±Ë¥•ÔºåËÆ∞ÂΩïÂºÇÂ∏∏Âπ∂ÁªßÁª≠Â∏∏ËßÑÁöÑbeanÂàõÂª∫„ÄÇ
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }

    // Â¶ÇÊûúÂâçÁΩÆÂ§ÑÁêÜÊ≤°ÊúâËøîÂõûbeanÂÆû‰æãÔºåËøõÂÖ•Â∏∏ËßÑÁöÑbeanÂàõÂª∫ËøáÁ®ã„ÄÇ
    try {
        // Ê≠•È™§2: ÂàõÂª∫beanÂÆû‰æã„ÄÇËøôÂèØËÉΩÊòØÈÄöËøáÂ∑•ÂéÇÊñπÊ≥ï„ÄÅÊûÑÈÄ†ÂáΩÊï∞Ê≥®ÂÖ•Á≠âÂÆåÊàêÁöÑ„ÄÇ
        Object beanInstance = doCreateBean(beanName, mbdToUse, args);
        return beanInstance;
    }
    // ÊçïËé∑ÂàõÂª∫ËøáÁ®ã‰∏≠ÂèØËÉΩÂá∫Áé∞ÁöÑÂºÇÂ∏∏ÔºåÂπ∂Â§ÑÁêÜÂÆÉ‰ª¨„ÄÇ
    catch (BeanCreationException | ImplicitlyAppearedSingletonException ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }
    catch (Throwable ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#createBean(beanName, mbd, args)`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§1„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#resolveBeforeInstantiation`ÊñπÊ≥ï‰∏≠ÔºåÂú®SpringÊ°ÜÊû∂‰∏≠Ôºå`InstantiationAwareBeanPostProcessor`ÂÖÅËÆ∏Âú®Ê†áÂáÜÂÆû‰æãÂåñÂâçÊã¶Êà™beanÁöÑÂàõÂª∫„ÄÇËøô‰∏ÄÂäüËÉΩ‰∏ªË¶ÅÈÄöËøá`resolveBeforeInstantiation`ÊñπÊ≥ï‰ΩìÁé∞„ÄÇ‰∏∫Ê∑±ÂÖ•ÁêÜËß£ÂÖ∂Â∑•‰ΩúÊú∫Âà∂ÔºåÊé®ËçêÊàë‰ª¨ÈòÖËØªÔºö[**BeanÂÆû‰æãÊã¶Êà™InstantiationAwareBeanPostProcessor**](https://github.com/xuchengsheng/spring-reading/blob/master/spring-interface/spring-interface-instantiationAwareBeanPostProcessor)„ÄÇËøôÁØáÊñáÁ´†ËØ¶ÁªÜÊé¢ËÆ®‰∫ÜËØ•Êé•Âè£Âú®Spring‰∏≠ÁöÑÊ†∏ÂøÉ‰ΩúÁî®„ÄÇ

```java
@Nullable
protected Object resolveBeforeInstantiation(String beanName, RootBeanDefinition mbd) {
    // ÂàùÂßãÂåñ‰∏Ä‰∏™beanÂèòÈáèÔºåÂÆÉÂèØËÉΩ‰ºöË¢´ÂêéÁª≠ÁöÑÂ§ÑÁêÜËøáÁ®ãËµãÂÄº
    Object bean = null;
    
    // Ê£ÄÊü•'beforeInstantiationResolved'Â±ûÊÄßÊòØÂê¶‰∏∫FALSE„ÄÇÂ¶ÇÊûúÊòØFALSEÔºåÂàôË∑≥ËøáÂêéÁª≠ÁöÑÂ§ÑÁêÜ
    if (!Boolean.FALSE.equals(mbd.beforeInstantiationResolved)) {
        
        // È¶ñÂÖàÔºåÁ°Æ‰øùÊ≠§Êó∂ÁöÑbeanÁ±ªÂ∑≤ÁªèË¢´Ëß£Êûê„ÄÇ
        // ÁÑ∂ÂêéÔºåÂØπ‰∫éÈùûÂêàÊàêÁöÑbeanÔºåÂπ∂‰∏îÂ¶ÇÊûúÊúâ‰ªª‰ΩïInstantiationAwareBeanPostProcessorsÔºåÂ∞ùËØïËøõË°åÂâçÁΩÆÂ§ÑÁêÜ„ÄÇ
        if (!mbd.isSynthetic() && hasInstantiationAwareBeanPostProcessors()) {
            
            // Á°ÆÂÆöÁõÆÊ†áÁ±ªÂûã„ÄÇËøôÂèØËÉΩÊ∂âÂèäÂà∞Á±ªÁöÑËß£ÊûêÂíåÂÖ∂‰ªñÂàùÂßãÂåñÊìç‰Ωú„ÄÇ
            Class<?> targetType = determineTargetType(beanName, mbd);
            
            if (targetType != null) {
                // Â¶ÇÊûúÁ°ÆÂÆö‰∫ÜÁõÆÊ†áÁ±ªÂûãÔºåÈ¶ñÂÖàÂ∫îÁî®BeanPostProcessorsÁöÑÂâçÁΩÆÂ§ÑÁêÜ„ÄÇËøôÂèØËÉΩ‰ºöËøîÂõû‰∏Ä‰∏™beanÂÆû‰æãÔºå
                // ËøôÊ†∑Êàë‰ª¨Â∞±ÂèØ‰ª•ÈÅøÂÖçÊ†áÂáÜÁöÑÂÆû‰æãÂåñËøáÁ®ã„ÄÇ
                bean = applyBeanPostProcessorsBeforeInstantiation(targetType, beanName);
                
                // Â¶ÇÊûúbeanÂÆû‰æãÂú®‰∏äËø∞Ê≠•È™§‰∏≠Ë¢´ÂàõÂª∫ÔºåÂàôËøòÈúÄË¶ÅËøõË°åÂàùÂßãÂåñÂêéÁöÑBeanPostProcessorsÂ§ÑÁêÜ„ÄÇ
                if (bean != null) {
                    bean = applyBeanPostProcessorsAfterInitialization(bean, beanName);
                }
            }
        }
        
        // Êõ¥Êñ∞'mbd.beforeInstantiationResolved'ÁöÑÂÄºÔºåÂ¶ÇÊûúbeanÂú®‰∏äËø∞Ê≠•È™§‰∏≠Ë¢´ÂàõÂª∫ÔºåÂàô‰∏∫trueÔºåÂê¶Âàô‰∏∫false„ÄÇ
        mbd.beforeInstantiationResolved = (bean != null);
    }
    
    // ËøîÂõûÂèØËÉΩÂ∑≤ÁªèÂú®‰∏äËø∞ËøáÁ®ã‰∏≠ÂàõÂª∫ÁöÑbeanÂÆû‰æãÔºåÊàñËÄÖÂ¶ÇÊûúÊ≤°ÊúâÂàõÂª∫beanÔºåÂàôËøîÂõûnull„ÄÇ
    return bean;
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#createBean(beanName, mbd, args)`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§2„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#doCreateBean`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÂ§ÑÁêÜ‰∫ÜbeanÁîüÂëΩÂë®Êúü‰∏≠ÁöÑÂ§ö‰∏™ÂÖ≥ÈîÆÈò∂ÊÆµÔºå‰ªébeanÁöÑÂÆû‰æãÂåñ„ÄÅÂ±ûÊÄßÊ≥®ÂÖ•„ÄÅÂàùÂßãÂåñÔºåÂà∞beanÁöÑÊ∏ÖÁêÜÊ≥®ÂÜå„ÄÇ

```java
protected Object doCreateBean(String beanName, RootBeanDefinition mbd, @Nullable Object[] args)
        throws BeanCreationException {

    BeanWrapper instanceWrapper = null;
    
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    
    // Ê≠•È™§1: Â∞ùËØïÂÆû‰æãÂåñbean
    if (instanceWrapper == null) {
        instanceWrapper = createBeanInstance(beanName, mbd, args);
    }
    
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // Ê≠•È™§2: ÂêàÂπ∂beanÂÆö‰πâÁöÑÂêéÁΩÆÂ§ÑÁêÜ
    synchronized (mbd.postProcessingLock) {
        if (!mbd.postProcessed) {
            try {
                applyMergedBeanDefinitionPostProcessors(mbd, beanType, beanName);
            } catch (Throwable ex) {
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            }
            mbd.postProcessed = true;
        }
    }

    // Ê≠•È™§3: Â§ÑÁêÜÂèØËÉΩÁöÑÂæ™ÁéØÂºïÁî®ÔºåÈÄöËøáÊèêÂâçÊö¥Èú≤beanÁöÑÂºïÁî®
    boolean earlySingletonExposure = (mbd.isSingleton() && this.allowCircularReferences &&
            isSingletonCurrentlyInCreation(beanName));
    if (earlySingletonExposure) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
        // Ê≠•È™§3.1: Ê≥®ÂÜå‰∏Ä‰∏™`ObjectFactory`
        addSingletonFactory(beanName, () -> getEarlyBeanReference(beanName, mbd, bean));
    }

    // Ê≠•È™§4: ÂàùÂßãÂåñbeanÂÆû‰æãÔºåÂ°´ÂÖÖbeanÂ±ûÊÄßÂπ∂Â∫îÁî®ÂêéÂ§ÑÁêÜÂô®
    Object exposedObject = bean;
    try {
        // Ê≠•È™§4.1: Â±ûÊÄßÂ°´ÂÖÖ
        populateBean(beanName, mbd, instanceWrapper);
        // Ê≠•È™§4.2: ÂàùÂßãÂåñbean
        exposedObject = initializeBean(beanName, exposedObject, mbd);  
    } catch (Throwable ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }

    // Step 5: Â¶ÇÊûúÈúÄË¶ÅÔºåÊ≥®ÂÜåbean‰ª•‰æøÂú®ÂÆπÂô®ÂÖ≥Èó≠Êó∂ËøõË°åÊ∏ÖÁêÜ
    try {
        registerDisposableBeanIfNecessary(beanName, bean, mbd);
    } catch (BeanDefinitionValidationException ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }

    return exposedObject;
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#doCreateBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§1„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#createBeanInstance`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÂ∞ùËØï‰ªéÂêéÂ§ÑÁêÜÂô®Ëé∑ÂèñÊûÑÈÄ†ÂáΩÊï∞ÔºåÁÑ∂ÂêéÊ£ÄÊü•ÊòØÂê¶ÊúâÈ¶ñÈÄâÊûÑÈÄ†ÂáΩÊï∞ÔºåÊúÄÂêéÂ¶ÇÊûúÊ≤°ÊúâÂÖ∂‰ªñÈÄâÈ°πÔºåÂÆÉ‰ºö‰ΩøÁî®Êó†ÂèÇÊï∞ÊûÑÈÄ†ÂáΩÊï∞„ÄÇ

```java
protected BeanWrapper createBeanInstance(String beanName, RootBeanDefinition mbd, @Nullable Object[] args) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // Ê≠•È™§1: È¶ñÂÖàÂ∞ùËØï‰ªéBeanPostProcessorsÁ°ÆÂÆöÊûÑÈÄ†ÂáΩÊï∞ÔºåËøô‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÂ§ÑÁêÜ‰æãÂ¶Ç@AutowiredÊ≥®Ëß£ÁöÑÊÉÖÂÜµ
    Constructor<?>[] ctors = determineConstructorsFromBeanPostProcessors(beanClass, beanName);
    // Â¶ÇÊûúÁ°ÆÂÆö‰∫ÜÊûÑÈÄ†ÂáΩÊï∞ÊàñËÄÖbeanÂÆö‰πâ‰∏≠ÊúâÁõ∏ÂÖ≥ÁöÑËá™Âä®Ë£ÖÈÖçÊ®°ÂºèÂíåÊûÑÈÄ†ÂáΩÊï∞ÂèÇÊï∞ÔºåÂàô‰ΩøÁî®Ëá™Âä®Ë£ÖÈÖçÊûÑÈÄ†ÂáΩÊï∞ÂàõÂª∫beanÂÆû‰æã
    if (ctors != null || mbd.getResolvedAutowireMode() == AUTOWIRE_CONSTRUCTOR ||
        mbd.hasConstructorArgumentValues() || !ObjectUtils.isEmpty(args)) {
        return autowireConstructor(beanName, mbd, ctors, args);
    }

    // Ê≠•È™§2: Â¶ÇÊûúBeanDefinition‰∏≠Â≠òÂú®È¶ñÈÄâÊûÑÈÄ†ÂáΩÊï∞Ôºå‰ΩøÁî®Ëøô‰∫õÊûÑÈÄ†ÂáΩÊï∞
    ctors = mbd.getPreferredConstructors();
    if (ctors != null) {
        return autowireConstructor(beanName, mbd, ctors, null);
    }

    // Ê≠•È™§3: Â¶ÇÊûúÂâçÈù¢ÁöÑÊ≠•È™§ÈÉΩÊ≤°ÊúâËøîÂõûbeanÂÆû‰æãÔºåÈÇ£‰πà‰ΩøÁî®Êó†ÂèÇÊï∞ÊûÑÈÄ†ÂáΩÊï∞ÂÆû‰æãÂåñbean
    return instantiateBean(beanName, mbd);
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#createBeanInstance`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§1„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#determineConstructorsFromBeanPostProcessors`ÊñπÊ≥ï‰∏≠Ôºå`SmartInstantiationAwareBeanPostProcessor`Êèê‰æõ‰∫ÜÊô∫ËÉΩÁöÑbeanÂÆû‰æãÂåñÁ≠ñÁï•ÔºåÂ∞§ÂÖ∂ÊòØÈÄöËøá`determineConstructorsFromBeanPostProcessors`ÊñπÊ≥ïË∞ÉÊï¥ÊûÑÈÄ†ÂáΩÊï∞ÈÄâÊã©„ÄÇ‰∏∫‰∫ÜÊ∑±ÂÖ•ÁêÜËß£ÂÖ∂‰ΩúÁî®ÔºåÂª∫ËÆÆÈòÖËØªÔºö[**Ë∞ÉÊï¥BeanÂÆû‰æãÂåñÁ≠ñÁï•SmartInstantiationAwareBeanPostProcessor**](https://github.com/xuchengsheng/spring-reading/blob/master/spring-interface/spring-interface-smartInstantiationAwareBeanPostProcessor)„ÄÇËøôÁØáÊñáÁ´†Ê∑±ÂÖ•ÂàÜÊûê‰∫ÜÂÖ∂Âú®SpringÁöÑÊ†∏ÂøÉ‰ΩúÁî®„ÄÇ

```java
@Nullable
protected Constructor<?>[] determineConstructorsFromBeanPostProcessors(@Nullable Class<?> beanClass, String beanName)
    throws BeansException {

    // Ê£ÄÊü•Êèê‰æõÁöÑbeanClassÊòØÂê¶‰∏ç‰∏∫nullÔºå‰ª•ÂèäÊòØÂê¶Â≠òÂú®‰ªª‰ΩïInstantiationAwareBeanPostProcessor
    if (beanClass != null && hasInstantiationAwareBeanPostProcessors()) {

        // ÈÅçÂéÜÊâÄÊúâÁöÑSmartInstantiationAwareBeanPostProcessor
        for (SmartInstantiationAwareBeanPostProcessor bp : getBeanPostProcessorCache().smartInstantiationAware) {
            
            // ‰ΩøÁî®ÂΩìÂâçÁöÑBeanPostProcessorËé∑ÂèñÂÄôÈÄâÁöÑÊûÑÈÄ†ÂáΩÊï∞
            Constructor<?>[] ctors = bp.determineCandidateConstructors(beanClass, beanName);
            
            // Â¶ÇÊûúÊâæÂà∞‰∫ÜÂêàÈÄÇÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÁõ¥Êé•ËøîÂõûÂÆÉ‰ª¨
            if (ctors != null) {
                return ctors;
            }
        }
    }
    
    // Â¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ÂêàÈÄÇÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÊàñbeanClass‰∏∫nullÔºåÊàñÊ≤°ÊúâÁõ∏Â∫îÁöÑBeanPostProcessorÔºåËøîÂõûnull
    return null;
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#createBeanInstance`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§3„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#instantiateBean`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁî®‰∫éÊ†πÊçÆÊèê‰æõÁöÑbeanÂÆö‰πâÊù•ÂÆû‰æãÂåñ‰∏Ä‰∏™Êñ∞ÁöÑbeanÔºåÂπ∂ËøîÂõû‰∏Ä‰∏™ÂåÖË£Ö‰∫ÜËØ•beanÂÆû‰æãÁöÑ`BeanWrapper`„ÄÇËøôÂÖÅËÆ∏ÂØπbeanÂÆû‰æãËøõË°åËøõ‰∏ÄÊ≠•ÁöÑÊìç‰ΩúÔºå‰æãÂ¶ÇÂ±ûÊÄßÊ≥®ÂÖ•„ÄÇ

```java
protected BeanWrapper instantiateBean(String beanName, RootBeanDefinition mbd) {
    try {
        Object beanInstance;

        if (System.getSecurityManager() != null) {
            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
        }
        else {
            // Â¶ÇÊûú‰∏çÂ≠òÂú®Ôºå‰ΩøÁî®ÂÆû‰æãÂåñÁ≠ñÁï•Êù•ÂàõÂª∫beanÂÆû‰æã
            beanInstance = getInstantiationStrategy().instantiate(mbd, beanName, this);
        }

        // ‰ΩøÁî®ÂàõÂª∫ÁöÑbeanÂÆû‰æãÂàùÂßãÂåñBeanWrapper
        BeanWrapper bw = new BeanWrapperImpl(beanInstance);
        // ÂàùÂßãÂåñBeanWrapperÔºåÂèØ‰ª•ËÆæÁΩÆ‰∏Ä‰∫õËá™ÂÆö‰πâÁöÑÂ±ûÊÄßÁºñËæëÂô®Á≠â
        initBeanWrapper(bw);

        // ËøîÂõûÂåÖË£Ö‰∫ÜbeanÂÆû‰æãÁöÑBeanWrapper
        return bw;
    }
    catch (Throwable ex) {
        // Â§ÑÁêÜÂàõÂª∫beanÂÆû‰æãËøáÁ®ã‰∏≠ÂèØËÉΩÂèëÁîüÁöÑÂºÇÂ∏∏
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#doCreateBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§2„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#applyMergedBeanDefinitionPostProcessors`ÊñπÊ≥ï‰∏≠ÔºåÂú®SpringÊ°ÜÊû∂‰∏≠Ôºå`MergedBeanDefinitionPostProcessor`ÊòØ‰∏Ä‰∏™ÂÖ≥ÈîÆÊé•Âè£ÔºåË¥üË¥£Âú®beanÂÆû‰æãÂåñÂâçÂØπÂÖ∂ÂÆö‰πâËøõË°åË∞ÉÊï¥ÂíåÂêàÂπ∂„ÄÇ‰∏∫‰∫ÜÊ∑±ÂÖ•‰∫ÜËß£Ëøô‰∏ÄÊú∫Âà∂ÂíåÂÖ∂Âú®Spring‰∏≠ÁöÑÈáçË¶ÅÊÄßÔºåÂª∫ËÆÆÊü•ÁúãÔºö[**BeanÂÆö‰πâÁöÑÂä®ÊÄÅÂ§ÑÁêÜMergedBeanDefinitionPostProcessor**](https://github.com/xuchengsheng/spring-reading/blob/master/spring-interface/spring-interface-mergedBeanDefinitionPostProcessor)„ÄÇËøôÁØáÊñáÁ´†ËØ¶ÁªÜÂú∞Êé¢ËÆ®‰∫ÜËØ•Êé•Âè£ÁöÑÊ∫êÁ†ÅÂíåÊ†∏ÂøÉÂäüËÉΩ„ÄÇ

```java
protected void applyMergedBeanDefinitionPostProcessors(RootBeanDefinition mbd, Class<?> beanType, String beanName) {
    // ÈÅçÂéÜÂ∑≤ÁºìÂ≠òÁöÑÊâÄÊúâMergedBeanDefinitionPostProcessorÁ±ªÂûãÁöÑÂêéÂ§ÑÁêÜÂô®
    for (MergedBeanDefinitionPostProcessor processor : getBeanPostProcessorCache().mergedDefinition) {
        // Ë∞ÉÁî®ÊØè‰∏™ÂêéÂ§ÑÁêÜÂô®ÁöÑpostProcessMergedBeanDefinitionÊñπÊ≥ïÔºåÂØπÂêàÂπ∂ÂêéÁöÑbeanÂÆö‰πâËøõË°åÂ§ÑÁêÜ
        processor.postProcessMergedBeanDefinition(mbd, beanType, beanName);
    }
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#doCreateBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§3.1„ÄÇ

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#addSingletonFactory`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁõÆÁöÑÊòØ‰∏∫‰∏Ä‰∏™beanÂêçÁß∞Ê≥®ÂÜå‰∏Ä‰∏™`ObjectFactory`ÔºåËøôÂèØ‰ª•Áî®‰∫éÂú®beanÁúüÊ≠£Ë¢´ÂàõÂª∫‰πãÂâçËß£ÂÜ≥Âæ™ÁéØÂºïÁî®ÈóÆÈ¢ò„ÄÇÂΩìÂÖ∂‰ªñbeanÂ∞ùËØïÊó©ÊúüÂºïÁî®Ëøô‰∏™beanÊó∂ÔºåÂÆÉÂèØ‰ª•‰ΩøÁî®Ëøô‰∏™`ObjectFactory`Êù•Ëé∑Âèñ‰∏Ä‰∏™beanÁöÑÊó©ÊúüÂºïÁî®„ÄÇ

```java
protected void addSingletonFactory(String beanName, ObjectFactory<?> singletonFactory) {
    // Á°Æ‰øù‰º†ÂÖ•ÁöÑsingletonFactory‰∏ç‰∏∫null
    Assert.notNull(singletonFactory, "Singleton factory must not be null");
    synchronized (this.singletonObjects) {
        // Â¶ÇÊûúÊåáÂÆöÂêçÁß∞ÁöÑbeanÂ∞öÊú™Âú®singletonObjectsÁºìÂ≠ò‰∏≠
        if (!this.singletonObjects.containsKey(beanName)) {
            // Â∞Ü‰º†ÂÖ•ÁöÑsingletonFactoryÊ∑ªÂä†Âà∞singletonFactoriesÁºìÂ≠ò‰∏≠
            this.singletonFactories.put(beanName, singletonFactory);
            // ‰ªéearlySingletonObjectsÁºìÂ≠ò‰∏≠ÁßªÈô§ÊåáÂÆöbeanÂêçÁß∞ÔºåÂõ†‰∏∫ÂÆÉÁé∞Âú®Â∑≤Êúâ‰∏Ä‰∏™ÂÆåÊï¥ÁöÑObjectFactory
            this.earlySingletonObjects.remove(beanName);
            // Â∞ÜbeanÂêçÁß∞Ê∑ªÂä†Âà∞registeredSingletonsÈõÜÂêà‰∏≠ÔºåÊ†áËÆ∞ÂÆÉÂ∑≤Ë¢´Ê≥®ÂÜå
            this.registeredSingletons.add(beanName);
        }
    }
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#doCreateBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§4.1„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#populateBean`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁî®‰∫éÂ°´ÂÖÖbeanÁöÑÂ±ûÊÄß„ÄÇÂÆÉ‰ºöÈÅçÂéÜÊâÄÊúâÁöÑ`InstantiationAwareBeanPostProcessors`ÔºåÂπ∂Ë∞ÉÁî®ÂÆÉ‰ª¨ÁöÑ`postProcessAfterInstantiation`Âíå`postProcessProperties`ÊñπÊ≥ïÊù•ÂêéÂ§ÑÁêÜbeanÁöÑÂ±ûÊÄß„ÄÇÂ¶ÇÊûú`InstantiationAwareBeanPostProcessor`ËøîÂõû`false`Êàñ`null`Â±ûÊÄßÂÄºÔºåÂàôÊèêÂâçÁªìÊùübeanÂ±ûÊÄßÁöÑËÆæÁΩÆ„ÄÇ

```java
protected void populateBean(String beanName, RootBeanDefinition mbd, @Nullable BeanWrapper bw) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // Â¶ÇÊûúÂΩìÂâçÁöÑbean‰∏çÊòØÂêàÊàêÁöÑÔºåÂπ∂‰∏îÂ≠òÂú®InstantiationAwareBeanPostProcessors
    if (!mbd.isSynthetic() && hasInstantiationAwareBeanPostProcessors()) {
        // ÈÅçÂéÜÊâÄÊúâÁöÑInstantiationAwareBeanPostProcessors
        for (InstantiationAwareBeanPostProcessor bp : getBeanPostProcessorCache().instantiationAware) {
            // Ë∞ÉÁî®postProcessAfterInstantiationÊñπÊ≥ï
            if (!bp.postProcessAfterInstantiation(bw.getWrappedInstance(), beanName)) {
                // Â¶ÇÊûúËøîÂõûfalseÔºåÂàôÊèêÂâçÁªìÊùübeanÂ±ûÊÄßÁöÑËÆæÁΩÆ
                return;
            }
        }
    }

    // Ëé∑ÂèñbeanÂÆö‰πâ‰∏≠ÁöÑÂ±ûÊÄßÂÄº
    PropertyValues pvs = (mbd.hasPropertyValues() ? mbd.getPropertyValues() : null);

    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // Ê£ÄÊü•ÊòØÂê¶ÊúâInstantiationAwareBeanPostProcessors
    boolean hasInstAwareBpps = hasInstantiationAwareBeanPostProcessors();
    // Á°ÆÂÆöÊòØÂê¶ÈúÄË¶ÅËøõË°å‰æùËµñÊÄßÊ£ÄÊü•
    boolean needsDepCheck = (mbd.getDependencyCheck() != AbstractBeanDefinition.DEPENDENCY_CHECK_NONE);

    PropertyDescriptor[] filteredPds = null;
    if (hasInstAwareBpps) {
        // Â¶ÇÊûúÊ≤°ÊúâÂ±ûÊÄßÂÄºÔºåÂàô‰ªébeanÂÆö‰πâ‰∏≠Ëé∑Âèñ
        if (pvs == null) {
            pvs = mbd.getPropertyValues();
        }
        // ÈÅçÂéÜÊâÄÊúâÁöÑInstantiationAwareBeanPostProcessors
        for (InstantiationAwareBeanPostProcessor bp : getBeanPostProcessorCache().instantiationAware) {
            // Ë∞ÉÁî®postProcessPropertiesÊñπÊ≥ïÂ§ÑÁêÜÂ±ûÊÄßÂÄº
            PropertyValues pvsToUse = bp.postProcessProperties(pvs, bw.getWrappedInstance(), beanName);
            if (pvsToUse == null) {
                if (filteredPds == null) {
                    filteredPds = filterPropertyDescriptorsForDependencyCheck(bw, mbd.allowCaching);
                }
                pvsToUse = bp.postProcessPropertyValues(pvs, filteredPds, bw.getWrappedInstance(), beanName);
                if (pvsToUse == null) {
                    return;
                }
            }
            pvs = pvsToUse;
        }
    }
    // Â¶ÇÊûúÈúÄË¶ÅËøõË°å‰æùËµñÊÄßÊ£ÄÊü•
    if (needsDepCheck) {
        if (filteredPds == null) {
            filteredPds = filterPropertyDescriptorsForDependencyCheck(bw, mbd.allowCaching);
        }
        checkDependencies(beanName, mbd, filteredPds, pvs);
    }

    // ÊúÄÂêéÔºåÂ∞ÜÂ§ÑÁêÜÂêéÁöÑÂ±ûÊÄßÂÄºÂ∫îÁî®Âà∞beanÂÆû‰æã‰∏ä
    if (pvs != null) {
        applyPropertyValues(beanName, mbd, bw, pvs);
    }
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#doCreateBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§4.2„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#initializeBean(beanName, bean,mbd)`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅË¥üË¥£beanÁöÑÂàùÂßãÂåñËøáÁ®ãÔºåÂåÖÊã¨Ë∞ÉÁî®AwareÊé•Âè£ÊñπÊ≥ï„ÄÅÊâßË°å`BeanPostProcessors`ÁöÑÂàùÂßãÂåñÂâçÂêéÊñπÊ≥ï‰ª•ÂèäbeanÁöÑËá™ÂÆö‰πâÂàùÂßãÂåñÊñπÊ≥ï„ÄÇ

```java
protected Object initializeBean(String beanName, Object bean, @Nullable RootBeanDefinition mbd) {
    // Â¶ÇÊûúÂ≠òÂú®SecurityManagerÔºåÊâßË°åÁõ∏Â∫îÁöÑÂÆâÂÖ®‰ª£Á†ÅÔºàÁúÅÁï•ÈÉ®ÂàÜÔºâ
    if (System.getSecurityManager() != null) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }
    else {
        // Â¶ÇÊûúbeanÂÆûÁé∞‰∫ÜÁâπÂÆöÁöÑAwareÊé•Âè£ÔºàÂ¶ÇBeanNameAware, BeanFactoryAwareÁ≠âÔºâÔºåÂàôË∞ÉÁî®Áõ∏Â∫îÁöÑÊñπÊ≥ï
        invokeAwareMethods(beanName, bean);
    }

    // ÂàùÂßãÂåñÂâçÁöÑÈ¢ÑÂ§ÑÁêÜ
    // Â¶ÇÊûúbean‰∏çÊòØÂêàÊàêÁöÑÔºåË∞ÉÁî®ÊâÄÊúâBeanPostProcessorsÁöÑpostProcessBeforeInitializationÊñπÊ≥ï
    Object wrappedBean = bean;
    if (mbd == null || !mbd.isSynthetic()) {
        wrappedBean = applyBeanPostProcessorsBeforeInitialization(wrappedBean, beanName);
    }

    try {
        // Ë∞ÉÁî®beanÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºå‰æãÂ¶ÇafterPropertiesSetÂíåcustom init-method
        invokeInitMethods(beanName, wrappedBean, mbd);
    }
    catch (Throwable ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }

    // ÂàùÂßãÂåñÂêéÁöÑÂêéÂ§ÑÁêÜ
    // Â¶ÇÊûúbean‰∏çÊòØÂêàÊàêÁöÑÔºåË∞ÉÁî®ÊâÄÊúâBeanPostProcessorsÁöÑpostProcessAfterInitializationÊñπÊ≥ï
    if (mbd == null || !mbd.isSynthetic()) {
        wrappedBean = applyBeanPostProcessorsAfterInitialization(wrappedBean, beanName);
    }

    // ËøîÂõûÊúÄÁªàÁöÑbeanÂÆû‰æãÔºåÂèØËÉΩË¢´AOP‰ª£ÁêÜÁ≠âÂåÖË£Ö
    return wrappedBean;
}
```

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#invokeAwareMethods`ÊñπÊ≥ï‰∏≠ÔºåÂú®SpringÊ°ÜÊû∂‰∏≠Ôºå`Aware`Êé•Âè£Ëµã‰∫àbeans‰∏éÂÆπÂô®‰∫§‰∫íÁöÑËÉΩÂäõÔºåÂ¶ÇËé∑ÂèñÂÖ∂ÂêçÂ≠ó„ÄÅÁ±ªÂä†ËΩΩÂô®Êàñ‰∏ébeanÂ∑•ÂéÇÁöÑ‰∫§‰∫í„ÄÇ‰∏∫Êõ¥Ê∑±ÂÖ•Âú∞Êé¢Á©∂Ëøô‰∫õÊé•Âè£ÔºåÊàëÊé®ËçêÊàë‰ª¨Êü•Áúã‰ª•‰∏ãÊñáÁ´†ÔºåÂÆÉ‰ª¨ËØ¶ÁªÜÂàÜÊûê‰∫ÜËøô‰∫õ`Aware`Êé•Âè£Âú®Spring‰∏≠ÁöÑÂÆûÁé∞Ôºö

- [**Ëé∑ÂèñBeanÂêçÁß∞BeanNameAware**](https://github.com/xuchengsheng/spring-reading/blob/master/spring-aware/spring-aware-beanNameAware) - Ëøô‰∏™Êé•Âè£‰ΩøbeanËÉΩÂ§üËé∑ÂèñÂÖ∂Âú®SpringÂÆπÂô®‰∏≠ÁöÑÂêçÂ≠ó„ÄÇ
- [**Ëé∑ÂèñÁ±ªÂä†ËΩΩÂô®BeanClassLoaderAware**](https://github.com/xuchengsheng/spring-reading/blob/master/spring-aware/spring-aware-beanClassLoaderAware) - ÈÄöËøáËøô‰∏™Êé•Âè£ÔºåbeanÂèØ‰ª•Ëé∑Âæó‰∏éÂÖ∂Áõ∏ÂÖ≥ÁöÑÁ±ªÂä†ËΩΩÂô®ÁöÑÂºïÁî®„ÄÇ
- [**‰∏éBeanÂ∑•ÂéÇ‰∫íÂä®BeanFactoryAware**](https://github.com/xuchengsheng/spring-reading/blob/master/spring-aware/spring-aware-beanFactoryAware) - Ëøô‰∏™Êé•Âè£ËÆ©beanÂèØ‰ª•‰∏éÂÖ∂ÊâÄÂú®ÁöÑbeanÂ∑•ÂéÇÊàñÂ∫îÁî®‰∏ä‰∏ãÊñá‰∫íÂä®„ÄÇ

```java
private void invokeAwareMethods(String beanName, Object bean) {
    // Ê£ÄÊü•beanÊòØÂê¶ÂÆûÁé∞‰∫ÜAwareÊé•Âè£
    if (bean instanceof Aware) {
        // Â¶ÇÊûúbeanÂÆûÁé∞‰∫ÜBeanNameAwareÊé•Âè£ÔºåËÆæÁΩÆbeanÁöÑÂêçÂ≠ó
        if (bean instanceof BeanNameAware) {
            ((BeanNameAware) bean).setBeanName(beanName);
        }
        // Â¶ÇÊûúbeanÂÆûÁé∞‰∫ÜBeanClassLoaderAwareÊé•Âè£ÔºåËÆæÁΩÆbeanÁöÑÁ±ªÂä†ËΩΩÂô®
        if (bean instanceof BeanClassLoaderAware) {
            ClassLoader bcl = getBeanClassLoader();
            if (bcl != null) {
                ((BeanClassLoaderAware) bean).setBeanClassLoader(bcl);
            }
        }
        // Â¶ÇÊûúbeanÂÆûÁé∞‰∫ÜBeanFactoryAwareÊé•Âè£ÔºåËÆæÁΩÆbeanÁöÑÂ∑•ÂéÇ
        if (bean instanceof BeanFactoryAware) {
            ((BeanFactoryAware) bean).setBeanFactory(AbstractAutowireCapableBeanFactory.this);
        }
    }
}
```

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#applyBeanPostProcessorsBeforeInitialization`ÊñπÊ≥ï‰∏≠ÔºåÂú®Spring‰∏≠Ôºå`BeanPostProcessor`Êé•Âè£Êèê‰æõ‰∫ÜÂú®beanÂàùÂßãÂåñËøáÁ®ã‰∏≠ËøõË°åÊã¶Êà™ÁöÑËÉΩÂäõ„ÄÇË¶ÅÊ∑±ÂÖ•‰∫ÜËß£ÂÖ∂Â∑•‰ΩúÂéüÁêÜÔºåÂª∫ËÆÆÈòÖËØªÔºö[**Ë∞ÉÊï¥BeanÂ±ûÊÄßBeanPostProcessor**](https://github.com/xuchengsheng/spring-reading/blob/master/spring-interface/spring-interface-beanPostProcessor)„ÄÇËøôÁØáÊñáÁ´†ËØ¶ÁªÜËß£Êûê‰∫ÜÂÖ∂Âú®Spring‰∏≠ÁöÑÂÖ≥ÈîÆ‰ΩúÁî®„ÄÇ

```java
@Override
public Object applyBeanPostProcessorsBeforeInitialization(Object existingBean, String beanName)
    throws BeansException {
	// ËÆæÁΩÆÂΩìÂâçbean‰∏∫‰º†ÂÖ•ÁöÑbean
    Object result = existingBean;  

    // ÈÅçÂéÜÂÆπÂô®‰∏≠ÊâÄÊúâÁöÑBeanPostProcessors
    for (BeanPostProcessor processor : getBeanPostProcessors()) {
        // Ë∞ÉÁî®ÊØè‰∏™BeanPostProcessorÁöÑpostProcessBeforeInitializationÊñπÊ≥ï
        Object current = processor.postProcessBeforeInitialization(result, beanName);

        // Â¶ÇÊûúpostProcessBeforeInitializationËøîÂõûnullÔºåÂàôÁõ¥Êé•ËøîÂõûÂéübean
        if (current == null) {
            return result;
        }
        
        result = current;  // Êõ¥Êñ∞result‰∏∫postProcessBeforeInitializationÂ§ÑÁêÜÂêéÁöÑbean
    }

    // ËøîÂõûÊâÄÊúâBeanPostProcessorsÂ§ÑÁêÜÂêéÁöÑbean
    return result;
}
```

> `org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#doCreateBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§5„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#registerDisposableBeanIfNecessary`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁõÆÁöÑÊòØ‰∏∫Âú®SpringÂÆπÂô®‰∏≠ÁÆ°ÁêÜÁöÑbeanÊ≥®ÂÜå‰∏Ä‰∏™ÈîÄÊØÅÂõûË∞É„ÄÇÂΩìÂÆπÂô®ÂÖ≥Èó≠Âπ∂‰∏îbeanÈúÄË¶ÅÊ∏ÖÁêÜËµÑÊ∫êÊàñÊâßË°åÂÖ∂‰ªñÈîÄÊØÅÈÄªËæëÊó∂ÔºåËøô‰∏™ÈîÄÊØÅÂõûË∞É‰ºöË¢´Ë∞ÉÁî®„ÄÇ

```java
protected void registerDisposableBeanIfNecessary(String beanName, Object bean, RootBeanDefinition mbd) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    registerDisposableBean(beanName, new DisposableBeanAdapter(
                bean, beanName, mbd, getBeanPostProcessorCache().destructionAware, acc));
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#registerDisposableBean`ÊñπÊ≥ï‰∏≠ÔºåÂ∞ÜÁªôÂÆöÁöÑbeanÂêçÂ≠óÂíåÂØπÂ∫îÁöÑ`DisposableBean`ÂÆû‰æãÊîæÂÖ•`disposableBeans`Êò†Â∞Ñ‰∏≠„ÄÇËøô‰∏™Êò†Â∞Ñ‰ºöÂú®ÂÆπÂô®ÂÖ≥Èó≠Êó∂Ë¢´ÈÅçÂéÜÔºåÊâÄÊúâÁöÑ`DisposableBean`ÂÆû‰æãÁöÑ`destroy`ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®Ôºå‰ª•Á°Æ‰øùËµÑÊ∫êÂæóÂà∞ÈÄÇÂΩìÁöÑÈáäÊîæÂíåbeanÂæóÂà∞ÈÄÇÂΩìÁöÑÈîÄÊØÅ„ÄÇ

```java
public void registerDisposableBean(String beanName, DisposableBean bean) {
    synchronized (this.disposableBeans) {
        this.disposableBeans.put(beanName, bean);
    }
}
```

> `org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#getSingleton(beanName,singletonFactory)`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§3„ÄÇ

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#afterSingletonCreation`ÊñπÊ≥ï‰∏≠ÔºåÊ≠§ÊñπÊ≥ïÁ°Æ‰øùbeanÁöÑÂàõÂª∫ËøáÁ®ãÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºåÂπ∂‰øùÊä§Á≥ªÁªüÂÖçÂèó‰∏çÊ≠£Á°ÆÁöÑÂπ∂ÂèëËÆøÈóÆÔºåÁâπÂà´ÊòØÂΩìÂ§ö‰∏™Á∫øÁ®ãËØïÂõæÂêåÊó∂ËÆøÈóÆÊàñ‰øÆÊîπÂêå‰∏Ä‰∏™beanÁöÑÁä∂ÊÄÅÊó∂„ÄÇ

```java
protected void afterSingletonCreation(String beanName) {
    // Ê£ÄÊü•ÁªôÂÆöÁöÑbeanÂêçÁß∞ÊòØÂê¶Âú®ÊéíÈô§ÂàóË°®‰∏≠ÔºåÂ¶ÇÊûú‰∏çÊòØÔºåÁªßÁª≠Ê£ÄÊü•ËØ•beanÊòØÂê¶Ê≠£Âú®ÂàõÂª∫
    if (!this.inCreationCheckExclusions.contains(beanName) 
        // Â∞ùËØï‰ªéË°®Á§∫‚ÄúÂΩìÂâçÊ≠£Âú®ÂàõÂª∫ÁöÑÂçï‰æãbean‚ÄùÈõÜÂêà‰∏≠ÁßªÈô§ÁªôÂÆöÁöÑbeanÂêçÁß∞
        && !this.singletonsCurrentlyInCreation.remove(beanName)) {
        // Â¶ÇÊûúÁªôÂÆöÁöÑbeanÂêçÁß∞Êó†Ê≥ï‰ªéÈõÜÂêà‰∏≠ÁßªÈô§ÔºåËØ¥ÊòéÂú®Ê≠§Êó∂ËØ•bean‰∏çÂ∫îËØ•Âú®ÂàõÂª∫‰∏≠„ÄÇ
        // ËøôÂèØËÉΩË°®Á§∫beanÁöÑÂàõÂª∫ÊúâÈóÆÈ¢òÊàñË¢´ÈîôËØØÂú∞Ê†áËÆ∞‰∏∫‚ÄúÂΩìÂâçÊ≠£Âú®ÂàõÂª∫‚ÄùÔºåÂõ†Ê≠§ÊäõÂá∫ÂºÇÂ∏∏„ÄÇ
        throw new IllegalStateException("Singleton '" + beanName + "' isn't currently in creation");
    }
}
```

> `org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#getSingleton(beanName,singletonFactory)`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§4„ÄÇ

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#addSingleton`ÊñπÊ≥ï‰∏≠ÔºåÂ§ÑÁêÜ‰∫Ü‰∏éÂçï‰æãbeanÁîüÂëΩÂë®ÊúüÁõ∏ÂÖ≥ÁöÑÂêÑÁßçÁºìÂ≠òÂíåÈõÜÂêà„ÄÇ

```java
protected void addSingleton(String beanName, Object singletonObject) {
    // ‰ΩøÁî®`synchronized`ÂùóÁ°Æ‰øùÂ§öÁ∫øÁ®ãÁéØÂ¢É‰∏≠ÂØπÂçï‰æãÂØπË±°ÁöÑÁ∫øÁ®ãÂÆâÂÖ®Êìç‰Ωú
    synchronized (this.singletonObjects) {
        // Â∞ÜÊñ∞ÂàõÂª∫ÁöÑÂçï‰æãÂØπË±°Ê∑ªÂä†Âà∞`singletonObjects`ÁºìÂ≠ò‰∏≠
        this.singletonObjects.put(beanName, singletonObject);
        
        // ‰ªé`singletonFactories`‰∏≠ÁßªÈô§beanÂêçÁß∞ÔºåÂõ†‰∏∫Áé∞Âú®Êàë‰ª¨Â∑≤ÁªèÂÆåÊàê‰∫ÜËØ•beanÁöÑÂÆåÊï¥ÂÆû‰æãÂåñ
        this.singletonFactories.remove(beanName);
        
        // ‰ªé`earlySingletonObjects`‰∏≠ÁßªÈô§beanÂêçÁß∞ÔºåÂõ†‰∏∫ËØ•beanÁé∞Âú®Â∑≤ÁªèÂÆåÂÖ®ÂàùÂßãÂåñÂπ∂Â≠òÂÇ®Âú®`singletonObjects`‰∏≠
        this.earlySingletonObjects.remove(beanName);
        
        // Â∞ÜbeanÂêçÁß∞Ê∑ªÂä†Âà∞`registeredSingletons`ÈõÜÂêà‰∏≠Ôºå‰ª•Ë°®Á§∫ËØ•beanÂ∑≤ÁªèË¢´Ê≥®ÂÜå‰∏∫‰∏Ä‰∏™Âçï‰æã
        this.registeredSingletons.add(beanName);
    }
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§8.3„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#getObjectForBeanInstance`ÊñπÊ≥ï‰∏≠ÔºåÊ†πÊçÆÊèê‰æõÁöÑbeanÂÆû‰æãÂíåÂêçÁß∞ÔºåË¶Å‰πàËøîÂõûbeanÂÆû‰æãÊú¨Ë∫´ÔºåË¶Å‰πà‰ªé`FactoryBean`‰∏≠Ëé∑ÂèñÂØπË±°„ÄÇÂêåÊó∂ÔºåÂÆÉËøòÂ§ÑÁêÜ‰∫Ü‰∏éÂ∑•ÂéÇbeanÁºìÂ≠òÁõ∏ÂÖ≥ÁöÑÂêÑÁßçÁªÜËäÇ„ÄÇ

```java
protected Object getObjectForBeanInstance(
        Object beanInstance, String name, String beanName, @Nullable RootBeanDefinition mbd) {

    // Ê£ÄÊü•ÂêçÁß∞ÊòØÂê¶ÊúâÂ∑•ÂéÇÁöÑËß£ÂºïÁî®ÂâçÁºÄÔºà‰æãÂ¶Ç'&'ÔºâÂπ∂‰∏îbeanÂÆû‰æã‰∏çÊòØÂ∑•ÂéÇ
    if (BeanFactoryUtils.isFactoryDereference(name)) {
        // ÂΩìbeanÂÆû‰æãÊòØNullBeanÊó∂ÔºåÁõ¥Êé•ËøîÂõûbeanÂÆû‰æã
        if (beanInstance instanceof NullBean) {
            return beanInstance;
        }
        // Â¶ÇÊûúbeanÂÆû‰æã‰∏çÊòØ‰∏Ä‰∏™FactoryBeanÔºåÊäõÂá∫ÂºÇÂ∏∏
        if (!(beanInstance instanceof FactoryBean)) {
            throw new BeanIsNotAFactoryException(beanName, beanInstance.getClass());
        }
        // Â¶ÇÊûúbeanÂÆö‰πâ‰∏ç‰∏∫nullÔºåÊ†áËÆ∞ÂÆÉ‰∏∫‰∏Ä‰∏™FactoryBean
        if (mbd != null) {
            mbd.isFactoryBean = true;
        }
        return beanInstance;
    }

    // Â¶ÇÊûúbeanÂÆû‰æã‰∏çÊòØ‰∏Ä‰∏™FactoryBeanÔºåÂàôÁõ¥Êé•ËøîÂõûbeanÂÆû‰æã
    if (!(beanInstance instanceof FactoryBean)) {
        return beanInstance;
    }

    Object object = null;
    // Â¶ÇÊûúbeanÂÆö‰πâ‰∏ç‰∏∫nullÔºåÊ†áËÆ∞ÂÆÉ‰∏∫‰∏Ä‰∏™FactoryBean
    if (mbd != null) {
        mbd.isFactoryBean = true;
    }
    // Â¶ÇÊûúÊ≤°ÊúâÊèê‰æõbeanÂÆö‰πâÔºåÂàôÂ∞ùËØï‰ªéÁºìÂ≠ò‰∏≠Ëé∑ÂèñÂ∑•ÂéÇbeanÁîüÊàêÁöÑÂØπË±°
    else {
        object = getCachedObjectForFactoryBean(beanName);
    }
    // Â¶ÇÊûúÁºìÂ≠ò‰∏≠Ê≤°ÊúâÂØπË±°ÔºåÂàôÈúÄË¶Å‰ªéFactoryBean‰∏≠Ëé∑Âèñ
    if (object == null) {
        FactoryBean<?> factory = (FactoryBean<?>) beanInstance;
        // Â¶ÇÊûúÂ≠òÂú®beanÂÆö‰πâÂπ∂‰∏îÊ≤°Êúâ‰∏∫ÁªôÂÆöÁöÑbeanNameÁºìÂ≠òÂØπË±°ÔºåÂàôËé∑ÂèñÂêàÂπ∂ÁöÑbeanÂÆö‰πâ
        if (mbd == null && containsBeanDefinition(beanName)) {
            mbd = getMergedLocalBeanDefinition(beanName);
        }
        // Ê£ÄÊü•beanÂÆö‰πâÊòØÂê¶‰∏∫ÂêàÊàêÁöÑÔºà‰æãÂ¶ÇÔºåÁî±Âü∫Á°ÄËÆæÊñΩ‰ª£Á†ÅÂàõÂª∫ÁöÑÔºâ
        boolean synthetic = (mbd != null && mbd.isSynthetic());
        // ‰ªéFactoryBeanËé∑ÂèñÂØπË±°
        object = getObjectFromFactoryBean(factory, beanName, !synthetic);
    }
    return object;
}
```

> `org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§9„ÄÇ

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#adaptBeanInstance`ÊñπÊ≥ï‰∏≠ÔºåÁõÆÁöÑÊòØÁ°Æ‰øùÁªôÂÆöÁöÑbeanÂÆû‰æã‰∏éÊåáÂÆöÁöÑÁõÆÊ†áÁ±ªÂûãÂåπÈÖç„ÄÇÂ¶ÇÊûúÂÆÉ‰ª¨‰∏çÂåπÈÖçÔºåÊ≠§ÊñπÊ≥ïÂ∞ÜÂ∞ùËØï‰ΩøÁî®Á±ªÂûãËΩ¨Êç¢Âô®Â∞ÜbeanÂÆû‰æãËΩ¨Êç¢‰∏∫ÊâÄÈúÄÁöÑÁ±ªÂûã„ÄÇÂ¶ÇÊûúËΩ¨Êç¢Â§±Ë¥•ÔºåÂÆÉÂ∞ÜÊäõÂá∫‰∏Ä‰∏™ÂºÇÂ∏∏„ÄÇ

```java
<T> T adaptBeanInstance(String name, Object bean, @Nullable Class<?> requiredType) {
    // Ê£ÄÊü•ÊâÄÈúÄÁöÑÁ±ªÂûãÊòØÂê¶‰∏éÂÆûÈôÖbeanÂÆû‰æãÁöÑÁ±ªÂûãÂåπÈÖç
    if (requiredType != null && !requiredType.isInstance(bean)) {
        try {
            // Â¶ÇÊûú‰∏çÂåπÈÖçÔºåÂ∞ùËØïËΩ¨Êç¢beanÂÆû‰æã‰∏∫ÊâÄÈúÄÁöÑÁ±ªÂûã
            Object convertedBean = getTypeConverter().convertIfNecessary(bean, requiredType);
            // Â¶ÇÊûúËΩ¨Êç¢ÂêéÁöÑbean‰∏∫nullÔºåÊäõÂá∫ÂºÇÂ∏∏
            if (convertedBean == null) {
                throw new BeanNotOfRequiredTypeException(name, requiredType, bean.getClass());
            }
            return (T) convertedBean;
        }
        catch (TypeMismatchException ex) {
            // Â¶ÇÊûúÁ±ªÂûãËΩ¨Êç¢Â§±Ë¥•ÔºåËÆ∞ÂΩïtraceÊó•ÂøóÂπ∂ÊäõÂá∫ÂºÇÂ∏∏
            if (logger.isTraceEnabled()) {
                logger.trace("Failed to convert bean '" + name + "' to required type '" +
                             ClassUtils.getQualifiedName(requiredType) + "'", ex);
            }
            throw new BeanNotOfRequiredTypeException(name, requiredType, bean.getClass());
        }
    }
    // Â¶ÇÊûúbeanÂÆû‰æãÁöÑÁ±ªÂûã‰∏éÊâÄÈúÄÁöÑÁ±ªÂûãÂåπÈÖçÔºåÁõ¥Êé•ËøîÂõûbeanÂÆû‰æã
    return (T) bean;
}
```

### ‰∏É„ÄÅÊ≥®ÊÑè‰∫ãÈ°π

1. **BeanÁöÑÂ≠òÂú®ÊÄß**
   + Á°Æ‰øùbeanÁ°ÆÂÆûÂ∑≤ÁªèÂú®Spring‰∏ä‰∏ãÊñá‰∏≠ÂÆö‰πâ‰∫Ü„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÔºå`NoSuchBeanDefinitionException`Â∞ÜË¢´ÊäõÂá∫„ÄÇ
2. **Ê≠£Á°ÆÁöÑBeanÂêçÁß∞**
   + Á°Æ‰øùÊàë‰ª¨‰ΩøÁî®ÁöÑÂêçÁß∞ÊòØbeanÁöÑÊ≠£Á°ÆIDÊàñÂêçÁß∞„ÄÇSpringÁöÑbeanÂêçÁß∞ÈªòËÆ§ÊòØÈùûÈôêÂÆöÁ±ªÂêçÁöÑÈ¶ñÂ≠óÊØçÂ∞èÂÜôÔºå‰ΩÜÂ¶ÇÊûúÂú®beanÂÆö‰πâ‰∏≠ÊåáÂÆö‰∫Ü‰∏çÂêåÁöÑÂêçÁß∞ÔºåÊàë‰ª¨Â∫îËØ•‰ΩøÁî®ÈÇ£‰∏™„ÄÇ
3. **BeanÁöÑÁîüÂëΩÂë®Êúü**
   + `getBean()`ÊñπÊ≥ïÊØèÊ¨°ÈÉΩÂèØËÉΩËøîÂõû‰∏çÂêåÁöÑÂÆû‰æãÊàñÁõ∏ÂêåÁöÑÂÆû‰æãÔºåÂÖ∑‰ΩìÂèñÂÜ≥‰∫ébeanÁöÑËåÉÂõ¥Ôºàsingleton„ÄÅprototypeÁ≠âÔºâ„ÄÇ
4. **Á±ªÂûãÂÆâÂÖ®**
   + ‰ΩøÁî®`getBean(name, class)`ÂèØ‰ª•Á°Æ‰øùËøîÂõûÁöÑbeanÊòØÊúüÊúõÁöÑÁ±ªÂûãÔºå‰ªéËÄåÈÅøÂÖçÂú®ËøêË°åÊó∂Âá∫Áé∞Á±ªËΩ¨Êç¢ÂºÇÂ∏∏„ÄÇ
5. **Âæ™ÁéØ‰æùËµñ**
   + Â¶ÇÊûúÂú®beanÁöÑ‰æùËµñÂÖ≥Á≥ª‰∏≠Â≠òÂú®Âæ™ÁéØ‰æùËµñÔºå`getBean`ÂèØËÉΩ‰ºöÂ§±Ë¥•ÔºåÂπ∂ÊäõÂá∫`BeanCurrentlyInCreationException`„ÄÇ
6. **LazyÂàùÂßãÂåñ**
   + ÂØπ‰∫éÊáíÊÉ∞ÂàùÂßãÂåñÁöÑbeanÔºåÁ¨¨‰∏ÄÊ¨°Ë∞ÉÁî®`getBean()`‰ºöËß¶ÂèëbeanÁöÑÂàõÂª∫ÂíåÂàùÂßãÂåñ„ÄÇ
7. **ÂèØËÉΩÁöÑÂâØ‰ΩúÁî®**
   + Âõ†‰∏∫`getBean()`ÂèØ‰ª•Ëß¶ÂèëbeanÁöÑÂàõÂª∫ÂíåÂàùÂßãÂåñÔºåÊâÄ‰ª•ÂèØËÉΩ‰ºöÊúâÂâØ‰ΩúÁî®Ôºå‰æãÂ¶ÇÊï∞ÊçÆÂ∫ìËøûÊé•„ÄÅÊñá‰ª∂IOÊàñÂÖ∂‰ªñËµÑÊ∫êÁöÑÂàùÂßãÂåñ„ÄÇ
8. **‰∏çË¶ÅËøáÂ∫¶‰ΩøÁî®**
   + Âú®‰∏Ä‰∏™SpringÁÆ°ÁêÜÁöÑbean‰∏≠È¢ëÁπÅË∞ÉÁî®`getBean()`Âπ∂‰∏çÊòØ‰∏Ä‰∏™Â•ΩÁöÑÂÆûË∑µ„ÄÇËøôËøùËÉå‰∫ÜÊéßÂà∂ÂèçËΩ¨ÁöÑÂéüÂàôÔºåÂèØËÉΩÂØºËá¥‰ª£Á†ÅÈöæ‰ª•ÊµãËØïÂíåÁª¥Êä§„ÄÇÊàë‰ª¨Â∫îËØ•Â∞ΩÂèØËÉΩÂú∞‰æùËµñÊ≥®ÂÖ•ÔºåËÄå‰∏çÊòØÊòæÂºèÂú∞‰ªéÂÆπÂô®‰∏≠Ëé∑Âèñbean„ÄÇ
9. **Á∫øÁ®ãÂÆâÂÖ®ÊÄß**
   + ËôΩÁÑ∂`getBean()`ÊñπÊ≥ïÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºå‰ΩÜËøîÂõûÁöÑbeanÂèØËÉΩ‰∏çÊòØÔºåÈô§ÈùûÊàë‰ª¨Á°Æ‰øùÂÆÉÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑ„ÄÇ
10. **ÁîüÂëΩÂë®ÊúüÂõûË∞É**
    + ËØ∑ËÆ∞‰ΩèÔºåÂΩìÊàë‰ª¨ÈÄöËøá`getBean`ÊñπÊ≥ïÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑbeanÂÆû‰æãÊó∂Ôºà‰æãÂ¶ÇÔºåËåÉÂõ¥‰∏∫prototypeÁöÑbeanÔºâÔºåSpringÂ∞Ü‰∏ç‰ºöÁÆ°ÁêÜËØ•beanÁöÑÂÆåÊï¥ÁîüÂëΩÂë®Êúü„ÄÇÁâπÂà´ÊòØÔºåSpring‰∏ç‰ºöË∞ÉÁî®prototype beanÁöÑÈîÄÊØÅÊñπÊ≥ï„ÄÇ

### ÂÖ´„ÄÅÊÄªÁªì

#### ÊúÄ‰Ω≥ÂÆûË∑µÊÄªÁªì

1. **‰ΩøÁî®Ê≠£Á°ÆÁöÑ‰∏ä‰∏ãÊñáÁéØÂ¢É**
   + ÈÄâÊã©`AnnotationConfigApplicationContext`‰Ωú‰∏∫Spring‰∏ä‰∏ãÊñáÁéØÂ¢ÉÔºåËøôÊòØ‰∏ì‰∏∫JavaÊ≥®Ëß£ÈÖçÁΩÆÁöÑSpringÂÆπÂô®„ÄÇ
2. **ÂÆö‰πâÈÖçÁΩÆÁ±ª**
   + Âª∫Á´ã‰∏Ä‰∏™ÈÖçÁΩÆÁ±ªÂ¶Ç`MyConfiguration`Ôºå‰ΩøÁî®`@Configuration`Ê≥®Ëß£Ê†áËÆ∞ÂÆÉ„ÄÇËøôÂ∞ÜÂëäËØâSpringÔºåËØ•Á±ªÂåÖÂê´beanÁöÑÈÖçÁΩÆ‰ø°ÊÅØ„ÄÇ
3. **ÂêØÁî®ÁªÑ‰ª∂Êâ´Êèè**
   + Âú®ÈÖçÁΩÆÁ±ª‰∏ä‰ΩøÁî®`@ComponentScan`ÔºåÂπ∂‰∏∫ÂÖ∂Êèê‰æõÈúÄË¶ÅÊâ´ÊèèÁöÑÂåÖÂêç„ÄÇËøôÂÖÅËÆ∏SpringËá™Âä®Ê£ÄÊµãÂ∏¶ÊúâÁâπÂÆöÊ≥®Ëß£ÁöÑÁ±ªÔºåÂπ∂Â∞ÜÂÖ∂Ê≥®ÂÜå‰∏∫bean„ÄÇ
4. **ÂÆö‰πâBean**
   + Âú®ÁõÆÊ†áÁ±ªÔºàÂ¶ÇÊúçÂä°Á±ªÔºâ‰∏ä‰ΩøÁî®`@Component`ÊàñÂÖ∂‰ªñÁõ∏ÂÖ≥Ê≥®Ëß£ÔºàÂ¶Ç`@Service`, `@Repository`, `@Controller`Á≠âÔºâ„ÄÇËøôÁ°Æ‰øùSpringÂèØ‰ª•ËØÜÂà´ÂÆÉ‰ª¨Âπ∂Ëá™Âä®Â∞ÜÂÆÉ‰ª¨Ê∑ªÂä†Âà∞ÂÆπÂô®‰∏≠„ÄÇ
5. **Ëé∑ÂèñÂíå‰ΩøÁî®Bean**
   + Âú®Â∫îÁî®Á®ãÂ∫èÂÖ•Âè£‰∏≠ÔºåÂàùÂßãÂåñ‰∏ä‰∏ãÊñáÂπ∂‰ΩøÁî®`context.getBean()`ÊñπÊ≥ï‰ªéSpringÂÆπÂô®‰∏≠Ëé∑Âèñbean„ÄÇ
6. **Êü•ÁúãÁªìÊûú**
   + ËøêË°åÂ∫îÁî®Á®ãÂ∫èÂπ∂Á°ÆËÆ§ËæìÂá∫ÔºåÁ°Æ‰øùSpringÊ≠£Á°ÆÂú∞ËØÜÂà´Âπ∂ÂàùÂßãÂåñ‰∫ÜÊúüÊúõÁöÑbean„ÄÇ

#### Ê∫êÁ†ÅÂàÜÊûêÊÄªÁªì

1. **Ëé∑ÂèñBeanÂÆö‰πâ**
   + ÈÄöËøá`getBean`ÊñπÊ≥ïÔºåSpringÊèê‰æõ‰∫Ü‰∏Ä‰∏™ÊñπÂºèËÆ©Ë∞ÉÁî®ËÄÖÂü∫‰∫ébeanÁöÑÂêçÁß∞‰ªéSpring IoCÂÆπÂô®‰∏≠Ê£ÄÁ¥¢bean„ÄÇ
2. **Ëé∑ÂèñBeanÂêçÁß∞**
   + `transformedBeanName`ÊñπÊ≥ïÂ§ÑÁêÜ‰∫ÜbeanÂêçÁß∞ÁöÑËΩ¨Êç¢ÔºåÁ°Æ‰øùËøîÂõûÁöÑÂêçÁß∞ÊòØËßÑËåÉÁöÑÂπ∂Â§ÑÁêÜ‰∫ÜÂèØËÉΩÁöÑÂà´Âêç„ÄÇÂà´ÂêçÂ§ÑÁêÜÁî±`canonicalName`ÊñπÊ≥ïÂÆåÊàêÔºåËøô‰∏™ÊñπÊ≥ï‰∏çÊñ≠Âú∞‰ªéÂà´ÂêçÊò†Â∞Ñ‰∏≠Êü•ÊâæÁúüÂÆûÁöÑbeanÂêçÁß∞„ÄÇ
3. **Ê£ÄÁ¥¢Âçï‰æãBean**
   + `getSingleton`ÊñπÊ≥ïÂ∞ùËØï‰ªéÁºìÂ≠ò‰∏≠Ê£ÄÁ¥¢Âçï‰æãbean„ÄÇÂÆÉ‰ºöËÄÉËôëÂÆåÂÖ®ÂàùÂßãÂåñÁöÑbean„ÄÅÊó©ÊúüÂºïÁî®‰ª•ÂèäÂçï‰æãÂ∑•ÂéÇÁºìÂ≠òÁöÑbean„ÄÇÊ≠§ÊñπÊ≥ïÂú®Ëß£ÂÜ≥Âæ™ÁéØ‰æùËµñÈóÆÈ¢òÊó∂ÁâπÂà´ÊúâÁî®„ÄÇ
4. **Â§ÑÁêÜÂéüÂûãBean**
   + `isPrototypeCurrentlyInCreation`ÊñπÊ≥ïÊ£ÄÊü•ÁâπÂÆöÁöÑbeanÊòØÂê¶Ê≠£Âú®ÂàõÂª∫‰∏≠ÁöÑÂéüÂûãbeansÂàóË°®‰∏≠Ôºå‰ª•Â§ÑÁêÜÂéüÂûãbeanÁöÑÂæ™ÁéØÂºïÁî®„ÄÇ
5. **Ê†áËÆ∞BeanÂ∑≤ÂàõÂª∫**
   + `markBeanAsCreated`ÊñπÊ≥ïÊ†áËÆ∞‰∫ÜÊåáÂÆöÁöÑbeanÂ∑≤ÁªèË¢´ÂàõÂª∫ÊàñÊ≠£Âú®ÂàõÂª∫ÔºåËøôÂú®SpringÁöÑbeanÁîüÂëΩÂë®Êúü‰∏≠Ëµ∑Âà∞‰∫ÜÂÖ≥ÈîÆ‰ΩúÁî®„ÄÇ
6. **Ëé∑ÂèñÂêàÂπ∂ÁöÑBeanÂÆö‰πâ**
   + `getMergedLocalBeanDefinition`ÊñπÊ≥ïË¥üË¥£Ëé∑ÂèñÁªôÂÆöbeanÂêçÁß∞ÁöÑÂêàÂπ∂beanÂÆö‰πâ„ÄÇÂêàÂπ∂ÁöÑbeanÂÆö‰πâÊòØ‰ªéÁà∂beanÂíåÂ≠êbeanÂÆö‰πâ‰∏≠ÂêàÂπ∂ÁöÑÁªìÊûú„ÄÇËÄå`getMergedBeanDefinition`Ëøõ‰∏ÄÊ≠•Â§ÑÁêÜ‰∫ÜbeanÂÆö‰πâÁöÑÁà∂Â≠êÂÖ≥Á≥ªÂπ∂ËøîÂõû‰∫ÜÂêàÂπ∂ÂêéÁöÑbeanÂÆö‰πâ„ÄÇ
7. **Â§ÑÁêÜ@DependsOnÊ≥®Ëß£**
   + Â¶ÇÊûúbeanÂÆö‰πâ‰∏≠ÊåáÂÆö‰∫Ü@DependsOnÊ≥®Ëß£ÔºåSpring‰ºöÁ°Æ‰øùÂú®ÂΩìÂâçbean‰πãÂâçÂàõÂª∫ÂÆÉÊâÄ‰æùËµñÁöÑÂÖ∂‰ªñbeans„ÄÇËØ•Â§ÑÁêÜÂåÖÊã¨ÔºöÊ£ÄÊü•ÊòØÂê¶Â≠òÂú®Âæ™ÁéØ‰æùËµñÔºåÂú®BeanÂ∑•ÂéÇ‰∏≠Ê≥®ÂÜåbean‰πãÈó¥ÁöÑ‰æùËµñÂÖ≥Á≥ªÔºåÁ°Æ‰øùÊØè‰∏™Ë¢´‰æùËµñÁöÑbeanÈÉΩÂ∑≤ÁªèË¢´ÂàõÂª∫„ÄÇ
8. **Singleton BeanÁöÑÁºìÂ≠òËé∑Âèñ**
   - Âú®`DefaultSingletonBeanRegistry#getSingleton(beanName,singletonFactory)`ÊñπÊ≥ï‰∏≠ÔºåSpringÈ¶ñÂÖàÂ∞ùËØï‰ªéÁºìÂ≠ò‰∏≠Ê£ÄÁ¥¢ËØ•bean„ÄÇËã•Êó†Ê≥ïÂú®ÁºìÂ≠ò‰∏≠ÊâæÂà∞ÔºåÂÆÉ‰ºö‰ΩøÁî®Êèê‰æõÁöÑ`singletonFactory`Êù•ÂàõÂª∫bean„ÄÇÂàõÂª∫ÁöÑbean‰ºöË¢´Âä†ÂÖ•Âà∞ÁºìÂ≠ò‰∏≠ÔºåËøô‰øùËØÅ‰∫ÜÂÖ∂Âçï‰æãÊÄß„ÄÇ
9. **Â§ÑÁêÜÂæ™ÁéØÂºïÁî®**
   - Âú®`beforeSingletonCreation`ÊñπÊ≥ï‰∏≠ÔºåSpringÁ°Æ‰øùÂΩìÂâçbean‰∏ç‰ºöË¢´Â§öÊ¨°ÂàõÂª∫ÔºåËøôÊ†∑ÂèØ‰ª•ÈÅøÂÖçÂõ†Âæ™ÁéØÂºïÁî®ÂØºËá¥ÁöÑÈóÆÈ¢ò„ÄÇ
10. **ÂàõÂª∫BeanÂÆû‰æã**
    - `AbstractAutowireCapableBeanFactory#createBean(beanName, mbd, args)`ÊòØbeanÂàõÂª∫ÁöÑÊ†∏ÂøÉÊñπÊ≥ï„ÄÇÂú®ËøôÈáåÔºåSpring‰ºöËÄÉËôëÂ∑•ÂéÇÊñπÊ≥ï„ÄÅÊûÑÈÄ†ÂáΩÊï∞Ê≥®ÂÖ•Á≠âÂ§öÁßçÊñπÂºèÊù•ÂÆû‰æãÂåñbean„ÄÇÂêåÊó∂ÔºåÊ≠§Â§ÑËøò‰ºöÂ§ÑÁêÜÂâçÁΩÆÂíåÂêéÁΩÆÂ§ÑÁêÜÂô®„ÄÇ
11. **Â§ÑÁêÜBeanÂÆû‰æãÂåñ‰πãÂâçÁöÑÈÄªËæë**
    - Âú®`resolveBeforeInstantiation`ÊñπÊ≥ï‰∏≠Ôºå`InstantiationAwareBeanPostProcessor`ÂêéÂ§ÑÁêÜÂô®ÂèØËÉΩ‰ºöÊã¶Êà™beanÁöÑÊ†áÂáÜÂÆû‰æãÂåñÊµÅÁ®ã„ÄÇËøô‰∏ªË¶ÅÁî®‰∫éÂ¶ÇAOPÁöÑÂú∫ÊôØ„ÄÇ
12. **BeanÁöÑÂÆû‰æãÂåñ„ÄÅÂ±ûÊÄßÊ≥®ÂÖ•„ÄÅÂàùÂßãÂåñ**
    - `doCreateBean`ÊñπÊ≥ïÂ§ÑÁêÜ‰∫ÜbeanÁîüÂëΩÂë®Êúü‰∏≠ÁöÑÂ§ö‰∏™ÂÖ≥ÈîÆÈò∂ÊÆµÔºå‰ªébeanÁöÑÂÆû‰æãÂåñ„ÄÅÂ±ûÊÄßÊ≥®ÂÖ•„ÄÅÂàùÂßãÂåñÔºåÂà∞beanÁöÑÊ∏ÖÁêÜÊ≥®ÂÜå„ÄÇ
13. **ÈÄâÊã©ÊûÑÈÄ†ÂáΩÊï∞Âπ∂ÂÆû‰æãÂåñbean**
    - Âú®`createBeanInstance`ÊñπÊ≥ï‰∏≠ÔºåSpringÈ¶ñÂÖàÂ∞ùËØï‰ªéÂêéÂ§ÑÁêÜÂô®Ëé∑ÂèñÊûÑÈÄ†ÂáΩÊï∞„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊâæÂà∞ÂêàÈÄÇÁöÑÊûÑÈÄ†ÂáΩÊï∞ÔºåÂÆÉÂèØËÉΩ‰ºö‰ΩøÁî®Êó†ÂèÇÊï∞ÊûÑÈÄ†ÂáΩÊï∞ÔºåÊàñËÄÖËÄÉËôëÂÖ∂‰ªñÈÄªËæëÔºåÂ¶ÇÈ¶ñÈÄâÊûÑÈÄ†ÂáΩÊï∞„ÄÇ
14. **Êô∫ËÉΩÂÆû‰æãÂåñÁ≠ñÁï•**
    - `determineConstructorsFromBeanPostProcessors`ÊñπÊ≥ï‰∏≠ÔºåÈÄöËøá`SmartInstantiationAwareBeanPostProcessor`ÔºåSpringÂèØ‰ª•Ë∞ÉÊï¥ÊûÑÈÄ†ÂáΩÊï∞ÈÄâÊã©ÔºåÊèê‰æõÊõ¥Âä†Êô∫ËÉΩÁöÑbeanÂÆû‰æãÂåñÁ≠ñÁï•„ÄÇ
15. **Áõ¥Êé•ÂÆû‰æãÂåñbean**
    - `instantiateBean`ÊñπÊ≥ïÊòØ‰∏Ä‰∏™ÁÆÄÂçïÁöÑbeanÂÆû‰æãÂåñËøáÁ®ãÔºåÈÄöÂ∏∏Áî®‰∫éÊ≤°ÊúâÁâπÂÆöÊûÑÈÄ†ÂáΩÊï∞ÊàñÂ∑•ÂéÇÊñπÊ≥ïÁöÑbean„ÄÇ

16. **`MergedBeanDefinitionPostProcessor`Â§ÑÁêÜ**Ôºö
    - Âú®`applyMergedBeanDefinitionPostProcessors`ÊñπÊ≥ï‰∏≠Ôºå`MergedBeanDefinitionPostProcessor`Êé•Âè£Áî®‰∫éÂú®beanÂÆû‰æãÂåñÂâçÂØπÂÖ∂ÂÆö‰πâËøõË°åÂ§ÑÁêÜÂíåË∞ÉÊï¥„ÄÇ

17. **Â§ÑÁêÜÂæ™ÁéØÂºïÁî®**Ôºö
    - `addSingletonFactory`ÊñπÊ≥ïÊ≥®ÂÜå‰∏Ä‰∏™`ObjectFactory`ÔºåÊó®Âú®Ëß£ÂÜ≥beanÂàõÂª∫ÂâçÁöÑÂæ™ÁéØÂºïÁî®ÈóÆÈ¢ò„ÄÇ

18. **Â°´ÂÖÖbeanÂ±ûÊÄß**Ôºö
    - `populateBean`ÊñπÊ≥ïË¥üË¥£Â°´ÂÖÖbeanÁöÑÂ±ûÊÄß„ÄÇÂÆÉÈÅçÂéÜÊâÄÊúâÁöÑ`InstantiationAwareBeanPostProcessors`ÔºåË∞ÉÁî®ÂÆÉ‰ª¨ÁöÑÊñπÊ≥ïËøõË°åbeanÂ±ûÊÄßÁöÑÂêéÂ§ÑÁêÜ„ÄÇ

19. **beanÂàùÂßãÂåñ**Ôºö

    - `initializeBean`ÊñπÊ≥ïÂ§ÑÁêÜbeanÁöÑÂàùÂßãÂåñÔºåÂåÖÊã¨Ë∞ÉÁî®AwareÊé•Âè£ÊñπÊ≥ï„ÄÅÊâßË°å`BeanPostProcessors`ÁöÑÂàùÂßãÂåñÂâçÂêéÊñπÊ≥ïÔºå‰ª•ÂèäbeanÁöÑËá™ÂÆö‰πâÂàùÂßãÂåñÊñπÊ≥ï„ÄÇ

    - `invokeAwareMethods`ÊñπÊ≥ïÂ§ÑÁêÜbeanÁöÑAwareÊé•Âè£Ë∞ÉÁî®ÔºåËÆ©beanÂèØ‰ª•Ëé∑ÂæóSpringÂÆπÂô®Êèê‰æõÁöÑ‰∏Ä‰∫õËÉΩÂäõ„ÄÇ

20. **Ê≥®ÂÜåbeanÁöÑÈîÄÊØÅÊñπÊ≥ï**Ôºö
    - `registerDisposableBeanIfNecessary`ÊñπÊ≥ïË¥üË¥£‰∏∫beanÊ≥®ÂÜå‰∏Ä‰∏™ÈîÄÊØÅÂõûË∞É„ÄÇÂΩìÂÆπÂô®ÂÖ≥Èó≠Âπ∂ÈúÄË¶ÅÊ∏ÖÁêÜËµÑÊ∫êÊàñÊâßË°åÂÖ∂‰ªñÈîÄÊØÅÈÄªËæëÊó∂ÔºåËøô‰∏™ÂõûË∞É‰ºöË¢´Ëß¶Âèë„ÄÇ

21. **‰øùÊä§Âπ∂ÂèëbeanÂàõÂª∫**Ôºö
    - `afterSingletonCreation`ÊñπÊ≥ïÁ°Æ‰øùbeanÂàõÂª∫ËøáÁ®ãÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºåÂπ∂‰øùÊä§Á≥ªÁªüÂÖçÂèó‰∏çÊ≠£Á°ÆÁöÑÂπ∂ÂèëËÆøÈóÆ„ÄÇ

22. **Â§ÑÁêÜÂçï‰æãbeanÁöÑÁîüÂëΩÂë®Êúü**Ôºö
    - `addSingleton`ÊñπÊ≥ïÂ§ÑÁêÜ‰∏éÂçï‰æãbeanÁîüÂëΩÂë®ÊúüÁõ∏ÂÖ≥ÁöÑÂêÑÁßçÁºìÂ≠òÂíåÈõÜÂêà„ÄÇ

23. **Ëé∑ÂèñÊàñËΩ¨Êç¢beanÂÆû‰æã**Ôºö

    - `getObjectForBeanInstance`ÊñπÊ≥ïÊ†πÊçÆÊèê‰æõÁöÑbeanÂÆû‰æãÂíåÂêçÁß∞ÔºåË¶Å‰πàËøîÂõûbeanÂÆû‰æãÊú¨Ë∫´ÔºåË¶Å‰πà‰ªé`FactoryBean`‰∏≠Ëé∑ÂèñÂØπË±°„ÄÇ

    - `adaptBeanInstance`ÊñπÊ≥ïÁ°Æ‰øùbeanÂÆû‰æã‰∏éÊåáÂÆöÁöÑÁõÆÊ†áÁ±ªÂûãÂåπÈÖçÔºåÂ¶ÇÊûú‰∏çÂåπÈÖçÔºåÂÆÉÂ∞ÜÂ∞ùËØïËΩ¨Êç¢beanÂÆû‰æã„ÄÇ
