## @Bean

- [@Bean](#bean)
  - [‰∏Ä„ÄÅÂü∫Êú¨‰ø°ÊÅØ](#‰∏ÄÂü∫Êú¨‰ø°ÊÅØ)
  - [‰∫å„ÄÅÊ≥®Ëß£ÊèèËø∞](#‰∫åÊ≥®Ëß£ÊèèËø∞)
  - [‰∏â„ÄÅÊ≥®Ëß£Ê∫êÁ†Å](#‰∏âÊ≥®Ëß£Ê∫êÁ†Å)
  - [Âõõ„ÄÅ‰∏ªË¶ÅÂäüËÉΩ](#Âõõ‰∏ªË¶ÅÂäüËÉΩ)
  - [‰∫î„ÄÅÊúÄ‰Ω≥ÂÆûË∑µ](#‰∫îÊúÄ‰Ω≥ÂÆûË∑µ)
  - [ÂÖ≠„ÄÅÊó∂Â∫èÂõæ](#ÂÖ≠Êó∂Â∫èÂõæ)
    - [@BeanÊ≥®ÂÜåÊó∂Â∫èÂõæ](#beanÊ≥®ÂÜåÊó∂Â∫èÂõæ)
    - [@BeanÂàùÂßãÂåñÊñπÊ≥ïÊó∂Â∫èÂõæ](#beanÂàùÂßãÂåñÊñπÊ≥ïÊó∂Â∫èÂõæ)
    - [@BeanÈîÄÊØÅÊñπÊ≥ïÊó∂Â∫èÂõæ](#beanÈîÄÊØÅÊñπÊ≥ïÊó∂Â∫èÂõæ)
  - [‰∏É„ÄÅÊ∫êÁ†ÅÂàÜÊûê](#‰∏ÉÊ∫êÁ†ÅÂàÜÊûê)
    - [@BeanÊ≥®ÂÜåÊ∫êÁ†ÅÂàÜÊûê](#beanÊ≥®ÂÜåÊ∫êÁ†ÅÂàÜÊûê)
    - [@BeanÂàùÂßãÂåñÊ∫êÁ†ÅÂàÜÊûê](#beanÂàùÂßãÂåñÊ∫êÁ†ÅÂàÜÊûê)
    - [@BeanÈîÄÊØÅÊ∫êÁ†ÅÂàÜÊûê](#beanÈîÄÊØÅÊ∫êÁ†ÅÂàÜÊûê)
  - [ÂÖ´„ÄÅÊ≥®ÊÑè‰∫ãÈ°π](#ÂÖ´Ê≥®ÊÑè‰∫ãÈ°π)
  - [‰πù„ÄÅÊÄªÁªì](#‰πùÊÄªÁªì)
    - [ÊúÄ‰Ω≥ÂÆûË∑µÊÄªÁªì](#ÊúÄ‰Ω≥ÂÆûË∑µÊÄªÁªì)
    - [Ê∫êÁ†ÅÂàÜÊûêÊÄªÁªì](#Ê∫êÁ†ÅÂàÜÊûêÊÄªÁªì)


### ‰∏Ä„ÄÅÂü∫Êú¨‰ø°ÊÅØ

‚úíÔ∏è **‰ΩúËÄÖ** - Lex üìù **ÂçöÂÆ¢** - [ÊàëÁöÑCSDN](https://blog.csdn.net/duzhuang2399/article/details/132498762) üìö **ÊñáÁ´†ÁõÆÂΩï** - [ÊâÄÊúâÊñáÁ´†](https://github.com/xuchengsheng/spring-reading) üîó **Ê∫êÁ†ÅÂú∞ÂùÄ** - [@BeanÊ∫êÁ†Å](https://github.com/xuchengsheng/spring-reading/tree/master/spring-annotation/spring-annotation-bean)

### ‰∫å„ÄÅÊ≥®Ëß£ÊèèËø∞

`@Bean` ÊòØ Spring Ê°ÜÊû∂ÁöÑÊ†∏ÂøÉÊ≥®Ëß£ÔºåÁî®‰∫éÊ†áËÆ∞‰∏Ä‰∏™ÊñπÊ≥ïÔºåË°®ÊòéËøô‰∏™ÊñπÊ≥ïËøîÂõûÂÄºÂ∫îË¢´Ê≥®ÂÜå‰∏∫ Spring ÂÆπÂô®‰∏≠ÁöÑ‰∏Ä‰∏™ÂØπË±°ÔºàBeanÔºâ„ÄÇ‰∏é‰º†ÁªüÁöÑ XML ÈÖçÁΩÆÊñπÂºèÁõ∏ÊØîÔºåÂÆÉÊèê‰æõ‰∫Ü‰∏ÄÁßçÊõ¥Âä†ÁÆÄÊ¥ÅÂíåÁõ¥ËßÇÁöÑÊñπÂºèÊù•ÂÆö‰πâ Bean„ÄÇÈÄöÂ∏∏Ôºå`@Bean` ‰∏é `@Configuration` Ê≥®Ëß£‰∏ÄËµ∑‰ΩøÁî®ÔºåÂêéËÄÖÊ†áËÆ∞‰∏Ä‰∏™Á±ª‰∏∫ Spring ÁöÑÈÖçÁΩÆÁ±ª„ÄÇÊñπÊ≥ïÂêçÈªòËÆ§‰Ωú‰∏∫ Bean ÁöÑ IDÔºå‰ΩÜ‰πüÂèØ‰ª•ÈÄöËøá `@Bean` ÁöÑ `name` Â±ûÊÄßËá™ÂÆö‰πâ„ÄÇËøôÁßçÂ£∞ÊòéÂºèÁöÑ Bean ÂÆö‰πâÊñπÂºèÂú® Java ‰ª£Á†Å‰∏≠Êèê‰æõ‰∫ÜÂº∫Â§ßÁöÑÁÅµÊ¥ªÊÄßÔºåÂÖÅËÆ∏Êàë‰ª¨Âà©Áî® Java ÁöÑÂÆåÊï¥ÁâπÊÄßÊù•ÈÖçÁΩÆÂíåÂàùÂßãÂåñÂØπË±°„ÄÇÊ≠§Â§ñÔºåÁªìÂêàÂÖ∂‰ªñ Spring ÁâπÊÄßÔºåÂ¶Ç `@Autowired`ÔºåÂèØ‰ª•ËΩªÊùæÂÆûÁé∞‰æùËµñÊ≥®ÂÖ•ÔºåËøõ‰∏ÄÊ≠•ÁÆÄÂåñ‰∫ÜÂ∫îÁî®ÁöÑÈÖçÁΩÆÂíåÁªÑ‰ª∂ÁÆ°ÁêÜ„ÄÇÊÄª‰πãÔºåÈÄöËøá `@Bean` Ê≥®Ëß£ÔºåSpring ‰∏∫Áé∞‰ª£ÂåñÁöÑÂ∫îÁî®ÂºÄÂèëÊèê‰æõ‰∫ÜÂº∫Â§ßÁöÑÊîØÊåÅÔºå‰ΩøÂæó‰ª£Á†ÅÊõ¥‰∏∫Êï¥Ê¥ÅÂíåÊòì‰∫éÁª¥Êä§„ÄÇ

### ‰∏â„ÄÅÊ≥®Ëß£Ê∫êÁ†Å

`@Bean`Ê≥®Ëß£ÊòØ Spring Ê°ÜÊû∂Ëá™ 3.0 ÁâàÊú¨ÂºÄÂßãÂºïÂÖ•ÁöÑ‰∏Ä‰∏™Ê†∏ÂøÉÊ≥®Ëß£ÔºåËøô‰∏™Ê≥®Ëß£Ë°®Êòé‰∏Ä‰∏™ÊñπÊ≥ï‰ºöËøîÂõû‰∏Ä‰∏™ÂØπË±°ÔºåËØ•ÂØπË±°Â∫îËØ•Ë¢´Ê≥®ÂÜå‰∏∫ Spring Â∫îÁî®‰∏ä‰∏ãÊñá‰∏≠ÁöÑ‰∏Ä‰∏™ bean„ÄÇ

```java
/**
 * ÊåáÁ§∫‰∏Ä‰∏™ÊñπÊ≥ï‰ºö‰∫ßÁîü‰∏Ä‰∏™Áî±SpringÂÆπÂô®ÁÆ°ÁêÜÁöÑBean„ÄÇ
 * @author Rod Johnson
 * @author Costin Leau
 * @author Chris Beams
 * @author Juergen Hoeller
 * @author Sam Brannen
 * @since 3.0
 * @see Configuration
 * @see Scope
 * @see DependsOn
 * @see Lazy
 * @see Primary
 * @see org.springframework.stereotype.Component
 * @see org.springframework.beans.factory.annotation.Autowired
 * @see org.springframework.beans.factory.annotation.Value
 */
@Target({ElementType.METHOD, ElementType.ANNOTATION_TYPE})
@Retention(RetentionPolicy.RUNTIME)
@Documented
public @interface Bean {

    /**
     * {@link #name}ÁöÑÂà´Âêç„ÄÇ
     * ÂΩì‰∏çÈúÄË¶ÅÂÖ∂‰ªñÂ±ûÊÄßÊó∂ÂèØ‰ª•‰ΩøÁî®Ôºå‰æãÂ¶ÇÔºö{@code @Bean("customBeanName")}„ÄÇ
     * @see #name
     */
    @AliasFor("name")
    String[] value() default {};

    /**
     * Ëøô‰∏™beanÁöÑÂêçÁß∞ÔºåÊàñËÄÖÂ¶ÇÊûúÊúâÂ§ö‰∏™ÂêçÁß∞ÔºåÂàô‰∏∫‰∏ªË¶ÅÁöÑbeanÂêçÁß∞Âä†‰∏äÂà´Âêç„ÄÇ
     * Â¶ÇÊûúÊú™ÊåáÂÆöÔºåbeanÁöÑÂêçÁß∞ÊòØÊ≥®Ëß£ÊñπÊ≥ïÁöÑÂêçÁß∞„ÄÇ
     * @see #value
     */
    @AliasFor("value")
    String[] name() default {};

    /**
     * ÊòØÂê¶ÈÄöËøáÂü∫‰∫é‰π†ÊÉØÁöÑÊåâÂêçÁß∞ÊàñÁ±ªÂûãËøõË°åËá™Âä®Ë£ÖÈÖçÔºü
     * Ê≥®ÊÑèÔºåËøôÁßçËá™Âä®Ë£ÖÈÖçÊ®°ÂºèÊòØÂü∫‰∫éÊåâÁÖß‰π†ÊÉØÈÄöËøábeanÂ±ûÊÄßÁöÑsetterÊñπÊ≥ïËøõË°åÁöÑÂ§ñÈÉ®È©±Âä®ÁöÑËá™Âä®Ë£ÖÈÖç„ÄÇ
     * @deprecated ...
     */
    @Deprecated
    Autowire autowire() default Autowire.NO;

    /**
     * Ëøô‰∏™beanÊòØÂê¶ÂèØ‰ª•‰Ωú‰∏∫ÂÖ∂‰ªñbeanÁöÑËá™Âä®Ê≥®ÂÖ•ÂÄôÈÄâËÄÖÔºü
     */
    boolean autowireCandidate() default true;

    /**
     * Âú®ÂàùÂßãÂåñÊó∂Ë∞ÉÁî®beanÂÆû‰æã‰∏äÁöÑÊñπÊ≥ïÁöÑÂèØÈÄâÂêçÁß∞„ÄÇ
     * ÈÄöÂ∏∏ÔºåÂèØ‰ª•Âú®Â∏¶Êúâ@BeanÊ≥®Ëß£ÁöÑÊñπÊ≥ïÁöÑ‰∏ª‰Ωì‰∏≠Áõ¥Êé•‰ª•ÁºñÁ®ãÊñπÂºèË∞ÉÁî®ËØ•ÊñπÊ≥ï„ÄÇ
     */
    String initMethod() default "";

    /**
     * Âú®ÂÖ≥Èó≠Â∫îÁî®Á®ãÂ∫è‰∏ä‰∏ãÊñáÊó∂Ë∞ÉÁî®beanÂÆû‰æã‰∏äÁöÑÊñπÊ≥ïÁöÑÂèØÈÄâÂêçÁß∞„ÄÇ
     * ‰æãÂ¶ÇÔºå‰∏Ä‰∏™JDBC DataSourceÁöÑclose()ÊñπÊ≥ï„ÄÇ
     */
    String destroyMethod() default AbstractBeanDefinition.INFER_METHOD;

}
```

### Âõõ„ÄÅ‰∏ªË¶ÅÂäüËÉΩ

1. **Bean ÁöÑÂàõÂª∫‰∏éÊ≥®ÂÜå**:
   + `@Bean` Ê≥®Ëß£Áî®‰∫éÊ†áËÆ∞‰∏Ä‰∏™ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïËøîÂõûÁöÑÂØπË±°‰ºöË¢´ Spring ÂÆπÂô®ÁÆ°ÁêÜ„ÄÇËøôÊÑèÂë≥ÁùÄÂΩìÂ∫îÁî®‰∏ä‰∏ãÊñáÂêØÂä®Êó∂ÔºåËØ•ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®ÔºåÂπ∂‰∏îÂÆÉÁöÑËøîÂõûÂÄº‰ºöË¢´Ê∑ªÂä†Âà∞ÂÆπÂô®‰∏≠‰Ωú‰∏∫‰∏Ä‰∏™ bean„ÄÇ

2. **Ëá™ÂÆö‰πâ Bean ÂêçÁß∞**
   + ËôΩÁÑ∂ÈªòËÆ§ÁöÑ bean ÂêçÁß∞ÊòØÊ†áÊ≥® `@Bean` ÁöÑÊñπÊ≥ïÁöÑÂêçÁß∞Ôºå‰ΩÜÂèØ‰ª•ÈÄöËøá `@Bean` ÁöÑ `name` Â±ûÊÄß‰∏∫ bean ÊåáÂÆö‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÂêçÁß∞„ÄÇ

3. **ÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜ**
   + ÈÄöËøá `initMethod` Âíå `destroyMethod` Â±ûÊÄßÔºåÂèØ‰ª•‰∏∫ bean ÊåáÂÆöÂàùÂßãÂåñÂíåÈîÄÊØÅÁöÑÂõûË∞ÉÊñπÊ≥ï„ÄÇÂΩì bean Ë¢´ÂàõÂª∫ÊàñÈîÄÊØÅÊó∂ÔºåËøô‰∫õÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇ

4. **Êõø‰ª£ XML ÈÖçÁΩÆ**
   + Âú®Êó©ÊúüÁöÑ Spring ÁâàÊú¨‰∏≠Ôºåbean ÈÄöÂ∏∏ÊòØÂú® XML Êñá‰ª∂‰∏≠ÂÆö‰πâÁöÑ„ÄÇ‰ΩøÁî® `@Bean` Ê≥®Ëß£ÂèØ‰ª•ÂÆåÂÖ®Áî® Java ÈÖçÁΩÆÊù•Êõø‰ª£ XMLÔºå‰ªéËÄå‰ΩøÈÖçÁΩÆÊõ¥‰∏∫ÈõÜ‰∏≠ÂíåÁ±ªÂûãÂÆâÂÖ®„ÄÇ

5. **ÁÅµÊ¥ªÁöÑ‰æùËµñÊ≥®ÂÖ•**
   + Âú® `@Bean` ÊñπÊ≥ïÂÜÖÈÉ®ÔºåÂèØ‰ª•Áõ¥Êé•Ë∞ÉÁî®ÂÖ∂‰ªñ `@Bean` ÊñπÊ≥ïÔºåÂÆûÁé∞‰æùËµñÁöÑÊ≥®ÂÖ•„ÄÇËøôÁßçÊñπÂºè‰øùËØÅ‰∫ÜÁ±ªÂûãÂÆâÂÖ®ÔºåÂπ∂‰ΩøÂæó‰ª£Á†Å‰∏éÈÖçÁΩÆÁ¥ßÂØÜÁªìÂêà„ÄÇ

6. **‰∏éÂÖ∂‰ªñÊ≥®Ëß£ÁªìÂêà**
   + `@Bean` Ê≥®Ëß£ÁªèÂ∏∏‰∏éÂÖ∂‰ªñ Spring Ê≥®Ëß£‰∏ÄËµ∑‰ΩøÁî®ÔºåÂ¶Ç `@Scope`ÔºàÂÆö‰πâ bean ÁöÑËåÉÂõ¥ÔºåÂ¶ÇÂçï‰æãÊàñÂéüÂûãÔºâÔºå`@Lazy`ÔºàÂª∂Ëøü bean ÁöÑÂàùÂßãÂåñÔºâÔºå`@Primary`ÔºàÂΩìÂ≠òÂú®Â§ö‰∏™Áõ∏ÂêåÁ±ªÂûãÁöÑ bean Êó∂ÔºåÊ†áËÆ∞‰∏Ä‰∏™‰∏∫È¶ñÈÄâÔºâÁ≠âÔºå‰∏∫ bean Êèê‰æõÊõ¥ËØ¶ÁªÜÁöÑÈÖçÁΩÆ„ÄÇ

7. **ÊéßÂà∂Ëá™Âä®Ë£ÖÈÖçË°å‰∏∫**
   + ÈÄöËøá `autowireCandidate` Â±ûÊÄßÔºåÂèØ‰ª•ÊéßÂà∂ËØ• bean ÊòØÂê¶Â∫îË¢´ËßÜ‰∏∫Ëá™Âä®Ë£ÖÈÖçÁöÑÂÄôÈÄâÂØπË±°ÔºåÂΩìÂÖ∂‰ªñ bean ÈúÄË¶ÅËøõË°åÁ±ªÂûãÂåπÈÖçÁöÑËá™Âä®Ë£ÖÈÖçÊó∂„ÄÇ

### ‰∫î„ÄÅÊúÄ‰Ω≥ÂÆûË∑µ

È¶ñÂÖàÊù•ÁúãÁúãÂêØÂä®Á±ªÂÖ•Âè£Ôºå‰∏ä‰∏ãÊñáÁéØÂ¢É‰ΩøÁî®`AnnotationConfigApplicationContext`ÔºàÊ≠§Á±ªÊòØ‰ΩøÁî®JavaÊ≥®Ëß£Êù•ÈÖçÁΩÆSpringÂÆπÂô®ÁöÑÊñπÂºèÔºâÔºåÊûÑÈÄ†ÂèÇÊï∞Êàë‰ª¨ÁªôÂÆö‰∫Ü‰∏Ä‰∏™`MyConfiguration`ÁªÑ‰ª∂Á±ª„ÄÇÁÑ∂Âêé‰ªéSpring‰∏ä‰∏ãÊñá‰∏≠Ëé∑Âèñ‰∏Ä‰∏™`MyBean`Á±ªÂûãÁöÑbeanÔºåÊúÄÂêéË∞ÉÁî®`context.close()`ÊñπÊ≥ïÂÖ≥Èó≠ÂÆπÂô®„ÄÇ

```java
public class BeanApplication {

    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(MyConfiguration.class);
        System.out.println(context.getBean(MyBean.class));
        context.close();
    }
}
```

Âú® `MyConfiguration` ÈÖçÁΩÆÁ±ª‰∏≠ÔºåÈÄöËøá `@Bean` Ê≥®Ëß£ÂÆö‰πâ‰∫Ü‰∏Ä‰∏™Âêç‰∏∫ `myBean` ÁöÑ bean„ÄÇËøô‰∏™ bean ÊòØ `MyBean` Á±ªÁöÑÂÆû‰æã„ÄÇÂΩì Spring ÂÆπÂô®ÂàùÂßãÂåñËøô‰∏™ bean Êó∂ÔºåÂÆÉ‰ºöÈ¶ñÂÖàË∞ÉÁî® `MyBean` ÁöÑ `init` ÊñπÊ≥ïÔºàÁî± `initMethod` Â±ûÊÄßÊåáÂÆöÔºâ„ÄÇÂΩìËøô‰∏™ bean Âú®ÂÆπÂô®ÂÖ≥Èó≠Êó∂Ë¢´ÈîÄÊØÅÔºåÂÆÉ‰ºöË∞ÉÁî® `MyBean` ÁöÑ `destroy` ÊñπÊ≥ïÔºàÁî± `destroyMethod` Â±ûÊÄßÊåáÂÆöÔºâ„ÄÇ

```java
@Configuration
public class MyConfiguration {

    @Bean(initMethod = "init",destroyMethod = "destroy")
    public MyBean myBean(){
        return new MyBean();
    }
}
```

ÂΩì Spring ÂÆπÂô®ÂàõÂª∫ `MyBean` ÁöÑÂÆû‰æãÊó∂Ôºå`init` ÊñπÊ≥ï‰ºöË¢´Ëá™Âä®Ë∞ÉÁî®ÔºåÂõ†Ê≠§ "MyBean.init" ‰ºöË¢´ËæìÂá∫Âà∞ÊéßÂà∂Âè∞„ÄÇÂêåÊ†∑Âú∞ÔºåÂΩì Spring ÂÆπÂô®ÂáÜÂ§áÈîÄÊØÅËøô‰∏™ bean ÊàñÂÖ≥Èó≠Êó∂Ôºå`destroy` ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®Ôºå‰∫éÊòØ "MyBean.destroy" ‰ºöË¢´ËæìÂá∫Âà∞ÊéßÂà∂Âè∞„ÄÇ

```java
public class MyBean {

    public void init(){
        System.out.println("MyBean.init");
    }

    public void destroy(){
        System.out.println("MyBean.destroy");
    }
}
```

ËøêË°åÁªìÊûúÂèëÁé∞ÔºåËØÅÊòé‰∫ÜÂú®ÂàõÂª∫ bean Êó∂ `init` ÊñπÊ≥ïÁöÑË∞ÉÁî®‰ª•ÂèäÂú®ÈîÄÊØÅ bean Êó∂ `destroy` ÊñπÊ≥ïÁöÑË∞ÉÁî®Ôºå‰ªéËÄåÂ±ïÁ§∫‰∫ÜÈÄöËøá `@Bean` Ê≥®Ëß£ÊåáÂÆöÁöÑÁîüÂëΩÂë®ÊúüÊñπÊ≥ïÂú®ÂÆûÈôÖÂ∫îÁî®‰∏≠ÁöÑÊâßË°åÈ°∫Â∫è„ÄÇ

```java
MyBean.init
com.xcs.spring.bean.MyBean@2fb3536e
MyBean.destroy
```

### ÂÖ≠„ÄÅÊó∂Â∫èÂõæ

#### @BeanÊ≥®ÂÜåÊó∂Â∫èÂõæ

~~~mermaid
sequenceDiagram
Title: @BeanÊ≥®ÂÜåÊó∂Â∫èÂõæ
BeanApplication->>AnnotationConfigApplicationContext: AnnotationConfigApplicationContext(componentClasses)<br>ÂàõÂª∫Â∫îÁî®‰∏ä‰∏ãÊñá
AnnotationConfigApplicationContext->>AbstractApplicationContext: refresh()<br>Âà∑Êñ∞Â∫îÁî®‰∏ä‰∏ãÊñá
AbstractApplicationContext->>AbstractApplicationContext: invokeBeanFactoryPostProcessors(beanFactory)<br>Ë∞ÉÁî®BeanFactoryÂêéÁΩÆÂ§ÑÁêÜÂô®
AbstractApplicationContext->>PostProcessorRegistrationDelegate: invokeBeanFactoryPostProcessors(beanFactory,beanFactoryPostProcessors)<br>ÊâßË°åBeanFactoryÁöÑÂêéÁΩÆÂ§ÑÁêÜÂô®
PostProcessorRegistrationDelegate->>PostProcessorRegistrationDelegate: invokeBeanDefinitionRegistryPostProcessors(postProcessors,registry,applicationStartup)<br>ÊâßË°åBeanDefinitionÁöÑÊ≥®ÂÜåÂêéÂ§ÑÁêÜÂô®
PostProcessorRegistrationDelegate->>ConfigurationClassPostProcessor: postProcessBeanDefinitionRegistry(registry)<br>Â§ÑÁêÜ@ConfigurationÊ≥®Ëß£ÁöÑÁ±ªÁöÑBeanÂÆö‰πâ
ConfigurationClassPostProcessor->>ConfigurationClassPostProcessor: processConfigBeanDefinitions(registry)<br>Â§ÑÁêÜÈÖçÁΩÆÁ±ªÁöÑBeanÂÆö‰πâ
ConfigurationClassPostProcessor->>ConfigurationClassParser: ConfigurationClassParser(...)<br>ÂàõÂª∫ÈÖçÁΩÆÁ±ªËß£ÊûêÂô®
ConfigurationClassParser-->>ConfigurationClassPostProcessor: ËøîÂõûparserËß£ÊûêÂô®<br>
ConfigurationClassPostProcessor->>ConfigurationClassParser: parser.parse(candidates)<br>Ëß£ÊûêÂÄôÈÄâÁöÑ@ConfigurationÁ±ª
ConfigurationClassParser->>ConfigurationClassParser: parse(metadata, String beanName)<br>Ëß£ÊûêÂÖ∑‰ΩìÁöÑ@ConfigurationÁ±ª
ConfigurationClassParser->>ConfigurationClassParser: processConfigurationClass(configClass,filter)<br>Â§ÑÁêÜ@ConfigurationÁ±ª
ConfigurationClassParser->>+ConfigurationClassParser: doProcessConfigurationClass(configClass,sourceClass,filter)<br>ÂÆûÈôÖÂ§ÑÁêÜ@ConfigurationÁ±ª
ConfigurationClassParser->>+ConfigurationClassParser: retrieveBeanMethodMetadata(sourceClass)<br>Ëé∑Âèñ@BeanÊñπÊ≥ïÁöÑÂÖÉÊï∞ÊçÆ
ConfigurationClassParser-->>-ConfigurationClassParser: ËøîÂõûSet<MethodMetadata><br>
ConfigurationClassParser-->>-ConfigurationClassParser: ËøîÂõûSourceClass<br>
ConfigurationClassPostProcessor->>ConfigurationClassBeanDefinitionReader: loadBeanDefinitions(configurationModel)<br>Âä†ËΩΩBeanÂÆö‰πâ
ConfigurationClassBeanDefinitionReader->>ConfigurationClassBeanDefinitionReader: loadBeanDefinitionsForConfigurationClass(configClass,trackedConditionEvaluator)<br>‰∏∫@ConfigurationÁ±ªÂä†ËΩΩBeanÂÆö‰πâ
ConfigurationClassBeanDefinitionReader->>ConfigurationClassBeanDefinitionReader: loadBeanDefinitionsForBeanMethod(beanMethod)<br>‰∏∫@BeanÊñπÊ≥ïÂä†ËΩΩBeanÂÆö‰πâ
ConfigurationClassBeanDefinitionReader->>DefaultListableBeanFactory: registerBeanDefinition(beanName, beanDefToRegister)<br>Âú®BeanFactory‰∏≠Ê≥®ÂÜåBeanÂÆö‰πâ
~~~

#### @BeanÂàùÂßãÂåñÊñπÊ≥ïÊó∂Â∫èÂõæ

~~~mermaid
sequenceDiagram
Title: @BeanÂàùÂßãÂåñÊñπÊ≥ïÊó∂Â∫èÂõæ
BeanApplication->>AnnotationConfigApplicationContext: AnnotationConfigApplicationContext(componentClasses)<br>ÂàõÂª∫Â∫îÁî®‰∏ä‰∏ãÊñá
AnnotationConfigApplicationContext->>AbstractApplicationContext: refresh()<br>Âà∑Êñ∞Â∫îÁî®‰∏ä‰∏ãÊñá
AbstractApplicationContext->>AbstractApplicationContext: finishBeanFactoryInitialization(beanFactory)<br>ÂÆåÊàêBeanFactoryÁöÑÂàùÂßãÂåñ
AbstractApplicationContext->>DefaultListableBeanFactory: preInstantiateSingletons()<br>È¢ÑÂÖàÂÆû‰æãÂåñÂçï‰æãBean
DefaultListableBeanFactory->>AbstractBeanFactory: getBean(name)<br>Ëé∑ÂèñBean
AbstractBeanFactory->>AbstractBeanFactory: doGetBean(name,requiredType,args,typeCheckOnly)<br>ÊâßË°åÁúüÂÆûÁöÑËé∑ÂèñBeanÁöÑÊìç‰Ωú
AbstractBeanFactory->>DefaultSingletonBeanRegistry: getSingleton(beanName,singletonFactory)<br>‰ªéÂçï‰æãÊ≥®ÂÜåË°®‰∏≠Ëé∑ÂèñBean
DefaultSingletonBeanRegistry->>AbstractBeanFactory: singletonFactory.getObject()<br>‰ªésingletonÂ∑•ÂéÇ‰∏≠Ëé∑ÂèñBeanÂØπË±°
AbstractBeanFactory->>AbstractAutowireCapableBeanFactory: createBean(beanName,mbd,args)<br>ÂàõÂª∫Bean
AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory: doCreateBean(beanName,mbd,args)<br>ÊâßË°åBeanÁöÑÂàõÂª∫ËøáÁ®ã
AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory: initializeBean(beanName,bean,mbd)<br>ÂàùÂßãÂåñBean
AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory: invokeInitMethods(beanName,bean,mbd)<br>Ë∞ÉÁî®BeanÁöÑÂàùÂßãÂåñÊñπÊ≥ï
AbstractAutowireCapableBeanFactory->>AbstractAutowireCapableBeanFactory: invokeCustomInitMethod(beanName,bean,mbd)<br>ÊâßË°åËá™ÂÆö‰πâÁöÑÂàùÂßãÂåñÊñπÊ≥ï
AbstractAutowireCapableBeanFactory->>Method: invoke(obj,args)<br>ÂèçÂ∞ÑË∞ÉÁî®BeanÁöÑÊñπÊ≥ï
Method->>MyBean: init()<br>ÊâßË°åBeanÁöÑinitÊñπÊ≥ï
AbstractBeanFactory-->>DefaultListableBeanFactory: ËøîÂõûÊúÄÁªàÂàõÂª∫ÁöÑBean

~~~

#### @BeanÈîÄÊØÅÊñπÊ≥ïÊó∂Â∫èÂõæ

~~~mermaid
sequenceDiagram
Title: @BeanÈîÄÊØÅÊñπÊ≥ïÊó∂Â∫èÂõæ
BeanApplication->>AnnotationConfigApplicationContext: AnnotationConfigApplicationContext(componentClasses)<br>ÂàõÂª∫Â∫îÁî®‰∏ä‰∏ãÊñá
AnnotationConfigApplicationContext-->>BeanApplication: Â∫îÁî®‰∏ä‰∏ãÊñáÂàùÂßãÂåñÂÆåÊàêÂπ∂ËøîÂõûÂ∫îÁî®
BeanApplication->>AbstractApplicationContext: close()<br>ËØ∑Ê±ÇÂÖ≥Èó≠Â∫îÁî®‰∏ä‰∏ãÊñá
AbstractApplicationContext->>AbstractApplicationContext: doClose()<br>ÊâßË°åÂÖ≥Èó≠Êìç‰Ωú
AbstractApplicationContext->>AbstractApplicationContext: destroyBeans()<br>ÈîÄÊØÅÂÆπÂô®‰∏≠ÁöÑÊâÄÊúâBeans
AbstractApplicationContext->>DefaultListableBeanFactory: destroySingletons()<br>ÈîÄÊØÅÊâÄÊúâÂçï‰æãBeans
DefaultListableBeanFactory->>DefaultSingletonBeanRegistry: super.destroySingletons()<br>Ë∞ÉÁî®Áà∂Á±ªÊñπÊ≥ïÔºåÈîÄÊØÅÊâÄÊúâÂçï‰æãBeans
DefaultSingletonBeanRegistry->>DefaultSingletonBeanRegistry: destroySingleton(beanName)<br>ÈîÄÊØÅÊåáÂÆöÂêçÁß∞ÁöÑÂçï‰æãBean
DefaultSingletonBeanRegistry->>DefaultSingletonBeanRegistry: destroyBean(beanName,bean)<br>ÊâßË°åBeanÁöÑÈîÄÊØÅÈÄªËæë
DefaultSingletonBeanRegistry->>DisposableBeanAdapter: destroy()<br>Ë∞ÉÁî®BeanÁöÑÈîÄÊØÅÊñπÊ≥ï
DisposableBeanAdapter->>DisposableBeanAdapter: invokeCustomDestroyMethod(destroyMethod)<br>Ë∞ÉÁî®Ëá™ÂÆö‰πâÁöÑÈîÄÊØÅÊñπÊ≥ï
DisposableBeanAdapter->>Method: invoke(this.bean, args)<br>ÂèçÂ∞ÑË∞ÉÁî®BeanÁöÑÈîÄÊØÅÊñπÊ≥ï
Method->>MyBean: destroy()<br>ÊâßË°åBeanÁöÑdestroyÊñπÊ≥ï
~~~

### ‰∏É„ÄÅÊ∫êÁ†ÅÂàÜÊûê

#### @BeanÊ≥®ÂÜåÊ∫êÁ†ÅÂàÜÊûê

È¶ñÂÖàÊù•ÁúãÁúãÂêØÂä®Á±ªÂÖ•Âè£Ôºå‰∏ä‰∏ãÊñáÁéØÂ¢É‰ΩøÁî®`AnnotationConfigApplicationContext`ÔºàÊ≠§Á±ªÊòØ‰ΩøÁî®JavaÊ≥®Ëß£Êù•ÈÖçÁΩÆSpringÂÆπÂô®ÁöÑÊñπÂºèÔºâÔºåÊûÑÈÄ†ÂèÇÊï∞Êàë‰ª¨ÁªôÂÆö‰∫Ü‰∏Ä‰∏™`MyConfiguration`ÁªÑ‰ª∂Á±ª„ÄÇÁÑ∂Âêé‰ªéSpring‰∏ä‰∏ãÊñá‰∏≠Ëé∑Âèñ‰∏Ä‰∏™`MyBean`Á±ªÂûãÁöÑbeanÔºåÊúÄÂêéË∞ÉÁî®`context.close()`ÊñπÊ≥ïÂÖ≥Èó≠ÂÆπÂô®„ÄÇ

```java
public class BeanApplication {

    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(MyConfiguration.class);
        System.out.println(context.getBean(MyBean.class));
        context.close();
    }
}
```

Âú®`org.springframework.context.annotation.AnnotationConfigApplicationContext#AnnotationConfigApplicationContext`ÊûÑÈÄ†ÂáΩÊï∞‰∏≠ÔºåÊâßË°å‰∫Ü‰∏â‰∏™Ê≠•È™§ÔºåÊàë‰ª¨ÈáçÁÇπÂÖ≥Ê≥®`refresh()`ÊñπÊ≥ï„ÄÇ

```java
public AnnotationConfigApplicationContext(Class<?>... componentClasses) {
    this();
    register(componentClasses);
    refresh();
}
```

Âú®`org.springframework.context.support.AbstractApplicationContext#refresh`ÊñπÊ≥ï‰∏≠Êàë‰ª¨ÈáçÁÇπÂÖ≥Ê≥®‰∏Ä‰∏ã`finishBeanFactoryInitialization(beanFactory)`ËøôÊñπÊ≥ï‰ºöÂØπÂÆû‰æãÂåñÊâÄÊúâÂâ©‰ΩôÈùûÊáíÂä†ËΩΩÁöÑÂçïÂàóBeanÂØπË±°ÔºåÂÖ∂‰ªñÊñπÊ≥ï‰∏çÊòØÊú¨Ê¨°Ê∫êÁ†ÅÈòÖËØªÁöÑÈáçÁÇπÊöÇÊó∂ÂøΩÁï•„ÄÇ

```java
@Override
public void refresh() throws BeansException, IllegalStateException {
     // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
     // Ë∞ÉÁî®Âú®‰∏ä‰∏ãÊñá‰∏≠Ê≥®ÂÜå‰∏∫beanÁöÑÂ∑•ÂéÇÂ§ÑÁêÜÂô®
     invokeBeanFactoryPostProcessors(beanFactory);
     // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.context.support.AbstractApplicationContext#invokeBeanFactoryPostProcessors`ÊñπÊ≥ï‰∏≠ÔºåÂèàÂßîÊâò‰∫Ü`PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors()`ËøõË°åË∞ÉÁî®„ÄÇ

```java
protected void invokeBeanFactoryPostProcessors(ConfigurableListableBeanFactory beanFactory) {
    PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors(beanFactory, getBeanFactoryPostProcessors());
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.context.support.PostProcessorRegistrationDelegate#invokeBeanFactoryPostProcessors`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàË∞ÉÁî®‰∫Ü `BeanDefinitionRegistryPostProcessor`ÔºàËøôÊòØ `BeanFactoryPostProcessor` ÁöÑÂ≠êÊé•Âè£Ôºâ„ÄÇÂÆÉ‰∏ìÈó®Áî®Êù•Âú®ÊâÄÊúâÂÖ∂‰ªñ bean ÂÆö‰πâÂä†ËΩΩ‰πãÂâç‰øÆÊîπÈªòËÆ§ÁöÑ bean ÂÆö‰πâ„ÄÇ

```java
public static void invokeBeanFactoryPostProcessors(
        ConfigurableListableBeanFactory beanFactory, List<BeanFactoryPostProcessor> beanFactoryPostProcessors) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    invokeBeanDefinitionRegistryPostProcessors(currentRegistryProcessors, registry, beanFactory.getApplicationStartup());
	// ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.context.support.PostProcessorRegistrationDelegate#invokeBeanDefinitionRegistryPostProcessors`ÊñπÊ≥ï‰∏≠ÔºåÂæ™ÁéØË∞ÉÁî®‰∫ÜÂÆûÁé∞`BeanDefinitionRegistryPostProcessor`Êé•Âè£‰∏≠ÁöÑ`postProcessBeanDefinitionRegistry(registry)`ÊñπÊ≥ï

```java
private static void invokeBeanDefinitionRegistryPostProcessors(
			Collection<? extends BeanDefinitionRegistryPostProcessor> postProcessors, BeanDefinitionRegistry registry, ApplicationStartup applicationStartup) {

    for (BeanDefinitionRegistryPostProcessor postProcessor : postProcessors) {
        StartupStep postProcessBeanDefRegistry = applicationStartup.start("spring.context.beandef-registry.post-process")
            .tag("postProcessor", postProcessor::toString);
        postProcessor.postProcessBeanDefinitionRegistry(registry);
        postProcessBeanDefRegistry.end();
    }
}
```

Âú®`org.springframework.context.annotation.ConfigurationClassPostProcessor#postProcessBeanDefinitionRegistry`ÊñπÊ≥ï‰∏≠ÔºåË∞ÉÁî®‰∫Ü`processConfigBeanDefinitions`ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïÁöÑ‰∏ªË¶ÅÁõÆÁöÑÊòØÂ§ÑÁêÜÂíåÊ≥®ÂÜåÈÖçÁΩÆÁ±ª‰∏≠ÂÆö‰πâÁöÑbeans„ÄÇ

```java
@Override
public void postProcessBeanDefinitionRegistry(BeanDefinitionRegistry registry) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    processConfigBeanDefinitions(registry);
}
```

Âú®`org.springframework.context.annotation.ConfigurationClassPostProcessor#processConfigBeanDefinitions`ÊñπÊ≥ï‰∏≠ÔºåËøô‰∏™ÊñπÊ≥ï‰∏ªË¶ÅÂ§ÑÁêÜ‰∫ÜÈÖçÁΩÆÁ±ªÁöÑËß£ÊûêÂíåÈ™åËØÅÔºåÂπ∂Á°Æ‰øù‰∫ÜÊâÄÊúâÂú®ÈÖçÁΩÆÁ±ª‰∏≠ÂÆö‰πâÁöÑbeansÈÉΩË¢´Ê≠£Á°ÆÂú∞Ê≥®ÂÜåÂà∞SpringÁöÑbeanÂÆö‰πâÊ≥®ÂÜåË°®‰∏≠„ÄÇ

```java
public void processConfigBeanDefinitions(BeanDefinitionRegistry registry) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // Ê≠•È™§1ÔºöÂàõÂª∫‰∏Ä‰∏™Áî®‰∫éËß£ÊûêÈÖçÁΩÆÁ±ªÁöÑËß£ÊûêÂô®
    ConfigurationClassParser parser = new ConfigurationClassParser(
            this.metadataReaderFactory, this.problemReporter, this.environment,
            this.resourceLoader, this.componentScanBeanNameGenerator, registry);

    // Ê≠•È™§2ÔºöÂàùÂßãÂåñÂÄôÈÄâÈÖçÁΩÆÁ±ªÈõÜÂêà‰ª•ÂèäÂ∑≤Ëß£ÊûêÈÖçÁΩÆÁ±ªÈõÜÂêà
    Set<BeanDefinitionHolder> candidates = new LinkedHashSet<>(configCandidates);
    Set<ConfigurationClass> alreadyParsed = new HashSet<>(configCandidates.size());

    // Ê≠•È™§3ÔºöÂæ™ÁéØÂ§ÑÁêÜÊâÄÊúâÂÄôÈÄâÈÖçÁΩÆÁ±ªÔºåÁõ¥Ëá≥Ê≤°ÊúâÂÄôÈÄâÁ±ª‰∏∫Ê≠¢
    do {
        // Ê≠•È™§3.1 Ëß£ÊûêÈÖçÁΩÆÁ±ª
        parser.parse(candidates);
        // Ê≠•È™§3.2 È™åËØÅÈÖçÁΩÆÁ±ª
        parser.validate();

        // Ëé∑ÂèñËß£ÊûêÂêéÁöÑÈÖçÁΩÆÁ±ªÔºåÂπ∂‰ªé‰∏≠ÁßªÈô§Â∑≤ÁªèÂ§ÑÁêÜËøáÁöÑ
        Set<ConfigurationClass> configClasses = new LinkedHashSet<>(parser.getConfigurationClasses());
        configClasses.removeAll(alreadyParsed);

        // Ê≠•È™§4ÔºöÂ¶ÇÊûúreader‰∏∫Á©∫ÔºåÂàôÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑBeanÂÆö‰πâËØªÂèñÂô®
        if (this.reader == null) {
            this.reader = new ConfigurationClassBeanDefinitionReader(
                    registry, this.sourceExtractor, this.resourceLoader, this.environment,
                    this.importBeanNameGenerator, parser.getImportRegistry());
        }

        // Ê≠•È™§5Ôºö‰ΩøÁî®ËØªÂèñÂô®‰∏∫Ëß£ÊûêÁöÑÈÖçÁΩÆÁ±ªÂä†ËΩΩBeanÂÆö‰πâ
        this.reader.loadBeanDefinitions(configClasses);

        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
        
    } while (!candidates.isEmpty());

    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Êàë‰ª¨Êù•Âà∞`org.springframework.context.annotation.ConfigurationClassPostProcessor#processConfigBeanDefinitions`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§3.1„ÄÇÂú®`org.springframework.context.annotation.ConfigurationClassParser#parse`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÊòØÈÅçÂéÜÊâÄÊúâÁöÑÈÖçÁΩÆÁ±ªÂÄôÈÄâËÄÖÔºåÂπ∂ÂØπÊØè‰∏Ä‰∏™Â∏¶ÊúâÊ≥®Ëß£ÁöÑBeanÂÆö‰πâËøõË°åËß£Êûê„ÄÇËøôÈÄöÂ∏∏Ê∂âÂèäÂà∞Êü•ÊâæËØ•ÈÖçÁΩÆÁ±ª‰∏≠ÁöÑ@BeanÊñπÊ≥ï„ÄÅÁªÑ‰ª∂Êâ´ÊèèÊåá‰ª§Á≠âÔºåÂπ∂Â∞ÜËøô‰∫õ‰ø°ÊÅØÊ≥®ÂÜåÂà∞SpringÂÆπÂô®‰∏≠„ÄÇ

```java
public void parse(Set<BeanDefinitionHolder> configCandidates) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    parse(((AnnotatedBeanDefinition) bd).getMetadata(), holder.getBeanName());
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.context.annotation.ConfigurationClassParser#parse(metadata, beanName)`ÊñπÊ≥ï‰∏≠ÔºåÂ∞ÜÊ≥®Ëß£ÂÖÉÊï∞ÊçÆÂíåBeanÂêçÁß∞ËΩ¨Âåñ‰∏∫‰∏Ä‰∏™ÈÖçÁΩÆÁ±ªÔºåÁÑ∂ÂêéÂØπÂÖ∂ËøõË°åÂ§ÑÁêÜ„ÄÇÂ§ÑÁêÜÈÖçÁΩÆÁ±ªÊòØSpringÈÖçÁΩÆÈ©±Âä®ÁöÑÊ†∏ÂøÉÔºåÂÆÉÊ∂âÂèäÂà∞ËÆ∏Â§öÂÖ≥ÈîÆÊìç‰ΩúÔºåÂ¶ÇËß£Êûê@BeanÊñπÊ≥ï„ÄÅÂ§ÑÁêÜ@ComponentScanÊ≥®Ëß£„ÄÅÂ§ÑÁêÜ@ImportÊ≥®Ëß£Á≠â„ÄÇ

```java
protected final void parse(AnnotationMetadata metadata, String beanName) throws IOException {
    processConfigurationClass(new ConfigurationClass(metadata, beanName), DEFAULT_EXCLUSION_FILTER);
}
```

Âú®`org.springframework.context.annotation.ConfigurationClassParser#processConfigurationClass`ÊñπÊ≥ï‰∏≠ÔºåÂ§ÑÁêÜ‰∏Ä‰∏™ÁªôÂÆöÁöÑÈÖçÁΩÆÁ±ª„ÄÇÂÆÉÈ¶ñÂÖàÈÄíÂΩíÂú∞Â§ÑÁêÜÈÖçÁΩÆÁ±ªÂèäÂÖ∂Áà∂Á±ªÔºå‰ª•Á°Æ‰øùÊâÄÊúâÁõ∏ÂÖ≥ÁöÑÈÖçÁΩÆÈÉΩË¢´Ê≠£Á°ÆÂú∞ËØªÂèñÂπ∂Ëß£Êûê„ÄÇÂú®ÈÄíÂΩíÂ§ÑÁêÜÂÆåÊâÄÊúâÁõ∏ÂÖ≥ÈÖçÁΩÆÂêéÔºåÂÆÉÂ∞ÜÈÖçÁΩÆÁ±ªÊ∑ªÂä†Âà∞Â∑≤Ëß£ÊûêÁöÑÈÖçÁΩÆÁ±ªÁöÑÊò†Â∞Ñ‰∏≠„ÄÇ

```java
protected void processConfigurationClass(ConfigurationClass configClass, Predicate<String> filter) throws IOException {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // Ê≠•È™§1ÔºöÈÄíÂΩíÂú∞Â§ÑÁêÜÈÖçÁΩÆÁ±ªÂèäÂÖ∂Ë∂ÖÁ±ªÂ±ÇÊ¨°ÁªìÊûÑ
    SourceClass sourceClass = asSourceClass(configClass, filter);
    do {
        sourceClass = doProcessConfigurationClass(configClass, sourceClass, filter);
    } while (sourceClass != null);

    // Ê≠•È™§2ÔºöÂ∞ÜÂ§ÑÁêÜÂêéÁöÑÈÖçÁΩÆÁ±ªÊîæÂÖ•Êò†Â∞Ñ‰∏≠
    this.configurationClasses.put(configClass, configClass);
}
```

Âú®`org.springframework.context.annotation.ConfigurationClassParser#doProcessConfigurationClass`ÊñπÊ≥ï‰∏≠ÔºåËøõ‰∏ÄÊ≠•Â§ÑÁêÜÈÖçÁΩÆÁ±ª„ÄÇÁâπÂà´ÊòØÔºåÂÆÉÂ§ÑÁêÜÈÖçÁΩÆÁ±ª‰∏≠ÊâÄÊúâÂ∏¶Êúâ@BeanÊ≥®Ëß£ÁöÑÊñπÊ≥ï„ÄÇËøô‰∫õÊñπÊ≥ïÂÆö‰πâ‰∫ÜÂ¶Ç‰ΩïÂú®SpringÂ∫îÁî®Á®ãÂ∫è‰∏ä‰∏ãÊñá‰∏≠ÂàùÂßãÂåñbean„ÄÇËøôÈáåÁÆÄÂåñÁöÑÊ≥®ÈáäÈáçÁÇπÊîæÂú®@BeanÊñπÊ≥ï‰∏äÔºå‰ΩÜÂéüÊñπÊ≥ïÂèØËÉΩËøòÂåÖÂê´ÂÖ∂‰ªñÈáçË¶ÅÁöÑÂ§ÑÁêÜÈÄªËæë„ÄÇ

```java
@Nullable
protected final SourceClass doProcessConfigurationClass(
    ConfigurationClass configClass, SourceClass sourceClass, Predicate<String> filter)
    throws IOException {

    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    
    // Â§ÑÁêÜÈÖçÁΩÆÁ±ª‰∏≠ÁöÑÊØè‰∏Ä‰∏™@BeanÊ≥®Ëß£ÁöÑÊñπÊ≥ï
    // ËøôÈáåÁöÑÁõÆÊ†áÊòØËØÜÂà´ÂíåÊ≥®ÂÜåÈÖçÁΩÆÁ±ª‰∏≠ÂÆö‰πâÁöÑÊâÄÊúâ@BeanÊñπÊ≥ï„ÄÇËøô‰∫õÊñπÊ≥ïÂÆö‰πâ‰∫ÜÂ¶Ç‰ΩïÂàùÂßãÂåñÂ∫îÁî®Á®ãÂ∫è‰∏≠ÁöÑbean„ÄÇ
    Set<MethodMetadata> beanMethods = retrieveBeanMethodMetadata(sourceClass);
    for (MethodMetadata methodMetadata : beanMethods) {
        configClass.addBeanMethod(new BeanMethod(methodMetadata, configClass));
    }

    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    return null;
}
```

Âú®`org.springframework.context.annotation.ConfigurationClassParser#retrieveBeanMethodMetadata`ÊñπÊ≥ï‰∏≠ÔºåÁªà‰∫éÁúãÂà∞ÂØπ`@Bean`Ê≥®Ëß£ÁöÑËß£ÊûêËøáÁ®ã‰∫ÜÔºåÈ¶ñÂÖàÊòØÂ∞ùËØï‰ΩøÁî®ASMËé∑ÂèñÁ°ÆÂÆöÁöÑÊñπÊ≥ïÈ°∫Â∫èÔºåËøô‰∏ÄÊ≠•ÊòØÂõ†‰∏∫JavaÂèçÂ∞ÑAPIËøîÂõûÁöÑÊñπÊ≥ïÈ°∫Â∫èÊòØ‰∏çÁ°ÆÂÆöÁöÑÔºå‰ΩÜÂú®Êüê‰∫õÂú∫ÊôØ‰∏ãÔºåÊñπÊ≥ïÁöÑÂ£∞ÊòéÈ°∫Â∫èÂèØËÉΩÊòØÈáçË¶ÅÁöÑ„ÄÇ‰∏∫‰∫ÜËé∑Âæó‰∏Ä‰∏™Á°ÆÂÆöÁöÑÈ°∫Â∫èÔºåÊàë‰ª¨Â∞ùËØï‰ΩøÁî®ASMÔºà‰∏Ä‰∏™JavaÂ≠óËäÇÁ†ÅÂ§ÑÁêÜÊ°ÜÊû∂ÔºâÊù•ËØªÂèñÁ±ªÊñá‰ª∂„ÄÇÂÖ∂Ê¨°ÊòØÊØîËæÉÂèçÂ∞ÑÂíåASMÁöÑÁªìÊûúÔºåÂ¶ÇÊûúÈÄöËøáASMËé∑ÂèñÂà∞ÁöÑÊñπÊ≥ïÊï∞Â§ß‰∫éÊàñÁ≠â‰∫éÈÄöËøáÂèçÂ∞ÑËé∑ÂèñÁöÑÊñπÊ≥ïÊï∞ÔºåÈÇ£‰πàÊàë‰ª¨‰ºöËøõ‰∏ÄÊ≠•ÊØîËæÉËøô‰∏§‰∏™ÈõÜÂêà„ÄÇÂ¶ÇÊûúËøô‰∏§‰∏™ÈõÜÂêàÁöÑÊñπÊ≥ïÂêçÁõ∏ÂåπÈÖçÔºåÊàë‰ª¨‰ºöÊõ¥ÂÄæÂêë‰∫é‰ΩøÁî®ASMÁöÑÁªìÊûúÔºåÂõ†‰∏∫ÂÆÉÊèê‰æõ‰∫ÜÁ°ÆÂÆöÁöÑÊñπÊ≥ïÈ°∫Â∫è„ÄÇÊúÄÂêéÔºåÊñπÊ≥ïËøîÂõû‰∏Ä‰∏™`Set<MethodMetadata>`ÔºåË°®Á§∫ÊâæÂà∞ÁöÑÊâÄÊúâÊ†áÊ≥®‰∫Ü@BeanÁöÑÊñπÊ≥ï„ÄÇ

**‰∏∫‰ªÄ‰πàË¶ÅÂÖ≥ÂøÉÊñπÊ≥ïÁöÑÈ°∫Â∫è?** Âú®Êüê‰∫õÊÉÖÂÜµ‰∏ãÔºåÊàë‰ª¨ÂèØËÉΩÊúüÊúõ@BeanÊñπÊ≥ïÊåâÁÖßÂÆÉ‰ª¨Âú®Á±ª‰∏≠ÁöÑÂ£∞ÊòéÈ°∫Â∫èÊâßË°å„ÄÇËôΩÁÑ∂ËøôÁßç‰æùËµñÈÄöÂ∏∏Â∫îËØ•ÈÅøÂÖçÔºå‰ΩÜSpringËøòÊòØÂ∞ΩÂèØËÉΩÂú∞Ê†πÊçÆÊàë‰ª¨Â£∞ÊòéÁöÑËøôÁßçÈ°∫Â∫èÔºåÁâπÂà´ÊòØÂú®Ê∂âÂèäÁîüÂëΩÂë®ÊúüÂõûË∞ÉÂíå‰æùËµñÊ≥®ÂÖ•Êó∂„ÄÇ

```java
private Set<MethodMetadata> retrieveBeanMethodMetadata(SourceClass sourceClass) {
    // ‰ªéÊ∫êÁ±ª‰∏≠Ëé∑ÂèñÂÖ∂Ê≥®Ëß£ÂÖÉÊï∞ÊçÆ
    AnnotationMetadata original = sourceClass.getMetadata();
    
    // ‰ªéÊ≥®Ëß£ÂÖÉÊï∞ÊçÆ‰∏≠Ëé∑ÂèñÊâÄÊúâÂ∏¶Êúâ@BeanÊ≥®Ëß£ÁöÑÊñπÊ≥ï
    Set<MethodMetadata> beanMethods = original.getAnnotatedMethods(Bean.class.getName());

    // Â¶ÇÊûúÂèëÁé∞Â§ö‰∏™@BeanÊñπÊ≥ïÔºåÂπ∂‰∏îÊ≥®Ëß£ÂÖÉÊï∞ÊçÆÊòØStandardAnnotationMetadataÁöÑÂÆû‰æãÔºå
    // ÂàôÂ∞ùËØï‰ΩøÁî®ASMÂ∫ìËØªÂèñÁ±ªÊñá‰ª∂Ôºå‰ª•Ëé∑ÂèñÁ°ÆÂÆöÁöÑÊñπÊ≥ïÂ£∞ÊòéÈ°∫Â∫è„ÄÇ
    if (beanMethods.size() > 1 && original instanceof StandardAnnotationMetadata) {
        try {
            // ‰ΩøÁî®ASMËØªÂèñÁ±ªÊñá‰ª∂ÁöÑÂÖÉÊï∞ÊçÆ
            AnnotationMetadata asm =
                this.metadataReaderFactory.getMetadataReader(original.getClassName()).getAnnotationMetadata();
            Set<MethodMetadata> asmMethods = asm.getAnnotatedMethods(Bean.class.getName());

            // Ê£ÄÊü•ASMËØªÂèñÁöÑÊñπÊ≥ïÈõÜÊòØÂê¶ÂåÖÂê´ÊâÄÊúâÈÄöËøáÊ†áÂáÜÂèçÂ∞ÑÊ£ÄÊµãÂà∞ÁöÑÊñπÊ≥ï
            if (asmMethods.size() >= beanMethods.size()) {
                Set<MethodMetadata> selectedMethods = new LinkedHashSet<>(asmMethods.size());
                for (MethodMetadata asmMethod : asmMethods) {
                    for (MethodMetadata beanMethod : beanMethods) {
                        if (beanMethod.getMethodName().equals(asmMethod.getMethodName())) {
                            selectedMethods.add(beanMethod);
                            break;
                        }
                    }
                }
                if (selectedMethods.size() == beanMethods.size()) {
                    // ÊâÄÊúâÈÄöËøáÂèçÂ∞ÑÊ£ÄÊµãÂà∞ÁöÑÊñπÊ≥ïÈÉΩÂú®ASMÊñπÊ≥ïÈõÜ‰∏≠ÔºåÂõ†Ê≠§‰ΩøÁî®ASMÊñπÊ≥ïÈõÜ
                    beanMethods = selectedMethods;
                }
            }
        }
        catch (IOException ex) {
            // Â¶ÇÊûú‰ΩøÁî®ASMËØªÂèñÁ±ªÊñá‰ª∂Êó∂ÂèëÁîüÈîôËØØÔºåËÆ∞ÂΩïÈîôËØØ‰ø°ÊÅØÔºåÂπ∂ÁªßÁª≠‰ΩøÁî®ÂèçÂ∞ÑÂÖÉÊï∞ÊçÆ
            logger.debug("Failed to read class file via ASM for determining @Bean method order", ex);
        }
    }

    // ËøîÂõûÊ£ÄÁ¥¢Âà∞ÁöÑ@BeanÊñπÊ≥ïÈõÜ
    return beanMethods;
}
```

‰∏äÈù¢ÊòØÊ≠•È™§3.1ÂØπ`@Bean`ÊñπÊ≥ïËøõË°åÊâ´ÊèèÔºåÂπ∂Â∞ÜÊâ´ÊèèÁªìÊûúÂ≠òÂÇ®Âú®`ConfigurationClass`Á±ª‰∏≠ÁöÑ`beanMethods`Â≠óÊÆµ‰∏≠„ÄÇ

Êàë‰ª¨Êù•Âà∞`org.springframework.context.annotation.ConfigurationClassPostProcessor#processConfigBeanDefinitions`ÊñπÊ≥ï‰∏≠ÁöÑÊ≠•È™§4„ÄÇÂú®`org.springframework.context.annotation.ConfigurationClassBeanDefinitionReader#loadBeanDefinitions`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàËÆæÁΩÆ‰∫Ü‰∏Ä‰∏™Ë∑üË∏™Êù°‰ª∂ËØÑ‰º∞ÁöÑÂ∑•ÂÖ∑ÔºåÁÑ∂ÂêéÈÅçÂéÜÊØè‰∏Ä‰∏™ÈÖçÁΩÆÁ±ªÔºå‰∏∫ÊØè‰∏Ä‰∏™ÈÖçÁΩÆÁ±ªÂä†ËΩΩbeanÂÆö‰πâ„ÄÇËøôÊòØSpring JavaÈÖçÁΩÆÊñπÂºèÁöÑÊ†∏ÂøÉËøáÁ®ãÔºåÁ°Æ‰øù`@Bean`ÊñπÊ≥ïË¢´Ê≠£Á°ÆÂú∞Ëß£ÊûêÂπ∂Âú®ÂÆπÂô®‰∏≠Ê≥®ÂÜå‰∏∫bean„ÄÇ

```java
public void loadBeanDefinitions(Set<ConfigurationClass> configurationModel) {
    TrackedConditionEvaluator trackedConditionEvaluator = new TrackedConditionEvaluator();
    for (ConfigurationClass configClass : configurationModel) {
        loadBeanDefinitionsForConfigurationClass(configClass, trackedConditionEvaluator);
    }
}
```

Âú®`org.springframework.context.annotation.ConfigurationClassBeanDefinitionReader#loadBeanDefinitionsForConfigurationClass`ÊñπÊ≥ï‰∏≠ÔºåÂØπ‰∫éÊØè‰∏Ä‰∏™`BeanMethod`ÔºåË∞ÉÁî®‰∫Ü`loadBeanDefinitionsForBeanMethod`ÊñπÊ≥ï„ÄÇËøô‰∏™ÊñπÊ≥ï‰ºöÈíàÂØπÂçï‰∏™@BeanÊñπÊ≥ïËøõË°åËß£ÊûêÔºåÂπ∂Â∞ÜÂÖ∂ËΩ¨Êç¢‰∏∫‰∏Ä‰∏™Spring IoCÂÆπÂô®ÂèØ‰ª•ÁÆ°ÁêÜÁöÑBeanÂÆö‰πâ„ÄÇ

```java
private void loadBeanDefinitionsForConfigurationClass(
			ConfigurationClass configClass, TrackedConditionEvaluator trackedConditionEvaluator) {

    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    for (BeanMethod beanMethod : configClass.getBeanMethods()) {
        loadBeanDefinitionsForBeanMethod(beanMethod);
    }
	// ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.context.annotation.ConfigurationClassBeanDefinitionReader#loadBeanDefinitionsForBeanMethod`ÊñπÊ≥ï‰∏≠ÔºåÂ¶ÇÊûú@BeanÊñπÊ≥ïÊòØÈùôÊÄÅÁöÑÔºåÈÇ£‰πàÂÆÉÁõ¥Êé•‰ΩøÁî®ÊñπÊ≥ïÊâÄÂú®Á±ª‰Ωú‰∏∫beanÁöÑÁ±ª„ÄÇÂê¶ÂàôÔºåÂÆÉ‰ΩøÁî®ÈÖçÁΩÆÁ±ªÁöÑbeanÂêçÁß∞‰Ωú‰∏∫Â∑•ÂéÇbeanÂêçÔºåÂπ∂ËÆæÁΩÆÂ∑•ÂéÇÊñπÊ≥ïÂêç‰∏∫ÂΩìÂâç@BeanÊñπÊ≥ïÁöÑÂêçÂ≠óÔºåÁÑ∂ÂêéÂ∞ùËØïËé∑ÂèñÊõ¥ËØ¶ÁªÜÁöÑÊñπÊ≥ïÂÖÉÊï∞ÊçÆÔºåÁâπÂà´ÊòØÂ¶ÇÊûúÂÖÉÊï∞ÊçÆÊòØ`StandardMethodMetadata`Á±ªÂûãÁöÑÔºåÂÆÉÂèØ‰ª•Áõ¥Êé•Ëé∑ÂèñÂéüÂßãÊñπÊ≥ïÂØπË±°ÔºåÁÑ∂ÂêéËøòË¶ÅÂ§ÑÁêÜ`autowire`, `autowireCandidate`, `initMethod`, Âíå`destroyMethod`Á≠âÂ±ûÊÄßÔºåËøô‰∫õÂ±ûÊÄßÊèê‰æõ‰∫ÜÊúâÂÖ≥Â¶Ç‰ΩïÂ§ÑÁêÜbeanÁîüÂëΩÂë®ÊúüÂíå‰æùËµñÊ≥®ÂÖ•ÁöÑ‰ø°ÊÅØ„ÄÇÁÑ∂ÂêéÂ¶ÇÊûú@BeanÊñπÊ≥ïÊúâ`@Scope`Ê≥®Ëß£ÔºåÂÆÉ‰ºöÂ§ÑÁêÜËøô‰∏™Ê≥®Ëß£ÁöÑÂ±ûÊÄßÔºåÂ¶Ç‰ΩúÁî®ÂüüÂêçÂíå‰ª£ÁêÜÊ®°ÂºèÔºåÁÑ∂ÂêéÈúÄË¶Å‰∏∫Ëøô‰∏™beanÂàõÂª∫‰∏Ä‰∏™‰ª£ÁêÜÔºåÊúÄÂêéÔºå‰ΩøÁî®`registerBeanDefinition`ÊñπÊ≥ïÂ∞ÜBeanÂÆö‰πâÊ≥®ÂÜåÂà∞IoCÂÆπÂô®‰∏≠„ÄÇ

```java
private void loadBeanDefinitionsForBeanMethod(BeanMethod beanMethod) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑBeanÂÆö‰πâÂü∫‰∫é@BeanÊñπÊ≥ïÁöÑÂÖÉÊï∞ÊçÆ
    ConfigurationClassBeanDefinition beanDef = new ConfigurationClassBeanDefinition(configClass, metadata, beanName);

    // ËÆæÁΩÆBeanÂÆö‰πâÁöÑÊù•Ê∫ê‰ø°ÊÅØ
    beanDef.setSource(this.sourceExtractor.extractSource(metadata, configClass.getResource()));

    // Ê£ÄÊü•@BeanÊñπÊ≥ïÊòØÂê¶‰∏∫ÈùôÊÄÅÊñπÊ≥ï
    if (metadata.isStatic()) {
        // Â§ÑÁêÜÈùôÊÄÅ@BeanÊñπÊ≥ï
        if (configClass.getMetadata() instanceof StandardAnnotationMetadata) {
            beanDef.setBeanClass(((StandardAnnotationMetadata) configClass.getMetadata()).getIntrospectedClass());
        }
        else {
            beanDef.setBeanClassName(configClass.getMetadata().getClassName());
        }
        beanDef.setUniqueFactoryMethodName(methodName);
    }
    else {
        // Â§ÑÁêÜÂÆû‰æã@BeanÊñπÊ≥ï
        beanDef.setFactoryBeanName(configClass.getBeanName());
        beanDef.setUniqueFactoryMethodName(methodName);
    }

    // Â¶ÇÊûúÂÖÉÊï∞ÊçÆÊòØStandardMethodMetadataÁ±ªÂûãÁöÑÔºåËÆæÁΩÆÂ∑≤Ëß£ÊûêÁöÑÂ∑•ÂéÇÊñπÊ≥ï
    if (metadata instanceof StandardMethodMetadata) {
        beanDef.setResolvedFactoryMethod(((StandardMethodMetadata) metadata).getIntrospectedMethod());
    }

    // ËÆæÁΩÆËá™Âä®Ë£ÖÈÖçÊ®°Âºè‰∏∫ÊûÑÈÄ†Âô®Ëá™Âä®Ë£ÖÈÖç
    beanDef.setAutowireMode(AbstractBeanDefinition.AUTOWIRE_CONSTRUCTOR);
    beanDef.setAttribute(org.springframework.beans.factory.annotation.RequiredAnnotationBeanPostProcessor.
                         SKIP_REQUIRED_CHECK_ATTRIBUTE, Boolean.TRUE);

    // Â§ÑÁêÜBeanÂÆö‰πâÁöÑÈÄöÁî®Ê≥®Ëß£Â±ûÊÄß
    AnnotationConfigUtils.processCommonDefinitionAnnotations(beanDef, metadata);

    // Ëé∑ÂèñÂπ∂ËÆæÁΩÆautowireÂ±ûÊÄß
    Autowire autowire = bean.getEnum("autowire");
    if (autowire.isAutowire()) {
        beanDef.setAutowireMode(autowire.value());
    }

    // Ëé∑ÂèñÂπ∂ËÆæÁΩÆautowireCandidateÂ±ûÊÄß
    boolean autowireCandidate = bean.getBoolean("autowireCandidate");
    if (!autowireCandidate) {
        beanDef.setAutowireCandidate(false);
    }

    // Ëé∑ÂèñÂπ∂ËÆæÁΩÆÂàùÂßãÂåñÊñπÊ≥ïÂêç
    String initMethodName = bean.getString("initMethod");
    if (StringUtils.hasText(initMethodName)) {
        beanDef.setInitMethodName(initMethodName);
    }

    // Ëé∑ÂèñÂπ∂ËÆæÁΩÆÈîÄÊØÅÊñπÊ≥ïÂêç
    String destroyMethodName = bean.getString("destroyMethod");
    beanDef.setDestroyMethodName(destroyMethodName);

    // Ê†πÊçÆ@ScopeÊ≥®Ëß£Â§ÑÁêÜBeanÁöÑ‰ΩúÁî®ÂüüÂèäÂÖ∂‰ª£ÁêÜÊ®°Âºè
    ScopedProxyMode proxyMode = ScopedProxyMode.NO;
    AnnotationAttributes attributes = AnnotationConfigUtils.attributesFor(metadata, Scope.class);
    if (attributes != null) {
        beanDef.setScope(attributes.getString("value"));
        proxyMode = attributes.getEnum("proxyMode");
        if (proxyMode == ScopedProxyMode.DEFAULT) {
            proxyMode = ScopedProxyMode.NO;
        }
    }

    // Â¶ÇÊûúÈúÄË¶ÅÔºåÂàõÂª∫‰∏Ä‰∏™‰ª£ÁêÜÁöÑBeanÂÆö‰πâ
    BeanDefinition beanDefToRegister = beanDef;
    if (proxyMode != ScopedProxyMode.NO) {
        BeanDefinitionHolder proxyDef = ScopedProxyCreator.createScopedProxy(
            new BeanDefinitionHolder(beanDef, beanName), this.registry,
            proxyMode == ScopedProxyMode.TARGET_CLASS);
        beanDefToRegister = new ConfigurationClassBeanDefinition(
            (RootBeanDefinition) proxyDef.getBeanDefinition(), configClass, metadata, beanName);
    }

    // ÊúÄÁªàÂ∞Ü@BeanÊñπÊ≥ïÂØπÂ∫îÁöÑBeanÂÆö‰πâÊ≥®ÂÜåÂà∞ÂÆπÂô®
    this.registry.registerBeanDefinition(beanName, beanDefToRegister);
}
```

#### @BeanÂàùÂßãÂåñÊ∫êÁ†ÅÂàÜÊûê

È¶ñÂÖàÊù•ÁúãÁúãÂêØÂä®Á±ªÂÖ•Âè£Ôºå‰∏ä‰∏ãÊñáÁéØÂ¢É‰ΩøÁî®`AnnotationConfigApplicationContext`ÔºàÊ≠§Á±ªÊòØ‰ΩøÁî®JavaÊ≥®Ëß£Êù•ÈÖçÁΩÆSpringÂÆπÂô®ÁöÑÊñπÂºèÔºâÔºåÊûÑÈÄ†ÂèÇÊï∞Êàë‰ª¨ÁªôÂÆö‰∫Ü‰∏Ä‰∏™`MyConfiguration`ÁªÑ‰ª∂Á±ª„ÄÇÁÑ∂Âêé‰ªéSpring‰∏ä‰∏ãÊñá‰∏≠Ëé∑Âèñ‰∏Ä‰∏™`MyBean`Á±ªÂûãÁöÑbeanÔºåÊúÄÂêéË∞ÉÁî®`context.close()`ÊñπÊ≥ïÂÖ≥Èó≠ÂÆπÂô®„ÄÇ

```java
public class BeanApplication {

    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(MyConfiguration.class);
        System.out.println(context.getBean(MyBean.class));
        context.close();
    }
}
```

Âú®`org.springframework.context.annotation.AnnotationConfigApplicationContext#AnnotationConfigApplicationContext`ÊûÑÈÄ†ÂáΩÊï∞‰∏≠ÔºåÊâßË°å‰∫Ü‰∏â‰∏™Ê≠•È™§ÔºåÊàë‰ª¨ÈáçÁÇπÂÖ≥Ê≥®`refresh()`ÊñπÊ≥ï

```java
public AnnotationConfigApplicationContext(Class<?>... componentClasses) {
    this();
    register(componentClasses);
    refresh();
}
```

Âú®`org.springframework.context.support.AbstractApplicationContext#refresh`ÊñπÊ≥ï‰∏≠Êàë‰ª¨ÈáçÁÇπÂÖ≥Ê≥®‰∏Ä‰∏ã`finishBeanFactoryInitialization(beanFactory)`ËøôÊñπÊ≥ï‰ºöÂØπÂÆû‰æãÂåñÊâÄÊúâÂâ©‰ΩôÈùûÊáíÂä†ËΩΩÁöÑÂçïÂàóBeanÂØπË±°ÔºåÂÖ∂‰ªñÊñπÊ≥ï‰∏çÊòØÊú¨Ê¨°Ê∫êÁ†ÅÈòÖËØªÁöÑÈáçÁÇπÊöÇÊó∂ÂøΩÁï•„ÄÇ

```java
@Override
public void refresh() throws BeansException, IllegalStateException {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    // Instantiate all remaining (non-lazy-init) singletons.
    finishBeanFactoryInitialization(beanFactory);
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.context.support.AbstractApplicationContext#finishBeanFactoryInitialization`ÊñπÊ≥ï‰∏≠Ôºå‰ºöÁªßÁª≠Ë∞ÉÁî®`DefaultListableBeanFactory`Á±ª‰∏≠ÁöÑ`preInstantiateSingletons`ÊñπÊ≥ïÊù•ÂÆåÊàêÊâÄÊúâÂâ©‰ΩôÈùûÊáíÂä†ËΩΩÁöÑÂçïÂàóBeanÂØπË±°„ÄÇ

```java
/**
 * ÂÆåÊàêÊ≠§Â∑•ÂéÇÁöÑbeanÂàùÂßãÂåñÔºåÂÆû‰æãÂåñÊâÄÊúâÂâ©‰ΩôÁöÑÈùûÂª∂ËøüÂàùÂßãÂåñÂçï‰æãbean„ÄÇ
 * 
 * @param beanFactory Ë¶ÅÂàùÂßãÂåñÁöÑbeanÂ∑•ÂéÇ
 */
protected void finishBeanFactoryInitialization(ConfigurableListableBeanFactory beanFactory) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    // ÂÆåÊàêÊâÄÊúâÂâ©‰ΩôÈùûÊáíÂä†ËΩΩÁöÑÂçïÂàóBeanÂØπË±°„ÄÇ
    beanFactory.preInstantiateSingletons();
}
```

Âú®`org.springframework.beans.factory.support.DefaultListableBeanFactory#preInstantiateSingletons`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁöÑÊ†∏ÂøÉÁõÆÁöÑÊòØÈ¢ÑÂÖàÂÆû‰æãÂåñÊâÄÊúâÈùûÊáíÂä†ËΩΩÁöÑÂçï‰æãbean„ÄÇÂú®SpringÁöÑ‰∏ä‰∏ãÊñáÂàùÂßãÂåñÂÆåÊàêÂêéÔºåËØ•ÊñπÊ≥ï‰ºöË¢´Ëß¶ÂèëÔºå‰ª•Á°Æ‰øùÊâÄÊúâÂçï‰æãbeanÈÉΩË¢´Ê≠£Á°ÆÂú∞ÂàõÂª∫Âπ∂ÂàùÂßãÂåñ„ÄÇÂÖ∂‰∏≠`getBean(beanName)`ÊòØÊ≠§ÊñπÊ≥ïÁöÑÊ†∏ÂøÉÊìç‰Ωú„ÄÇÂØπ‰∫éÂÆπÂô®‰∏≠ÂÆö‰πâÁöÑÊØè‰∏Ä‰∏™Âçï‰æãbeanÔºåÂÆÉÈÉΩ‰ºöË∞ÉÁî®`getBean`ÊñπÊ≥ïÔºåËøôÂ∞ÜËß¶ÂèëbeanÁöÑÂÆû‰æãÂåñ„ÄÅÂàùÂßãÂåñÂèäÂÖ∂‰æùËµñÁöÑÊ≥®ÂÖ•„ÄÇÂ¶ÇÊûúbean‰πãÂâçÊ≤°ÊúâË¢´ÂàõÂª∫ËøáÔºåÈÇ£‰πàËøô‰∏™Ë∞ÉÁî®‰ºöÂØºËá¥ÂÖ∂Ë¢´ÂÆû‰æãÂåñÂíåÂàùÂßãÂåñ„ÄÇ

```java
public void preInstantiateSingletons() throws BeansException {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    // Âæ™ÁéØÈÅçÂéÜÊâÄÊúâbeanÁöÑÂêçÁß∞
    for (String beanName : beanNames) {
        getBean(beanName);
    }
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#getBean()`ÊñπÊ≥ï‰∏≠ÔºåÂèàË∞ÉÁî®‰∫Ü`doGetBean`ÊñπÊ≥ïÊù•ÂÆûÈôÖÊâßË°åÂàõÂª∫BeanÁöÑËøáÁ®ãÔºå‰º†ÈÄíÁªôÂÆÉbeanÁöÑÂêçÁß∞Âíå‰∏Ä‰∫õÂÖ∂‰ªñÈªòËÆ§ÁöÑÂèÇÊï∞ÂÄº„ÄÇÊ≠§Â§ÑÔºå`doGetBean`Ë¥üË¥£Â§ßÈÉ®ÂàÜÂ∑•‰ΩúÔºåÂ¶ÇÊü•ÊâæbeanÂÆö‰πâ„ÄÅÂàõÂª∫beanÔºàÂ¶ÇÊûúÂ∞öÊú™ÂàõÂª∫Ôºâ„ÄÅÂ§ÑÁêÜ‰æùËµñÂÖ≥Á≥ªÁ≠â„ÄÇ

```java
@Override
public Object getBean(String name) throws BeansException {
    return doGetBean(name, null, null, false);
}
```

Âú®`org.springframework.beans.factory.support.AbstractBeanFactory#doGetBean`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÊ£ÄÊü•ÊâÄËØ∑Ê±ÇÁöÑbeanÊòØÂê¶ÊòØ‰∏Ä‰∏™Âçï‰æãÂπ∂‰∏îÂ∑≤ÁªèÂàõÂª∫„ÄÇÂ¶ÇÊûúÂ∞öÊú™ÂàõÂª∫ÔºåÂÆÉÂ∞ÜÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂÆû‰æã„ÄÇÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠ÔºåÂÆÉÂ§ÑÁêÜÂèØËÉΩÁöÑÂºÇÂ∏∏ÊÉÖÂÜµÔºåÂ¶ÇÂæ™ÁéØÂºïÁî®ÔºåÂπ∂Á°Æ‰øùËøîÂõûÁöÑbeanÊòØÊ≠£Á°ÆÁöÑÁ±ªÂûã„ÄÇËøôÊòØSpringÂÆπÂô®beanÁîüÂëΩÂë®ÊúüÁÆ°ÁêÜÁöÑÊ†∏ÂøÉÈÉ®ÂàÜ„ÄÇ

```java
protected <T> T doGetBean(
        String name, @Nullable Class<T> requiredType, @Nullable Object[] args, boolean typeCheckOnly)
        throws BeansException {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // ÂºÄÂßãÂàõÂª∫beanÂÆû‰æã
    if (mbd.isSingleton()) {
        // Â¶ÇÊûúbeanÊòØÂçï‰æãÁöÑÔºåÊàë‰ª¨‰ºöÂ∞ùËØï‰ªéÂçï‰æãÁºìÂ≠ò‰∏≠Ëé∑ÂèñÂÆÉ
        // Â¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÂàô‰ΩøÁî®lambdaÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂÆû‰æã
        sharedInstance = getSingleton(beanName, () -> {
            try {
                // Â∞ùËØïÂàõÂª∫beanÂÆû‰æã
                return createBean(beanName, mbd, args);
            }
            catch (BeansException ex) {
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            }
        });
        // ÂØπ‰∫éÊüê‰∫õbeanÔºà‰æãÂ¶ÇFactoryBeansÔºâÔºåÂèØËÉΩÈúÄË¶ÅËøõ‰∏ÄÊ≠•Â§ÑÁêÜ‰ª•Ëé∑ÂèñÁúüÊ≠£ÁöÑbeanÂÆû‰æã
        beanInstance = getObjectForBeanInstance(sharedInstance, name, beanName, mbd);
    }
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // Á°Æ‰øùËøîÂõûÁöÑbeanÂÆû‰æã‰∏éËØ∑Ê±ÇÁöÑÁ±ªÂûãÂåπÈÖç
    return adaptBeanInstance(name, beanInstance, requiredType);
}
```

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#getSingleton()`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅË¥üË¥£‰ªéÂçï‰æãÁºìÂ≠ò‰∏≠Ëé∑Âèñ‰∏Ä‰∏™Â∑≤Â≠òÂú®ÁöÑbeanÂÆû‰æãÔºåÊàñËÄÖ‰ΩøÁî®Êèê‰æõÁöÑ`ObjectFactory`ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂÆû‰æã„ÄÇËøôÊòØÁ°Æ‰øùbeanÂú®SpringÂÆπÂô®‰∏≠‰Ωú‰∏∫Âçï‰æãÂ≠òÂú®ÁöÑÂÖ≥ÈîÆÈÉ®ÂàÜ„ÄÇ

```java
public Object getSingleton(String beanName, ObjectFactory<?> singletonFactory) {
    // Êñ≠Ë®ÄbeanÂêçÁß∞‰∏çËÉΩ‰∏∫Á©∫
    Assert.notNull(beanName, "Bean name must not be null");

    // ÂêåÊ≠•ËÆøÈóÆÂçï‰æãÂØπË±°ÁºìÂ≠òÔºåÁ°Æ‰øùÁ∫øÁ®ãÂÆâÂÖ®
    synchronized (this.singletonObjects) {
        // ‰ªéÁºìÂ≠ò‰∏≠Ëé∑ÂèñÂçï‰æãÂØπË±°
        Object singletonObject = this.singletonObjects.get(beanName);

        // Â¶ÇÊûúÁºìÂ≠ò‰∏≠Ê≤°ÊúâÊâæÂà∞
        if (singletonObject == null) {
            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

            try {
                // ‰ΩøÁî®Â∑•ÂéÇÂàõÂª∫Êñ∞ÁöÑÂçï‰æãÂÆû‰æã
                singletonObject = singletonFactory.getObject();
                newSingleton = true;
            }
            catch (IllegalStateException ex) {
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            }
            catch (BeanCreationException ex) {
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            }
            finally {
                // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
            }

            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
        }

        // ËøîÂõûÂçï‰æãÂØπË±°
        return singletonObject;
    }
}
```

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#createBean()`ÊñπÊ≥ï‰∏≠Ôºå‰∏ªË¶ÅÁöÑÈÄªËæëÊòØË∞ÉÁî® `doCreateBean`ÔºåËøôÊòØÁúüÊ≠£ËøõË°å bean ÂÆû‰æãÂåñ„ÄÅÂ±ûÊÄßÂ°´ÂÖÖÂíåÂàùÂßãÂåñÁöÑÂú∞Êñπ„ÄÇËøô‰∏™ÊñπÊ≥ï‰ºöËøîÂõûÊñ∞ÂàõÂª∫ÁöÑ bean ÂÆû‰æã„ÄÇ

```java
@Override
protected Object createBean(String beanName, RootBeanDefinition mbd, @Nullable Object[] args)
    throws BeanCreationException {
    
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    
    try {
        // Ê≠£Â∏∏ÁöÑbeanÂÆû‰æãÂåñ„ÄÅÂ±ûÊÄßÊ≥®ÂÖ•ÂíåÂàùÂßãÂåñ„ÄÇ
        // ËøôÈáåÊòØÁúüÊ≠£ËøõË°åbeanÂàõÂª∫ÁöÑÈÉ®ÂàÜ„ÄÇ
        Object beanInstance = doCreateBean(beanName, mbdToUse, args);
        // ËÆ∞ÂΩïbeanÊàêÂäüÂàõÂª∫ÁöÑÊó•Âøó
        if (logger.isTraceEnabled()) {
            logger.trace("Finished creating instance of bean '" + beanName + "'");
        }
        return beanInstance;
    }
    catch (BeanCreationException | ImplicitlyAppearedSingletonException ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }
    catch (Throwable ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }
}
```

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#doCreateBean`ÊñπÊ≥ï‰∏≠Ôºå`initializeBean`ÊñπÊ≥ïÊòØbeanÂàùÂßãÂåñÔºåÁ°Æ‰øùbeanÊòØÂÆåÂÖ®ÈÖçÁΩÆÂíåÂáÜÂ§áÂ•ΩÁöÑ„ÄÇ

```java
protected Object doCreateBean(String beanName, RootBeanDefinition mbd, @Nullable Object[] args)
        throws BeanCreationException {

    // Â£∞Êòé‰∏Ä‰∏™ÂØπË±°ÔºåÂêéÁª≠ÂèØËÉΩÁî®‰∫éÂ≠òÊîæÂàùÂßãÂåñÂêéÁöÑbeanÊàñÂÆÉÁöÑ‰ª£ÁêÜÂØπË±°
    Object exposedObject = bean;

    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    
    try {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
        
        // beanÂàùÂßãÂåñ
        exposedObject = initializeBean(beanName, exposedObject, mbd);
    } 
    catch (Throwable ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }

    // ËøîÂõûÂàõÂª∫ÂíåÂàùÂßãÂåñÂêéÁöÑbean
    return exposedObject;
}
```

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#initializeBean`ÊñπÊ≥ï‰∏≠ÔºåÂ¶ÇÊûúbeanÂÆûÁé∞‰∫Ü`InitializingBean`Êé•Âè£ÔºåÂàôÂÆÉÁöÑ`afterPropertiesSet`ÊñπÊ≥ï‰ºöÂú®Ê≠§Â§ÑË¢´Ë∞ÉÁî®„ÄÇÊ≠§Â§ñÔºåÂ¶ÇÊûúbeanÈÖçÁΩÆ‰∏≠ÂÆö‰πâ‰∫ÜËá™ÂÆö‰πâÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºåspring‰ºöÂú®ËøôÈáåË¢´Ë∞ÉÁî®„ÄÇ

```java
protected Object initializeBean(String beanName, Object bean, @Nullable RootBeanDefinition mbd) {

    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    
    try {
        invokeInitMethods(beanName, wrappedBean, mbd);
    }
    catch (Throwable ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }
    
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    return wrappedBean;
}
```

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#invokeInitMethods`ÊñπÊ≥ï‰∏≠Ôºå`afterPropertiesSet`ÊòØ`InitializingBean`Êé•Âè£‰∏≠ÂÆö‰πâÁöÑ‰∏Ä‰∏™ÁâπÊÆäÁöÑÂàùÂßãÂåñÊñπÊ≥ï„ÄÇÂ¶ÇÊûúbeanÂÆûÁé∞‰∫ÜËøô‰∏™Êé•Âè£ÔºåËøô‰∏™ÊñπÊ≥ï‰ºöÂú®beanÁöÑÂ±ûÊÄßË¢´Ê≥®ÂÖ•‰πãÂêéËá™Âä®Ë¢´Ë∞ÉÁî®„ÄÇÂú®ËøôÈáåÔºå‰∏∫‰∫ÜÈÅøÂÖçÈáçÂ§çË∞ÉÁî®ÔºåSpring‰ºöÊ£ÄÊü•beanÊòØÂê¶ÊòØ`InitializingBean`ÁöÑÂÆû‰æãÔºå‰ª•ÂèäÂÖ∂ÂàùÂßãÂåñÊñπÊ≥ïÂêçÊòØÂê¶‰∏∫`afterPropertiesSet`„ÄÇ

```java
protected void invokeInitMethods(String beanName, Object bean, @Nullable RootBeanDefinition mbd)
			throws Throwable {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    
    // Ê£ÄÊü•BeanÂÆö‰πâÊòØÂê¶Â≠òÂú®Ôºå‰∏îbeanÂÆû‰æã‰∏çÊòØ‰∏Ä‰∏™NullBeanÔºàSpring‰∏≠Áî®‰∫éÊ†áËÆ∞Âç†‰ΩçbeanÁöÑÁâπÊÆäÁ±ªÂûãÔºâ
    if (mbd != null && bean.getClass() != NullBean.class) {
        // Ëé∑ÂèñÂàùÂßãÂåñÊñπÊ≥ïÂêç
        String initMethodName = mbd.getInitMethodName();
        // Ê£ÄÊü•ÊòØÂê¶ÊúâÂàùÂßãÂåñÊñπÊ≥ïÈúÄË¶ÅË¢´Ë∞ÉÁî®
        if (StringUtils.hasLength(initMethodName) &&
            // bean‰∏çÊòØ‰∏Ä‰∏™InitializingBeanÔºåÊàñËÄÖÂàùÂßãÂåñÊñπÊ≥ïÂêç‰∏çÊòØ"afterPropertiesSet"
            !(isInitializingBean && "afterPropertiesSet".equals(initMethodName)) &&
            // ÂàùÂßãÂåñÊñπÊ≥ïÊ≤°ÊúâË¢´Â§ñÈÉ®ÁÆ°ÁêÜÔºà‰æãÂ¶ÇÔºåÈÄöËøáAspectJÁöÑÂàáÈù¢Ôºâ
            !mbd.isExternallyManagedInitMethod(initMethodName)) {
            // Ë∞ÉÁî®Ëá™ÂÆö‰πâÁöÑÂàùÂßãÂåñÊñπÊ≥ï
            invokeCustomInitMethod(beanName, bean, mbd);
        }
    }
}
```

Âú®`org.springframework.beans.factory.support.AbstractAutowireCapableBeanFactory#invokeCustomInitMethod`ÊñπÊ≥ï‰∏≠Ôºå‰ΩøÁî®JavaÂèçÂ∞ÑAPIÊù•Âä®ÊÄÅÂú∞Ë∞ÉÁî®BeanÁöÑÂàùÂßãÂåñÊñπÊ≥ï„ÄÇ

```java
protected void invokeCustomInitMethod(String beanName, Object bean, RootBeanDefinition mbd)
			throws Throwable {
	// ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

	// ‰ΩøÁî®ÂèçÂ∞ÑÊù•Ë∞ÉÁî®BeanÁöÑÂàùÂßãÂåñÊñπÊ≥ï
    try {
        // Á°Æ‰øùË¶ÅË∞ÉÁî®ÁöÑÊñπÊ≥ïÊòØÂèØËÆøÈóÆÁöÑ
        ReflectionUtils.makeAccessible(methodToInvoke);
        // Ë∞ÉÁî®BeanÁöÑËá™ÂÆö‰πâÂàùÂßãÂåñÊñπÊ≥ï
        methodToInvoke.invoke(bean);
    }
    catch (InvocationTargetException ex) {
        // Â¶ÇÊûúÂàùÂßãÂåñÊñπÊ≥ïÊäõÂá∫‰∫ÜÂºÇÂ∏∏ÔºåËøôÈáå‰ºöÊçïËé∑Âà∞ÔºåÂπ∂ÁªßÁª≠ÊäõÂá∫ËØ•ÂºÇÂ∏∏ÁöÑÁõÆÊ†áÂºÇÂ∏∏
        throw ex.getTargetException();
    }
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

#### @BeanÈîÄÊØÅÊ∫êÁ†ÅÂàÜÊûê

È¶ñÂÖàÊù•ÁúãÁúãÂêØÂä®Á±ªÂÖ•Âè£Ôºå‰∏ä‰∏ãÊñáÁéØÂ¢É‰ΩøÁî®`AnnotationConfigApplicationContext`ÔºàÊ≠§Á±ªÊòØ‰ΩøÁî®JavaÊ≥®Ëß£Êù•ÈÖçÁΩÆSpringÂÆπÂô®ÁöÑÊñπÂºèÔºâÔºåÊûÑÈÄ†ÂèÇÊï∞Êàë‰ª¨ÁªôÂÆö‰∫Ü‰∏Ä‰∏™`MyConfiguration`ÁªÑ‰ª∂Á±ª„ÄÇÁÑ∂Âêé‰ªéSpring‰∏ä‰∏ãÊñá‰∏≠Ëé∑Âèñ‰∏Ä‰∏™`MyBean`Á±ªÂûãÁöÑbeanÔºåÊúÄÂêéË∞ÉÁî®`context.close()`ÊñπÊ≥ïÂÖ≥Èó≠ÂÆπÂô®„ÄÇ

```java
public class BeanApplication {

    public static void main(String[] args) {
        AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(MyConfiguration.class);
        System.out.println(context.getBean(MyBean.class));
        context.close();
    }
}
```

Âú®`org.springframework.context.support.AbstractApplicationContext#close`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÊòØÂêØÂä®‰∫Ü‰∏Ä‰∏™ÂêåÊ≠•ÂùóÔºåÂÆÉÂêåÊ≠•Âú® `startupShutdownMonitor` ÂØπË±°‰∏ä„ÄÇËøôÁ°Æ‰øù‰∫ÜÂú®ÁªôÂÆöÊó∂ÂàªÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãÂèØ‰ª•ÊâßË°åËøô‰∏™ÂùóÂÜÖÁöÑ‰ª£Á†ÅÔºåÈò≤Ê≠¢Â§öÁ∫øÁ®ãÂØºËá¥ÁöÑËµÑÊ∫êÁ´û‰∫âÊàñÊï∞ÊçÆ‰∏ç‰∏ÄËá¥ÔºåÁÑ∂ÂêéÊòØË∞ÉÁî®‰∫Ü `doClose` ÊñπÊ≥ïÔºåÊúÄÂêéÊòØ‰∏∫ JVM Ê≥®ÂÜå‰∫Ü‰∏Ä‰∏™ÂÖ≥Èó≠Èí©Â≠ê„ÄÇ

```java
@Override
public void close() {
    synchronized (this.startupShutdownMonitor) {
        doClose();
        // If we registered a JVM shutdown hook, we don't need it anymore now:
        // We've already explicitly closed the context.
        if (this.shutdownHook != null) {
            try {
                Runtime.getRuntime().removeShutdownHook(this.shutdownHook);
            }
            catch (IllegalStateException ex) {
                // ignore - VM is already shutting down
            }
        }
    }
}
```

Âú®`org.springframework.context.support.AbstractApplicationContext#doClose`ÊñπÊ≥ï‰∏≠ÔºåÂèàË∞ÉÁî®‰∫Ü `destroyBeans` ÊñπÊ≥ï„ÄÇ

```java
protected void doClose() {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    // Destroy all cached singletons in the context's BeanFactory.
    destroyBeans();
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.context.support.AbstractApplicationContext#destroyBeans`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÊòØË∞ÉÁî®‰∫Ü`getBeanFactory()`ËøîÂõû Spring ÁöÑ `BeanFactory` ÔºåÁÑ∂ÂêéÂú®Ëé∑ÂæóÁöÑ `BeanFactory` ‰∏äÔºåË∞ÉÁî®‰∫Ü `destroySingletons` ÊñπÊ≥ïÔºåËøô‰∏™ÊñπÊ≥ïÁöÑÁõÆÁöÑÊòØÈîÄÊØÅÊâÄÊúâÂú® `BeanFactory` ‰∏≠ÁºìÂ≠òÁöÑÂçï‰æã beans„ÄÇ

```java
protected void destroyBeans() {
    getBeanFactory().destroySingletons();
}
```

Âú®`org.springframework.beans.factory.support.DefaultListableBeanFactory#destroySingletons`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÊòØË∞ÉÁî®‰∫ÜÁà∂Á±ªÁöÑ `destroySingletons` ÊñπÊ≥ïÔºå‰∏∫‰∫ÜÁ°Æ‰øùÁªßÊâøËá™Áà∂Á±ªÁöÑÈîÄÊØÅÈÄªËæëÂæóÂà∞‰∫ÜÊâßË°å„ÄÇ

```java
@Override
public void destroySingletons() {
    super.destroySingletons();
    updateManualSingletonNames(Set::clear, set -> !set.isEmpty());
    clearByTypeCache();
}
```

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#destroySingletons`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÊòØÂú®`disposableBeans` Â≠óÊÆµ‰∏äÔºå‰ªéÂÖ∂ÈîÆÈõÜÂêà‰∏≠Ëé∑ÂèñÊâÄÊúâÁöÑ bean ÂêçÁß∞ÔºåÂπ∂Â∞ÜÂÆÉ‰ª¨ËΩ¨Êç¢‰∏∫‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤Êï∞ÁªÑ„ÄÇ`disposableBeans` ÂèØËÉΩÂåÖÂê´‰∫ÜÂÆûÁé∞‰∫Ü `DisposableBean` Êé•Âè£ÁöÑ beansÔºåËøô‰∫õ beans ÈúÄË¶ÅÂú®ÂÆπÂô®ÈîÄÊØÅÊó∂ÁâπÊÆäÂ§ÑÁêÜÔºåÊúÄÂêéÂÄíÂ∫èÂæ™ÁéØÔºå‰ªéÊúÄÂêé‰∏Ä‰∏™ÂºÄÂßãÔºåÈîÄÊØÅÊâÄÊúâÂú® `disposableBeans` ÂàóË°®‰∏≠ÁöÑ beans„ÄÇËøôÊ†∑ÂÅöÊòØ‰∏∫‰∫ÜÁ°Æ‰øù‰æùËµñÂÖ≥Á≥ªÊ≠£Á°ÆÂú∞Â§ÑÁêÜÔºåbeansÂÖàË¢´ÂàõÂª∫ÁöÑÂ∫îËØ•ÂêéË¢´ÈîÄÊØÅ„ÄÇ

```java
public void destroySingletons() {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    String[] disposableBeanNames;
    synchronized (this.disposableBeans) {
        disposableBeanNames = StringUtils.toStringArray(this.disposableBeans.keySet());
    }
    for (int i = disposableBeanNames.length - 1; i >= 0; i--) {
        destroySingleton(disposableBeanNames[i]);
    }
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.beans.factory.support.DefaultListableBeanFactory#destroySingleton`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÊòØË∞ÉÁî®‰∫ÜÁà∂Á±ªÁöÑ `destroySingleton` ÊñπÊ≥ïÔºå‰∏∫‰∫ÜÁ°Æ‰øùÁªßÊâøËá™Áà∂Á±ªÁöÑÈîÄÊØÅÈÄªËæëÂæóÂà∞‰∫ÜÊâßË°å„ÄÇ

```java
@Override
public void destroySingleton(String beanName) {
    super.destroySingleton(beanName);
    removeManualSingletonName(beanName);
    clearByTypeCache();
}
```

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#destroySingleton`ÊñπÊ≥ï‰∏≠ÔºåÈ¶ñÂÖàÊòØ‰ΩøÁî® `synchronized` ÂÖ≥ÈîÆÂ≠óÂú® `disposableBeans` ÂØπË±°‰∏äËøõË°åÂêåÊ≠•Ôºå‰ª•Á°Æ‰øùÂú®Â§öÁ∫øÁ®ãÁéØÂ¢É‰∏≠ÂÆâÂÖ®Âú∞ËÆøÈóÆÂíå‰øÆÊîπÂÆÉÔºå‰ªé `disposableBeans` ÈõÜÂêà‰∏≠ÁßªÈô§ÊåáÂÆöÂêçÁß∞ÁöÑ beanÔºåÂπ∂Â∞ÜÂÖ∂ËΩ¨Êç¢‰∏∫ `DisposableBean` Á±ªÂûãÔºåÊúÄÂêéË∞ÉÁî®`destroyBean`ÊñπÊ≥ïÊâßË°åÂÆûÈôÖÁöÑÈîÄÊØÅÊìç‰Ωú„ÄÇ

```java
public void destroySingleton(String beanName) {
    // Remove a registered singleton of the given name, if any.
    removeSingleton(beanName);

    // Destroy the corresponding DisposableBean instance.
    DisposableBean disposableBean;
    synchronized (this.disposableBeans) {
        disposableBean = (DisposableBean) this.disposableBeans.remove(beanName);
    }
    destroyBean(beanName, disposableBean);
}
```

Âú®`org.springframework.beans.factory.support.DefaultSingletonBeanRegistry#destroyBean`ÊñπÊ≥ï‰∏≠ÔºåÁõ¥Êé•Ë∞ÉÁî® `bean` ÁöÑ `destroy` ÊñπÊ≥ï„ÄÇÂõ†‰∏∫ `bean` ÊòØ‰∏Ä‰∏™ `DisposableBean` Á±ªÂûãÁöÑÂÆû‰æãÔºåÊâÄ‰ª•ÂÆÉ‰∏ÄÂÆöÊúâ‰∏Ä‰∏™ `destroy` ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïÊèê‰æõ‰∫Ü bean ÁöÑËá™ÂÆö‰πâÈîÄÊØÅÈÄªËæë„ÄÇ

```java
protected void destroyBean(String beanName, @Nullable DisposableBean bean) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    // Actually destroy the bean now...
    if (bean != null) {
        try {
            bean.destroy();
        }
        catch (Throwable ex) {
            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
        }
    }
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
}
```

Âú®`org.springframework.beans.factory.support.DisposableBeanAdapter#destroy`ÊñπÊ≥ï‰∏≠ÔºåÊ≠§ÊñπÊ≥ïÈ¶ñÂÖàÊ£ÄÊü•ÊòØÂê¶Â∑≤Áªè‰∏∫beanÊåáÂÆö‰∫Ü‰∏Ä‰∏™ÈîÄÊØÅÊñπÊ≥ï(`destroyMethod`)„ÄÇÂ¶ÇÊûúÊúâÔºåÂàôÁõ¥Êé•Ë∞ÉÁî®`invokeCustomDestroyMethod`ÊñπÊ≥ï„ÄÇÂ¶ÇÊûúÊ≤°ÊúâÊèê‰æõÂÖ∑‰ΩìÁöÑÊñπÊ≥ïÔºå‰ΩÜÊèê‰æõ‰∫ÜÊñπÊ≥ïÁöÑÂêçÁß∞(`destroyMethodName`)ÔºåÈÇ£‰πàÂÆÉ‰ºöÂ∞ùËØïÊ†πÊçÆËøô‰∏™ÂêçÁß∞ÊâæÂà∞ÂØπÂ∫îÁöÑÊñπÊ≥ï„ÄÇ‰∏ÄÊó¶ÊâæÂà∞‰∫ÜÊñπÊ≥ïÔºåÂ∞±‰ºöË∞ÉÁî®`invokeCustomDestroyMethod`ÊñπÊ≥ï„ÄÇ

```java
@Override
public void destroy() {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]

    // Â¶ÇÊûúÊèê‰æõ‰∫ÜÈîÄÊØÅÊñπÊ≥ïÔºàdestroyMethodÔºâÔºåÂàôÁõ¥Êé•Ë∞ÉÁî®ÂÆÉ
    if (this.destroyMethod != null) {
        invokeCustomDestroyMethod(this.destroyMethod);
    }
    // Âê¶ÂàôÔºåÂ¶ÇÊûúÊèê‰æõ‰∫ÜÈîÄÊØÅÊñπÊ≥ïÁöÑÂêçÁß∞ÔºàdestroyMethodNameÔºâÔºåÂàôÂ∞ùËØïÊâæÂà∞ÂØπÂ∫îÁöÑÊñπÊ≥ïÂπ∂Ë∞ÉÁî®ÂÆÉ
    else if (this.destroyMethodName != null) {
        // Ê†πÊçÆÊñπÊ≥ïÂêçÁ°ÆÂÆöË¶ÅË∞ÉÁî®ÁöÑÈîÄÊØÅÊñπÊ≥ï
        Method methodToInvoke = determineDestroyMethod(this.destroyMethodName);
        if (methodToInvoke != null) {
            // Â¶ÇÊûúÊâæÂà∞‰∫ÜÊñπÊ≥ïÔºåÂàôË∞ÉÁî®ÂÆÉÔºå‰ΩÜÁ°Æ‰øù‰ΩøÁî®ÁöÑÊòØÊñπÊ≥ïÁöÑÊé•Âè£ÁâàÊú¨ÔºàÂ¶ÇÊûúÂèØËÉΩÁöÑËØùÔºâ
            invokeCustomDestroyMethod(ClassUtils.getInterfaceMethodIfPossible(methodToInvoke));
        }
    }
}
```

Âú®`org.springframework.beans.factory.support.DisposableBeanAdapter#invokeCustomDestroyMethod`ÊñπÊ≥ï‰∏≠ÔºåÁî®‰∫éÊâßË°åËá™ÂÆö‰πâÁöÑÈîÄÊØÅÊñπÊ≥ï„ÄÇËá™ÂÆö‰πâÈîÄÊØÅÊñπÊ≥ïÊòØÁî±Êàë‰ª¨Âú®SpringÈÖçÁΩÆ‰∏≠‰∏∫beanÂÆö‰πâÁöÑÔºåÁî®‰∫éÂú®beanÁöÑÁîüÂëΩÂë®ÊúüÁªìÊùüÊó∂ÈáäÊîæËµÑÊ∫ê„ÄÅÊ∏ÖÁêÜÁ≠â„ÄÇ

```java
private void invokeCustomDestroyMethod(final Method destroyMethod) {
    // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    try {
        if (System.getSecurityManager() != null) {
            // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
        }
        else {
            ReflectionUtils.makeAccessible(destroyMethod);
            destroyMethod.invoke(this.bean, args);
        }
    }
    catch (InvocationTargetException ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }
    catch (Throwable ex) {
        // ... [‰ª£Á†ÅÈÉ®ÂàÜÁúÅÁï•‰ª•ÁÆÄÂåñ]
    }
}
```

### ÂÖ´„ÄÅÊ≥®ÊÑè‰∫ãÈ°π

1. **ÊñπÊ≥ïÂêçÁß∞Âç≥BeanÂêçÁß∞**
   + ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºå‰ΩøÁî®`@Bean`Ê≥®Ëß£ÁöÑÊñπÊ≥ïÂêçÁß∞Â∞ÜÁî®‰ΩúBeanÁöÑÂêçÁß∞„ÄÇÂ¶ÇÊûúÈúÄË¶ÅËá™ÂÆö‰πâbeanÁöÑÂêçÁß∞ÔºåÂèØ‰ª•Âú®`@Bean`Ê≥®Ëß£‰∏≠ÊåáÂÆöÂêçÁß∞ÔºåÂ¶Ç`@Bean("customBeanName")`„ÄÇ

2. **ËøîÂõûÁ±ªÂûã**
   + Á°Æ‰øù`@Bean`ÊñπÊ≥ïÁöÑËøîÂõûÁ±ªÂûã‰∏éÂÆûÈôÖÂàõÂª∫ÁöÑbeanÂØπË±°ÂåπÈÖç„ÄÇ

3. **Ë∞ÉÁî®ÂÖ∂‰ªñ`@Bean`ÊñπÊ≥ï**
   + Âú®‰∏Ä‰∏™ÈÖçÁΩÆÁ±ª‰∏≠ÔºåÂèØ‰ª•Ë∞ÉÁî®‰∏Ä‰∏™`@Bean`ÊñπÊ≥ïÊù•Ê≥®ÂÖ•Âè¶‰∏Ä‰∏™`@Bean`ÊñπÊ≥ïÁöÑÁªìÊûú„ÄÇËøôÊòØÂõ†‰∏∫`@Bean`ÊñπÊ≥ïÂú®Ë∞ÉÁî®Êó∂ÊòØÈÄöËøáSpring‰ª£ÁêÜËøõË°åÁöÑÔºåËøôÁ°Æ‰øù‰∫ÜÂçï‰æãbeansÁöÑÂçï‰∏ÄÂÆû‰æãÊÄß„ÄÇ

4. **‰ΩúÁî®Âüü**
   + ‰ΩøÁî®`@Scope`Ê≥®Ëß£‰∏é`@Bean`‰∏ÄËµ∑ÂèØ‰ª•ÂÆö‰πâBeanÁöÑ‰ΩúÁî®ÂüüÔºå‰æãÂ¶ÇÂçï‰æãÔºàÈªòËÆ§Ôºâ„ÄÅÂéüÂûã„ÄÅËØ∑Ê±Ç„ÄÅ‰ºöËØùÁ≠â„ÄÇ

5. **ÁîüÂëΩÂë®ÊúüÂõûË∞É**
   + `@Bean`Ê≥®Ëß£ÂÖÅËÆ∏ÊåáÂÆö`initMethod`Âíå`destroyMethod`ÔºåËøô‰∫õÊñπÊ≥ïÂàÜÂà´Âú®beanÂàùÂßãÂåñÂíåÈîÄÊØÅÊó∂Ë¢´Ë∞ÉÁî®„ÄÇ

6. **ÈÅøÂÖçÈáçÂ§çÂÆö‰πâ**
   + Á°Æ‰øù‰∏çÂú®XMLÂíåJavaÈÖçÁΩÆ‰∏≠ÂêåÊó∂ÂÆö‰πâÂêå‰∏Ä‰∏™bean„ÄÇÂ¶ÇÊûúÂøÖÈ°ªËøôÊ†∑ÂÅöÔºåÁ°Æ‰øùbeanÁöÑÂêçÁß∞ÂíåÂÆö‰πâÁõ∏ÂêåÔºåÂê¶Âàô‰ºöÂá∫Áé∞‰∏çÂèØÈ¢ÑÊµãÁöÑË°å‰∏∫„ÄÇ

7. **ÊÖéÁî®`@Lazy`**
   + `@Lazy`Ê≥®Ëß£‰ΩøÂæóbeanÂú®È¶ñÊ¨°ËØ∑Ê±ÇÊó∂ÊâçË¢´ÂàùÂßãÂåñ„ÄÇÂ¶ÇÊûú‰∏Ä‰∏™beanÈúÄË¶ÅÂú®Â∫îÁî®ÂêØÂä®Êó∂Â∞±ÂàùÂßãÂåñÔºåÈÇ£‰πà‰∏çÂ∫îËØ•Ê†áËÆ∞‰∏∫Âª∂ËøüÂàùÂßãÂåñ„ÄÇ

8. **ÂèÇÊï∞Âåñ`@Bean`ÊñπÊ≥ï**
   + `@Bean`ÊñπÊ≥ïÂèØ‰ª•Êé•ÂèóÂèÇÊï∞ÔºåËøô‰∫õÂèÇÊï∞‰ºö‰ªéSpringÂÆπÂô®‰∏≠Ëá™Âä®Ëß£Êûê„ÄÇËøôÂú®ÂàõÂª∫‰∏Ä‰∏™bean‰æùËµñ‰∫éÂè¶‰∏Ä‰∏™beanÊó∂ÁâπÂà´ÊúâÁî®„ÄÇ

9. **ËÄÉËôëÁ∫øÁ®ãÂÆâÂÖ®ÊÄß**
   + ÁâπÂà´ÊòØÂØπ‰∫éÂéüÂûã‰ΩúÁî®ÂüüÁöÑbeanÔºåÁ°Æ‰øùbeanÊòØÁ∫øÁ®ãÂÆâÂÖ®ÁöÑÔºåÊàñËÄÖ‰∏ç‰ºöÂú®Â§ö‰∏™Á∫øÁ®ã‰πãÈó¥ÂÖ±‰∫´„ÄÇ

10. **‰ΩøÁî®Êù°‰ª∂Ê≥®Ëß£**
    + ÈÖçÂêà`@Conditional`ÊàñÂÖ∂‰ªñÁõ∏ÂÖ≥Ê≥®Ëß£ÔºåÂèØ‰ª•Âú®Êª°Ë∂≥Êüê‰∫õÊù°‰ª∂Êó∂ÊâçÂàõÂª∫bean„ÄÇ

11. **`@Bean`‰∏é`@Component`ÁöÑÂå∫Âà´**
    + ËôΩÁÑ∂‰∏§ËÄÖÈÉΩÁî®‰∫éÂÆö‰πâbeanÔºå‰ΩÜ`@Bean`ÈÄöÂ∏∏Áî®‰∫éÊñπÊ≥ïÔºåÁâπÂà´ÊòØÂú®JavaÈÖçÁΩÆÁ±ª‰∏≠ÔºåËÄå`@Component`ÔºàÂèäÂÖ∂ÁâπÂåñÔºö`@Service`„ÄÅ`@Repository`„ÄÅ`@Controller`Á≠âÔºâÁî®‰∫éÁ±ª„ÄÇ

12. **Ê≥®ÊÑèÊΩúÂú®ÁöÑÂæ™ÁéØ‰æùËµñ**
    + Â¶ÇÊûú‰∏§‰∏™`@Bean`ÊñπÊ≥ïÁõ∏‰∫íË∞ÉÁî®ÔºåÂèØËÉΩ‰ºöÂá∫Áé∞Âæ™ÁéØ‰æùËµñ„ÄÇSpringÂèØ‰ª•Ëß£ÂÜ≥Âçï‰æã‰ΩúÁî®ÂüüÁöÑbean‰πãÈó¥ÁöÑÂæ™ÁéØ‰æùËµñÔºå‰ΩÜ‰∏çÊé®ËçêËøôÊ†∑ÂÅö„ÄÇ

13. **ÈÖçÁΩÆÁ±ªÂ∫îË¢´SpringÁÆ°ÁêÜ**
    + Á°Æ‰øùÂåÖÂê´`@Bean`ÊñπÊ≥ïÁöÑÁ±ªÁî±SpringÁÆ°ÁêÜÔºåÂπ∂Ê†áËÆ∞‰∏∫`@Configuration`„ÄÇËøôÁ°Æ‰øù`@Bean`ÊñπÊ≥ïÁî±SpringÁöÑ‰ª£ÁêÜË∞ÉÁî®Ôºå‰ªéËÄåÊîØÊåÅ‰∏äËø∞ÊèêÂà∞ÁöÑÁâπÊÄßÔºåÂ¶ÇÂçï‰æã‰øùËØÅÂíåÂæ™ÁéØÂºïÁî®„ÄÇ

### ‰πù„ÄÅÊÄªÁªì

#### ÊúÄ‰Ω≥ÂÆûË∑µÊÄªÁªì

1. **Â∫îÁî®ÂêØÂä®**
   + ‰ΩøÁî®`AnnotationConfigApplicationContext`ÂèØ‰ª•Âü∫‰∫éJavaÊ≥®Ëß£Êù•ÂêØÂä®ÂíåÈÖçÁΩÆSpringÁöÑ‰∏ä‰∏ãÊñá„ÄÇÂú®‰∏äËø∞Á§∫‰æã‰∏≠ÔºåÊàë‰ª¨‰º†ÈÄí‰∫Ü‰∏Ä‰∏™JavaÈÖçÁΩÆÁ±ª `MyConfiguration` ‰Ωú‰∏∫ÂèÇÊï∞Êù•ÂàùÂßãÂåñËøô‰∏™‰∏ä‰∏ãÊñá„ÄÇ

2. **ÈÖçÁΩÆÁ±ªÁöÑ‰ΩøÁî®**
   + ‰ΩøÁî® `@Configuration` Ê≥®Ëß£Ê†áËÆ∞ÈÖçÁΩÆÁ±ªÔºåË°®ÊòéËøô‰∏™Á±ªÂåÖÂê´SpringÁöÑbeanÂÆö‰πâ„ÄÇÂú®ÈÖçÁΩÆÁ±ª‰∏≠ÔºåÂèØ‰ª•‰ΩøÁî® `@Bean` Ê≥®Ëß£Êù•ÂÆö‰πâbean„ÄÇËøô‰∏™Ê≥®Ëß£ÁöÑÊñπÊ≥ïÁöÑÂêçÁß∞ÈªòËÆ§‰ºö‰Ωú‰∏∫beanÁöÑÂêçÁß∞ÔºåËøîÂõûÁöÑÂÆû‰æãÂàô‰∏∫SpringÂÆπÂô®ÁÆ°ÁêÜÁöÑbeanÂÆû‰æã„ÄÇ

3. **BeanÁöÑÁîüÂëΩÂë®Êúü**
   + ÈÄöËøá `@Bean` Ê≥®Ëß£ÁöÑ `initMethod` Âíå `destroyMethod` Â±ûÊÄßÔºåÂèØ‰ª•‰∏∫beanÂÆö‰πâÂàùÂßãÂåñÂíåÈîÄÊØÅÊó∂Ë¶ÅË∞ÉÁî®ÁöÑÊñπÊ≥ï„ÄÇËøô‰∏∫beanÊèê‰æõ‰∫Ü‰∏ÄÁßçËá™ÂÆö‰πâÁöÑÂàùÂßãÂåñÂíåÊ∏ÖÁêÜÊú∫Âà∂„ÄÇÂΩìbeanË¢´SpringÂÆπÂô®ÂÆû‰æãÂåñÊó∂ÔºåÊåáÂÆöÁöÑÂàùÂßãÂåñÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®ÔºõÂΩìbeanË¢´ÈîÄÊØÅÊàñÂÆπÂô®ÂÖ≥Èó≠Êó∂ÔºåÊåáÂÆöÁöÑÈîÄÊØÅÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇ

#### Ê∫êÁ†ÅÂàÜÊûêÊÄªÁªì

1. **@Bean Ê≥®ÂÜåÊ∫êÁ†ÅÂàÜÊûêÊÄªÁªì**

   + **ÂêØÂä®ÂèäÈÖçÁΩÆÂä†ËΩΩ**
     + ‰ΩøÁî® `AnnotationConfigApplicationContext` ÂàùÂßãÂåñSpring‰∏ä‰∏ãÊñáÔºåÂπ∂‰º†ÂÖ• `MyConfiguration` ÈÖçÁΩÆÁ±ª„ÄÇËØ•‰∏ä‰∏ãÊñáÊûÑÈÄ†ÂáΩÊï∞Â∞ÜÊâßË°å `register()` Âíå `refresh()` ÊñπÊ≥ï„ÄÇ

   + **BeanÂÆö‰πâÁöÑËß£Êûê**
     + `refresh()` ÊñπÊ≥ïËß¶Âèë‰∏ä‰∏ãÊñáÁöÑÂà∑Êñ∞ÔºåÂÖ∂‰∏≠Ê∂âÂèäÂà∞ÂØπbeanÂÆö‰πâÁöÑÂ§ÑÁêÜ„ÄÇË∞ÉÁî® `invokeBeanFactoryPostProcessors()` ÊñπÊ≥ïÊù•Â§ÑÁêÜbeanÂ∑•ÂéÇÂêéÁΩÆÂ§ÑÁêÜÂô®„ÄÇ

   + **Â§ÑÁêÜÈÖçÁΩÆÁ±ª**
     + `BeanDefinitionRegistryPostProcessor` ÊòØÁâπÊÆäÁöÑ `BeanFactoryPostProcessor`ÔºåÂÆÉ‰ºöÂú®ÊâÄÊúâÂÖ∂‰ªñbeanÂÆö‰πâË¢´Âä†ËΩΩ‰πãÂâçËøêË°å„ÄÇËøô‰∏™ÊµÅÁ®ã‰∏ªË¶ÅÈÄöËøá `ConfigurationClassPostProcessor` ÂÆûÁé∞ÔºåËØ•Á±ªË¥üË¥£Â§ÑÁêÜÊ†áÊúâ `@Configuration` ÁöÑÁ±ª„ÄÇ

   + **Ëß£Êûê `@Bean` ÊñπÊ≥ï**
     + ÂØπÊØè‰∏™ `@Configuration` Á±ªÊâßË°åËß£ÊûêÔºåÂ∞ÜÂÖ∂‰∏≠ÁöÑ `@Bean` ÊñπÊ≥ïËß£Êûê‰∏∫beanÂÆö‰πâ„ÄÇËøôÊ∂âÂèäËØªÂèñÊñπÊ≥ïÂÖÉÊï∞ÊçÆÔºåÂπ∂Â∞ÜÂÖ∂ËΩ¨Âåñ‰∏∫‰∏Ä‰∏™SpringÂèØ‰ª•ÁêÜËß£ÂíåÁÆ°ÁêÜÁöÑ `BeanDefinition` ÂØπË±°„ÄÇ

   + **Â§ÑÁêÜbean‰ΩúÁî®Âüü‰∏é‰ª£ÁêÜ**
     + Â¶ÇÊûúÂú® `@Bean` ÊñπÊ≥ï‰∏äÊúâ `@Scope` Ê≥®Ëß£Ôºå‰ºöÊ†πÊçÆÂÖ∂Â±ûÊÄßÂ§ÑÁêÜbeanÁöÑ‰ΩúÁî®Âüü„ÄÇÊ†πÊçÆÈúÄË¶ÅÔºåÂèØËÉΩ‰ºö‰∏∫beanÂàõÂª∫‰∏Ä‰∏™‰ª£ÁêÜÔºåËøôÊòØÈÄöËøá `ScopedProxyCreator` Êù•ÂÆåÊàêÁöÑ„ÄÇ

   + **beanÂÆö‰πâÁöÑÊ≥®ÂÜå**
     + ÊúÄÁªàÔºåËß£ÊûêÂá∫ÁöÑbeanÂÆö‰πâ‰ºöË¢´Ê≥®ÂÜåÂà∞SpringÁöÑbeanÂÆö‰πâÊ≥®ÂÜåË°®‰∏≠ÔºåËøôÊ†∑Âú®‰∏ä‰∏ãÊñáÂêØÂä®ÂêéÔºåËøô‰∫õÂÆö‰πâÁöÑbeanÂ∞±ÂèØ‰ª•Ë¢´ÂÆû‰æãÂåñÂíå‰ΩøÁî®‰∫Ü„ÄÇ

2. **@BeanÂàùÂßãÂåñÊ∫êÁ†ÅÂàÜÊûêÊÄªÁªì**

   + **ÂêØÂä®**
     + ÂΩì‰ΩøÁî®`AnnotationConfigApplicationContext`Âπ∂Êèê‰æõ`MyConfiguration`Á±ª‰Ωú‰∏∫ÂèÇÊï∞Êó∂ÔºåSpringÂÆπÂô®ÂºÄÂßãÂàùÂßãÂåñ„ÄÇ

   + **Âà∑Êñ∞‰∏ä‰∏ãÊñá**
     +  ÈÄöËøáË∞ÉÁî®`refresh()`ÊñπÊ≥ïÔºåSpring‰∏ä‰∏ãÊñáË¢´Âà∑Êñ∞„ÄÇËøôÊòØÂú®‰∏ä‰∏ãÊñá‰∏≠ÂàõÂª∫ÂíåÂàùÂßãÂåñÊâÄÊúâbeanÁöÑÂÖ≥ÈîÆÈò∂ÊÆµ„ÄÇ

   + **ÂàùÂßãÂåñBeanÂ∑•ÂéÇ**
     +  ÊñπÊ≥ï`finishBeanFactoryInitialization`‰ºöÁ°Æ‰øùÊâÄÊúâÈùûÊáíÂä†ËΩΩÁöÑÂçï‰æãbeanÈÉΩË¢´ÂàùÂßãÂåñ„ÄÇÂÆÉË∞ÉÁî®`DefaultListableBeanFactory`‰∏≠ÁöÑ`preInstantiateSingletons`ÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ïÂæ™ÁéØÈÅçÂéÜÂÆπÂô®‰∏≠ÂÆö‰πâÁöÑÊØè‰∏Ä‰∏™Âçï‰æãbeanÂπ∂‰ΩøÁî®`getBean`ÊñπÊ≥ïËøõË°åÂàùÂßãÂåñ„ÄÇ

   + **Ëé∑ÂèñBean**Ôºö
     + Âú®Ëé∑ÂèñbeanÊó∂ÔºåÈ¶ñÂÖà‰ºöÊ£ÄÊü•ÊòØÂê¶Â∑≤Â≠òÂú®Ê≠§Âçï‰æãbean„ÄÇÂ¶ÇÊûú‰∏çÂ≠òÂú®ÔºåÂàô‰ºöÂàõÂª∫ÂÆÉ„ÄÇÊ†∏ÂøÉÊñπÊ≥ïÊòØ`doGetBean`ÔºåÂÆÉÁÆ°ÁêÜÊï¥‰∏™beanÁöÑÁîüÂëΩÂë®ÊúüÔºå‰ªéÊü•ÊâæbeanÂÆö‰πâÂà∞ÂàùÂßãÂåñbean„ÄÇ

   + **Âçï‰æãÂ§ÑÁêÜ**
     + `getSingleton`ÊñπÊ≥ïÁÆ°ÁêÜÂçï‰æãbeanÁöÑÁºìÂ≠ò„ÄÇÂÆÉÈ¶ñÂÖàÂ∞ùËØï‰ªéÁºìÂ≠ò‰∏≠Ëé∑ÂèñbeanÔºåÂ¶ÇÊûúÊú™ÊâæÂà∞ÔºåÂàô‰ΩøÁî®Êèê‰æõÁöÑ`ObjectFactory`ÂàõÂª∫‰∏Ä‰∏™Êñ∞ÁöÑÂÆû‰æã„ÄÇ

   + **ÂàõÂª∫Bean**
     +  Â¶ÇÊûúÈúÄË¶ÅÔºå`createBean`ÊñπÊ≥ïÂ∞ÜË¥üË¥£ÂÆû‰æãÂåñbean„ÄÇÊúÄÁªàÔºåÁúüÊ≠£ÁöÑbeanÂàõÂª∫Â∑•‰ΩúÊòØÂú®`doCreateBean`ÊñπÊ≥ï‰∏≠ÂÆåÊàêÁöÑ„ÄÇ

   + **ÂàùÂßãÂåñBean**
     +  ‰∏ÄÊó¶beanË¢´ÂÆû‰æãÂåñÔºåÂ∞±ÈúÄË¶ÅËøõË°åÂàùÂßãÂåñ„ÄÇÂ¶ÇÊûúbeanÂÆûÁé∞‰∫Ü`InitializingBean`Êé•Âè£ÔºåÈÇ£‰πàÂÆÉÁöÑ`afterPropertiesSet`ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®„ÄÇÊ≠§Â§ñÔºåÂ¶ÇÊûúbeanÈÖçÁΩÆ‰∏≠ÂÆö‰πâ‰∫ÜËá™ÂÆö‰πâÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºåËØ•ÊñπÊ≥ï‰πü‰ºöÂú®Ê≠§Êó∂Ë¢´Ë∞ÉÁî®„ÄÇ

   + **ÂèçÂ∞ÑË∞ÉÁî®**
     + ÊúÄÁªàÔºåÂ¶ÇÊûúÂÆö‰πâ‰∫ÜËá™ÂÆö‰πâÁöÑÂàùÂßãÂåñÊñπÊ≥ïÔºåSpring‰ºö‰ΩøÁî®JavaÁöÑÂèçÂ∞ÑAPIÊù•Ë∞ÉÁî®ÂÆÉ„ÄÇ

3. **@BeanÈîÄÊØÅÊ∫êÁ†ÅÂàÜÊûêÊÄªÁªì**

   + **ÂêØÂä®ÂíåÂÖ≥Èó≠**
     + ÈÄöËøá`AnnotationConfigApplicationContext`ÔºåSpringÂÆπÂô®ÂàùÂßãÂåñÂêéÔºå`context.close()`ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®‰ª•ÂÖ≥Èó≠ÂÆπÂô®„ÄÇ

   + **ÂÖ≥Èó≠‰∏ä‰∏ãÊñá**
     + `close()`ÊñπÊ≥ïÈ¶ñÂÖàÂêåÊ≠•`startupShutdownMonitor`ÔºåÁ°Æ‰øùÂú®ÁâπÂÆöÊó∂ÂàªÂè™Êúâ‰∏Ä‰∏™Á∫øÁ®ãËÉΩÂÖ≥Èó≠‰∏ä‰∏ãÊñáÔºåÊé•ÁùÄË∞ÉÁî®`doClose`ÊñπÊ≥ïÊâßË°åÂÆûÈôÖÂÖ≥Èó≠Êìç‰Ωú„ÄÇ

   + **ÈîÄÊØÅBeans**
     + Âú®`doClose`ÊñπÊ≥ï‰∏≠Ôºå`destroyBeans`ÊñπÊ≥ïË¢´Ë∞ÉÁî®‰ª•ÈîÄÊØÅÊâÄÊúâÁºìÂ≠ò‰∏≠ÁöÑÂçï‰æãbean„ÄÇ

   + **ÈîÄÊØÅÂçï‰æãBeans**
     + `destroyBeans`ÊñπÊ≥ï‰ºöË∞ÉÁî®BeanFactoryÁöÑ`destroySingletons`ÊñπÊ≥ïÊù•ÈîÄÊØÅÊâÄÊúâÁºìÂ≠òÁöÑÂçï‰æãbeans„ÄÇ

   + **ÈÅçÂéÜÂπ∂ÈîÄÊØÅ**
     + Âú®`destroySingletons`‰∏≠ÔºåÊâÄÊúâÁºìÂ≠òÁöÑÂçï‰æãbeanÈÉΩ‰ºöË¢´ÈÅçÂéÜ„ÄÇÂØπ‰∫éÊØè‰∏Ä‰∏™beanÔºå`destroySingleton`ÊñπÊ≥ï‰ºöË¢´Ë∞ÉÁî®Êù•ÊâßË°åÈîÄÊØÅÊìç‰Ωú„ÄÇ

   + **ÂÆûÈôÖÁöÑÈîÄÊØÅÊìç‰Ωú**
     + Âú®`destroySingleton`‰∏≠Ôºå‰ºö‰ªé`disposableBeans`ÂàóË°®‰∏≠ÁßªÈô§ÂØπÂ∫îÁöÑbeanÔºåÂπ∂ÊâßË°åÂÆûÈôÖÁöÑÈîÄÊØÅÊìç‰Ωú„ÄÇ

   + **Ëá™ÂÆö‰πâÈîÄÊØÅÈÄªËæë**
     + Â¶ÇÊûúbeanÂÆûÁé∞‰∫Ü`DisposableBean`Êé•Âè£ÊàñËÄÖÂÆö‰πâ‰∫ÜËá™ÂÆö‰πâÁöÑÈîÄÊØÅÊñπÊ≥ïÔºåSpringÂÆπÂô®‰ºöÁ°Æ‰øùÂú®ÈîÄÊØÅbeanÊó∂Ë∞ÉÁî®Ëøô‰∫õÊñπÊ≥ï„ÄÇÈîÄÊØÅÊñπÊ≥ïÂèØ‰ª•ÊòØÂÆö‰πâÂú®beanÈÖçÁΩÆ‰∏≠ÁöÑ‰ªª‰ΩïÊñπÊ≥ïÔºå‰∏çÈúÄË¶ÅÁâπÂÆöÁöÑÊñπÊ≥ïÁ≠æÂêç„ÄÇ

   + **ÂèçÂ∞ÑË∞ÉÁî®ÈîÄÊØÅÊñπÊ≥ï**
     + ÊúÄÂêéÔºåSpring‰ΩøÁî®JavaÂèçÂ∞ÑAPIÊù•Âä®ÊÄÅÂú∞Ë∞ÉÁî®beanÁöÑËá™ÂÆö‰πâÈîÄÊØÅÊñπÊ≥ï„ÄÇ