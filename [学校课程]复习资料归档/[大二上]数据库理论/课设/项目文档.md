# 1.技术选型与环境变量

## 1.1技术选型

|      依赖名称       | 版本号      |
| :-----------------: | ----------- |
|         JDK         | JDK17.0.11  |
|     SpringBoot      | 3.0.2       |
|      SpringWeb      | starter稳定 |
|    Mybatis-Plus     | 3.5.5       |
|       Mybatis       | 3.0.3       |
|        druid        | 1.2.6       |
|        mysql        |             |
|       Lombok        | starter稳定 |
|  Spring Data Redis  | starter稳定 |
| Spring Data MongoDB | starter稳定 |
|         JWT         | 0.12.3      |
|   Spring Security   | starter稳定 |
|                     |             |
|                     |             |

## 1.2环境变量



|     变量名称      |     变量值     |
| :---------------: | :------------: |
| Application-port  |      8080      |
|   MySQL-DBName    | dataBaseDesign |
|  Mysql-username   |      root      |
|  Mysql-password   |  xiaoyongcai   |
|  MongoDB-DBName   | dataBaseDesign |
|   security-name   |  xiaoyongcai   |
| security-password |  xiaoyongcai   |
|    Mysql-port     |      3306      |
|    Redis-port     |      6379      |
|   MongoDB-port    |     27017      |
|                   |                |
|                   |                |
|                   |                |





# 2.关系型数据库设计

## 2.0所有SQL汇总

> 所有的SQL已经汇总在schema.SQL文件,在根目录.
>
> 可以直接运行该文件获取项目SQL

## 2.1实体表

### 2.1.1:Object_Person

```sql
-- 如果数据库已经存在，先删除
DROP DATABASE IF EXISTS dataBaseDesign;

-- 创建新的数据库，指定字符集为 utf8mb4，并设置排序规则为 utf8mb4_general_ci
CREATE DATABASE dataBaseDesign
  CHARACTER SET utf8mb4
  COLLATE utf8mb4_general_ci;

```



| 字段名     | 数据类型                         | 是否可空 | 是否自增 | 说明                                 |
| ---------- | -------------------------------- | -------- | -------- | ------------------------------------ |
| ID         | INT                              | NOT NULL | TRUE     | 员工号（主键，唯一标识员工）         |
| PASSWD     | VARCHAR(255)                     | NOT NULL | FALSE    | 密码（存储加密密码）                 |
| AUTHORITY  | ENUM('admin', 'user', 'manager') | NOT NULL | FALSE    | 用户权限（如：管理员、用户、经理等） |
| NAME       | VARCHAR(100)                     | NOT NULL | FALSE    | 姓名                                 |
| SEX        | ENUM('M', 'F')                   | NOT NULL | FALSE    | 性别（M-男，F-女）                   |
| BIRTHDAY   | DATE                             | NOT NULL | FALSE    | 生日（格式：YYYY-MM-DD）             |
| DEPARTMENT | VARCHAR(100)                     | NOT NULL | FALSE    | 所在部门                             |
| JOB        | VARCHAR(100)                     | NOT NULL | FALSE    | 职务                                 |
| EDU_LEVEL  | VARCHAR(50)                      | NOT NULL | FALSE    | 受教育程度                           |
| SPCIALTY   | VARCHAR(100)                     | NOT NULL | FALSE    | 专业技能                             |
| ADDRESS    | VARCHAR(255)                     | NOT NULL | FALSE    | 家庭住址                             |
| TEL        | VARCHAR(15)                      | NOT NULL | FALSE    | 联系电话                             |
| EMAIL      | VARCHAR(100)                     | NOT NULL | FALSE    | 电子邮箱                             |
| STATE      | ENUM('T', 'F')                   | NOT NULL | FALSE    | 当前状态（T-员工，F-非员工）         |
| REMARK     | TEXT                             | NULL     | FALSE    | 备注                                 |

```sql
-- 创建员工表
CREATE TABLE Object_Person (
    ID INT NOT NULL AUTO_INCREMENT,           -- 员工号（主键，唯一标识员工）
    PASSWD VARCHAR(255) NOT NULL COMMENT '密码（存储加密密码）',             -- 密码（存储加密密码）
    AUTHORITY ENUM('admin', 'user', 'manager') NOT NULL COMMENT '用户权限（管理员、用户、经理等）', -- 用户权限（管理员、用户、经理等）
    NAME VARCHAR(100) NOT NULL COMMENT '姓名',               -- 姓名
    SEX ENUM('M', 'F') NOT NULL COMMENT '性别（M-男，F-女）',              -- 性别（M-男，F-女）
    BIRTHDAY DATE NOT NULL COMMENT '生日（格式：YYYY-MM-DD）',                   -- 生日（格式：YYYY-MM-DD）
    DEPARTMENT VARCHAR(100) NOT NULL COMMENT '所在部门',         -- 所在部门
    JOB VARCHAR(100) NOT NULL COMMENT '职务',                -- 职务
    EDU_LEVEL VARCHAR(50) NOT NULL COMMENT '受教育程度',           -- 受教育程度
    SPCIALTY VARCHAR(100) NOT NULL COMMENT '专业技能',           -- 专业技能
    ADDRESS VARCHAR(255) NOT NULL COMMENT '家庭住址',            -- 家庭住址
    TEL VARCHAR(15) NOT NULL COMMENT '联系电话',                 -- 联系电话
    EMAIL VARCHAR(100) NOT NULL COMMENT '电子邮箱',              -- 电子邮箱
    STATE ENUM('T', 'F') NOT NULL COMMENT '当前状态（T-员工，F-非员工）',            -- 当前状态（T-员工，F-非员工）
    REMARK TEXT COMMENT '备注（可空）',                              -- 备注（可空）
    PRIMARY KEY (ID) COMMENT '设置主键为员工号（ID）'                          -- 设置主键为员工号（ID）
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;  -- 设置字符集和排序规则

```



### 2.1.2:Object_EduLevel

| 字段名      | 数据类型    | 是否可空 | 说明 |
| ----------- | ----------- | -------- | ---- |
| CODE        | INT         | NOT NULL | 代码 |
| DESCRIPTION | VARCHAR(50) | NOT NULL | 描述 |

```sql
-- 创建 Object_EduLevel 表
CREATE TABLE Object_EduLevel (
    CODE INT NOT NULL COMMENT '代码',                 -- 代码（唯一标识教育级别）
    DESCRIPTION VARCHAR(50) NOT NULL COMMENT '描述',   -- 描述（教育级别的描述）
    PRIMARY KEY (CODE) COMMENT '设置主键为代码字段'  -- 设置主键为代码字段
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;   -- 设置字符集和排序规则

```



### 2.1.3:Object_Job

| 字段名      | 数据类型 | 是否可空 | 说明 |
| ----------- | -------- | -------- | ---- |
| CODE        |          | not null | 代码 |
| DESCRIPTION |          | not null | 描述 |

```sql
-- 创建 Object_Job 表
CREATE TABLE Object_Job (
    CODE INT NOT NULL COMMENT '代码',                 -- 代码（唯一标识职务）
    DESCRIPTION VARCHAR(50) NOT NULL COMMENT '描述',   -- 描述（职务的描述）
    PRIMARY KEY (CODE) COMMENT '设置主键为代码字段'  -- 设置主键为代码字段
) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci;   -- 设置字符集和排序规则

```

```sql
-- 插入数据到 Object_Job 表
INSERT INTO Object_Job (CODE, DESCRIPTION) VALUES
(0, '小学'),
(1, '初中'),
(2, '高中'),
(3, '职高'),
(4, '大本'),
(5, '大专'),
(6, '硕士'),
(7, '博士'),
(8, '博士后');

```



> | 0    | 小学   |
> | ---- | ------ |
> | 1    | 初中   |
> | 2    | 高中   |
> | 3    | 职高   |
> | 4    | 大本   |
> | 5    | 大专   |
> | 6    | 硕士   |
> | 7    | 博士   |
> | 8    | 博士后 |
>
> 这些数据是需要插入到Object_Job表的



### 2.1.4:Object_Department

| 字段名  | 数据类型     | 是否可空 | 是否自增 | 说明     |
| ------- | ------------ | -------- | -------- | -------- |
| ID      | INT          | not null | true     | 部门编号 |
| NAME    | VARCHAR(100) | not null | false    | 部门名称 |
| MANAGER | VARCHAR(100) | not null | false    | 部门经理 |
| INTRO   | TEXT         | not null | false    | 简介     |

```sql
CREATE TABLE Object_Department (
    ID INT NOT NULL AUTO_INCREMENT COMMENT '部门编号，设置为自增，作为每个部门的唯一标识符',  -- 部门编号，设置为自增
    NAME VARCHAR(100) NOT NULL COMMENT '部门名称，不能为空，用于标识部门的名称',              -- 部门名称
    MANAGER VARCHAR(100) NOT NULL COMMENT '部门经理，不能为空，记录该部门的负责人',            -- 部门经理
    INTRO TEXT NOT NULL COMMENT '部门简介，不能为空，用于简要描述部门的功能和职责',            -- 部门简介
    PRIMARY KEY (ID) COMMENT '设置 ID 字段为主键，确保每个部门的唯一性'                       -- 设置 ID 为主键
);

```



### 2.1.5:Object_PersonnelChange

| 字段名      | 数据类型     | 是否可空 | 说明 |
| ----------- | ------------ | -------- | ---- |
| CODE        | VARCHAR(50)  | not null | 代码 |
| DESCRIPTION | VARCHAR(255) | not null | 描述 |

```sql
CREATE TABLE Object_PersonnelChange (
    CODE VARCHAR(50) NOT NULL COMMENT '变更代码，不能为空，作为每种变更类型的唯一标识符',  -- 代码，不能为空
    DESCRIPTION VARCHAR(255) NOT NULL COMMENT '变更类型的描述，不能为空，用于简要说明变更的内容',  -- 描述，不能为空
    PRIMARY KEY (CODE) COMMENT '设置 CODE 字段为主键，保证变更代码的唯一性'  -- 设置 CODE 为主键
);

```

```java
INSERT INTO Object_PersonnelChange (CODE, DESCRIPTION)
VALUES 
    ('0', '新员工加入'),
    ('1', '职务变动'),
    ('2', '辞退');
```



## 2.2关系表

### 2.2.1:Relation_Personnel

| 字段名      | 数据类型    | 是否可空 | 是否自增 | 说明     |
| ----------- | ----------- | -------- | -------- | -------- |
| ID          | INT         | not null | true     | 记录编号 |
| PERSON      | VARCHAR(50) | not null | false    | 员工号   |
| Change_     | VARCHAR(50) | not null | false    | 变更代码 |
| DESCRIPTION | TEXT        | not null | false    | 详细记录 |

```sql
CREATE TABLE Relation_Personnel (
    ID INT NOT NULL AUTO_INCREMENT COMMENT '记录编号，设置为自增，作为每条记录的唯一标识符',   -- 记录编号，设置为自增
    PERSON VARCHAR(50) NOT NULL COMMENT '员工号，不能为空，用于标识该条记录所属的员工',         -- 员工号，不能为空
    Change_ VARCHAR(50) NOT NULL COMMENT '变更代码，不能为空，表示记录的变更类型',                 -- 变更代码，不能为空
    DESCRIPTION TEXT NOT NULL COMMENT '详细记录，不能为空，用于存储变更的具体描述信息',           -- 详细记录，不能为空
    PRIMARY KEY (ID) COMMENT '设置 ID 字段为主键，确保每条记录的唯一性'                   -- 设置 ID 为主
);

```



# 3.MongoDB预留功能

# 4.Redis预留功能

# 5.接口设计

## 3.1模块设计

| 模块名   | URL    | 功能描述                           |
| -------- | ------ | ---------------------------------- |
| 管理员端 | /Admin | 操作员工的变动行为->查询通讯情况   |
| 员工端   | /User  | 员工登录->查看自己的状况->站内通讯 |

## 3.2模块接口设计

### 3.2.1管理员端(/Admin)

| 功能名           | 接口类型 | 接口路径               | 入参类型             | 返回值类型          | 功能分析                     | 备注                  |
| ---------------- | -------- | ---------------------- | -------------------- | ------------------- | ---------------------------- | --------------------- |
| 获取员工列表     | GET      | /Admin/employee/list   | 无                   | JSON（员工数据）    | 查询并返回所有员工的详细信息 | 包含分页、排序功能    |
| 新增员工         | POST     | /Admin/employee/add    | JSON（员工信息）     | 成功/失败（状态码） | 添加新的员工信息到数据库     | 必须提供所有字段      |
| 修改员工信息     | POST     | /Admin/employee/update | JSON（员工信息）     | 成功/失败（状态码） | 更新现有员工的个人信息       | 必须提供员工ID        |
| 删除员工         | DELETE   | /Admin/employee/delete | JSON（员工ID）       | 成功/失败（状态码） | 删除员工记录                 | 需要提供员工ID        |
| 获取员工详细信息 | GET      | /Admin/employee/{id}   | 员工ID（路径参数）   | JSON（员工信息）    | 查询某一员工的详细信息       | 根据ID查询            |
| 员工状态变更     | PATCH    | /Admin/employee/status | JSON（员工ID, 状态） | 成功/失败（状态码） | 更改员工的当前状态（T/F）    | 状态只能是 'T' 或 'F' |

### 3.2.2员工端（/User）

| 功能名           | 接口类型 | 接口路径                     | 入参类型            | 返回值类型     | 功能分析                                                     | 备注                   |
| ---------------- | -------- | ---------------------------- | ------------------- | -------------- | ------------------------------------------------------------ | ---------------------- |
| **查询员工信息** | GET      | /User/employee/{ID}          | ID: INT             | Employee对象   | 根据员工ID获取员工的基本信息（如姓名、性别、部门等），用于员工自助查看个人信息。 | 无需修改信息           |
| **修改员工信息** | PUT      | /User/employee/{ID}          | Employee对象        | success/fail   | 更新员工信息（如联系方式、住址等）。只允许修改自己的信息，需验证权限。 | 不允许修改敏感信息     |
| **修改密码**     | PUT      | /User/employee/{ID}/password | newPassword: STRING | success/fail   | 修改员工的登录密码。员工需提供旧密码和新密码，成功后返回修改结果。 | 密码需加密存储         |
| **查看部门信息** | GET      | /User/employee/department    | department: STRING  | List<Employee> | 获取指定部门下的所有员工信息，按部门查看同事情况。           | 部门数据需要权限控制   |
| **查看员工状态** | GET      | /User/employee/status/{ID}   | ID: INT             | ENUM('T', 'F') | 查询员工当前的在职状态（'T'表示在职，'F'表示离职）。         | 员工只能查看自己的状态 |
| **查看员工历史** | GET      | /User/employee/{ID}/history  | ID: INT             | List<History>  | 查询员工的历史记录，包括职位变动、部门变动等历史信息。       | 仅员工自己可查看       |

# 6.POJO设计

## 6.1返回给前端的Result

```java
import lombok.AllArgsConstructor;
import lombok.Data;
import lombok.NoArgsConstructor;

@Data
@NoArgsConstructor
@AllArgsConstructor
public class Result<T> {
    private boolean success;
    private String message;
    private T data;
}

```

前端拿到的结果：

```json
{
  "success": true,
  "message": "操作成功",
  "data": {
    "id": 12345,
    "name": "张三"
    // ... 其他Employee属性
  }
}

```

```json
{
  "success": false,
  "message": "操作失败"
}

```

## 6.2Entity-与数据库交互

## 6.3DTO-服务与前端交互

# 7.基于Eolink的API测试

## 7.1Json格式规范化-基于Object_Person

```json
{
  "id": 1,
  "name": "张三",
  "sex": "M",
  "passwd": "encrypted_password",
  "authority": "admin",
  "birthday": "1990-05-15",
  "department": "技术部",
  "job": "软件工程师",
  "eduLevel": "本科",
  "specialty": "计算机科学",
  "address": "北京市朝阳区XXX街道",
  "tel": "13812345678",
  "email": "zhangsan@example.com",
  "state": "T",
  "remark": "暂无备注"
}

```

上述的格式一定是最优服从Object_Person的sql表结构需求,其次关注Entity需求,最后关注DTO需求

值得注意的是：对于  "birthday": "1990-05-15",这种特殊结构的数据,需要在Entity和DTO上用`@JsonFormat(pattern = "yyyy-MM-dd")`修饰