1.拉取最新版本的gitlab社区镜像

```shell
docker pull docker.xuanyuan.me/gitlab/gitlab-ce:latest
```

2.创建本地的挂载卷（数据的持久化）

```shell
sudo mkdir -p /srv/gitlab/config
sudo mkdir -p /srv/gitlab/logs
sudo mkdir -p /srv/gitlab/data
```

3.运行Gitlab容器

```shell
docker run --detach 
  --hostname gitlab.example.com 
  --publish 443:443 --publish 80:80 
  --name gitlab 
  --restart always 
  --volume /srv/gitlab/config:/etc/gitlab 
  --volume /srv/gitlab/logs:/var/log/gitlab 
  --volume /srv/gitlab/data:/var/opt/gitlab 
  --volume /etc/ssh:/etc/ssh:ro
  docker.xuanyuan.me/gitlab/gitlab-ce:latest
  
  # 由于git服务需要使用ssh 所以还得额外配置
  vi /srv/gitlab/config/gitlab.rb
#  按/进行搜索模式
/gitlab_shell_ssh_port
# 光标移动到哪里 按x删除当前的元素 确保port为22 如果前面有#的话 去除掉这个#
# :wq保存
# 重启docker
```

4.查看gitlab的状态

```java
docker logs -f gitlab
```

看到gitlab Reconfigured说明日志就绪

6.访问gitlab

```java
192.168.11.130:8080 // 这里用NAT+端口转发的话 对应docker内部的80端口
```

